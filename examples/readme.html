<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Strict//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>C:\Users\easyp\Documents\HBuilderProjects\adoc\.readme.md.html</title>


<style type="text/css">
body {
	color: #333;
	font: 13px/1.4 "Helvetica Neue", Helvetica, "Segoe UI", Arial, freesans, sans-serif;
	padding: 0;
	margin: 0;
}

a {
	background: transparent;
	color: #4183c4;
	text-decoration: none;
}

a:active,
a:hover {
	outline: 0 none;
	text-decoration: underline;
}

abbr[title] {
	border-bottom: 1px dotted;
}

b,
strong {
	font-weight: bold;
}

dfn {
	font-style: italic;
}
h1 {
	font-size: 2em;
	margin: 0.67em 0;
}
mark {
	background: #ff0;
	color: #000;
}
small {
	font-size: 80%;
}
sub, sup {
	font-size: 75%;
	line-height: 0;
	position: relative;
	vertical-align: baseline;
}
sup {
	top: -0.5em;
}
sub {
	bottom: -0.25em;
}
img {
	border: 0 none;
}
svg:not(:root) {
	overflow: hidden;
}
figure {
	margin: 1em 40px;
}
hr {
	box-sizing: content-box;
	height: 0;
}

code,
kbd,
pre,
samp {
	font-family: monospace,monospace;
	font-size: 1em;
}

pre {
	overflow: auto;
	font: 12px Consolas,"Liberation Mono",Menlo,Courier,monospace;
	margin-bottom: 0;
	margin-top: 0;
}

.markdown-body {
	padding: 30px;
	font-size: 16px;
	line-height: 1.6;
	word-wrap: break-word;
}

.markdown-body>*:first-child {
	margin-top: 0 !important;
}

.markdown-body>*:last-child {
	margin-bottom: 0 !important;
}

.markdown-body .absent {
	color: #c00;
}

.markdown-body .anchor {
	position: absolute;
	top: 0;
	bottom: 0;
	left: 0;
	display: block;
	padding-right: 6px;
	padding-left: 30px;
	margin-left: -30px;
}

.markdown-body .anchor:focus {
	outline: none;
}

.markdown-body h1,
.markdown-body h2,
.markdown-body h3,
.markdown-body h4,
.markdown-body h5,
.markdown-body h6 {
	position: relative;
	margin-top: 1em;
	margin-bottom: 16px;
	font-weight: bold;
	line-height: 1.4;
}

.markdown-body h1 .octicon-link,
.markdown-body h2 .octicon-link,
.markdown-body h3 .octicon-link,
.markdown-body h4 .octicon-link,
.markdown-body h5 .octicon-link,
.markdown-body h6 .octicon-link {
	display: none;
	color: #000;
	vertical-align: middle;
}

.markdown-body h1:hover .anchor,
.markdown-body h2:hover .anchor,
.markdown-body h3:hover .anchor,
.markdown-body h4:hover .anchor,
.markdown-body h5:hover .anchor,
.markdown-body h6:hover .anchor {
	padding-left: 8px;
	margin-left: -30px;
	line-height: 1;
	text-decoration: none;
}

.markdown-body h1:hover .anchor .octicon-link,
.markdown-body h2:hover .anchor .octicon-link,
.markdown-body h3:hover .anchor .octicon-link,
.markdown-body h4:hover .anchor .octicon-link,
.markdown-body h5:hover .anchor .octicon-link,
.markdown-body h6:hover .anchor .octicon-link {
	display: inline-block;
}

.markdown-body h1 tt,
.markdown-body h1 code,
.markdown-body h2 tt,
.markdown-body h2 code,
.markdown-body h3 tt,
.markdown-body h3 code,
.markdown-body h4 tt,
.markdown-body h4 code,
.markdown-body h5 tt,
.markdown-body h5 code,
.markdown-body h6 tt,
.markdown-body h6 code {
	font-size: inherit;
}

.markdown-body h1 {
	padding-bottom: 0.3em;
	font-size: 2.25em;
	line-height: 1.2;
	border-bottom: 1px solid #eee;
}

.markdown-body h2 {
	padding-bottom: 0.3em;
	font-size: 1.75em;
	line-height: 1.225;
	border-bottom: 1px solid #eee;
}

.markdown-body h3 {
	font-size: 1.5em;
	line-height: 1.43;
}

.markdown-body h4 {
	font-size: 1.25em;
}

.markdown-body h5 {
	font-size: 1em;
}

.markdown-body h6 {
	font-size: 1em;
	color: #777;
}

.markdown-body p,.markdown-body blockquote,
.markdown-body ul,.markdown-body ol,
.markdown-body dl,.markdown-body table,
.markdown-body pre {
	margin-top: 0;
	margin-bottom: 16px;
}

.markdown-body hr {
	height: 4px;
	padding: 0;
	margin: 16px 0;
	background-color: #e7e7e7;
	border: 0 none;
}

.markdown-body ul,
.markdown-body ol {
	padding-left: 2em;
}

.markdown-body ul.no-list,
.markdown-body ol.no-list {
	padding: 0;
	list-style-type: none;
}

.markdown-body ul ul,
.markdown-body ul ol,
.markdown-body ol ol,
.markdown-body ol ul {
	margin-top: 0;
	margin-bottom: 0;
}

.markdown-body li>p {
	margin-top: 16px;
}

.markdown-body dl {
	padding: 0;
}

.markdown-body dl dt {
	padding: 0;
	margin-top: 16px;
	font-size: 1em;
	font-style: italic;
	font-weight: bold;
}

.markdown-body dl dd {
	padding: 0 16px;
	margin-bottom: 16px;
}

.markdown-body blockquote {
	padding: 0 15px;
	color: #777;
	border-left: 4px solid #ddd;
}

.markdown-body blockquote>:first-child {
	margin-top: 0;
}

.markdown-body blockquote>:last-child {
	margin-bottom: 0;
}

.markdown-body table {
	display: block;
	width: 100%;
	overflow: auto;
	word-break: normal;
	word-break: keep-all;
}

.markdown-body table th {
	font-weight: bold;
}

.markdown-body table th,
.markdown-body table td {
	padding: 6px 13px;
	border: 1px solid #ddd;
}

.markdown-body table tr {
	background-color: #fff;
	border-top: 1px solid #ccc;
}

.markdown-body table tr:nth-child(2n) {
	background-color: #f8f8f8;
}

.markdown-body img {
	max-width: 100%;
	-moz-box-sizing: border-box;
	box-sizing: border-box;
}

.markdown-body span.frame {
	display: block;
	overflow: hidden;
}

.markdown-body span.frame>span {
	display: block;
	float: left;
	width: auto;
	padding: 7px;
	margin: 13px 0 0;
	overflow: hidden;
	border: 1px solid #ddd;
}

.markdown-body span.frame span img {
	display: block;
	float: left;
}

.markdown-body span.frame span span {
	display: block;
	padding: 5px 0 0;
	clear: both;
	color: #333;
}

.markdown-body span.align-center {
	display: block;
	overflow: hidden;
	clear: both;
}

.markdown-body span.align-center>span {
	display: block;
	margin: 13px auto 0;
	overflow: hidden;
	text-align: center;
}

.markdown-body span.align-center span img {
	margin: 0 auto;
	text-align: center;
}

.markdown-body span.align-right {
	display: block;
	overflow: hidden;
	clear: both;
}

.markdown-body span.align-right>span {
	display: block;
	margin: 13px 0 0;
	overflow: hidden;
	text-align: right;
}

.markdown-body span.align-right span img {
	margin: 0;
	text-align: right;
}

.markdown-body span.float-left {
	display: block;
	float: left;
	margin-right: 13px;
	overflow: hidden;
}

.markdown-body span.float-left span {
	margin: 13px 0 0;
}

.markdown-body span.float-right {
	display: block;
	float: right;
	margin-left: 13px;
	overflow: hidden;
}

.markdown-body span.float-right>span {
	display: block;
	margin: 13px auto 0;
	overflow: hidden;
	text-align: right;
}

.markdown-body code,.markdown-body tt {
	padding: 0;
	padding-top: 0.2em;
	padding-bottom: 0.2em;
	margin: 0;
	font-size: 85%;
	background-color: rgba(0,0,0,0.04);
	border-radius: 3px;
}

.markdown-body code:before,
.markdown-body code:after,
.markdown-body tt:before,
.markdown-body tt:after {
	letter-spacing: -0.2em;
	content: "\00a0";
}

.markdown-body code br,
.markdown-body tt br {
	display: none;
}

.markdown-body del code {
	text-decoration: inherit;
}

.markdown-body pre>code {
	padding: 0;
	margin: 0;
	font-size: 100%;
	word-break: normal;
	white-space: pre;
	background: transparent;
	border: 0;
}

.markdown-body .highlight {
	margin-bottom: 16px;
}

.markdown-body .highlight pre,
.markdown-body pre {
	padding: 16px;
	overflow: auto;
	font-size: 85%;
	line-height: 1.45;
	background-color: #f7f7f7;
	border-radius: 3px;
}

.markdown-body .highlight pre {
	margin-bottom: 0;
	word-break: normal;
}

.markdown-body pre {
	word-wrap: normal;
}

.markdown-body pre code,
.markdown-body pre tt {
	display: inline;
	max-width: initial;
	padding: 0;
	margin: 0;
	overflow: initial;
	line-height: inherit;
	word-wrap: normal;
	background-color: transparent;
	border: 0;
}

.markdown-body pre code:before,
.markdown-body pre code:after,
.markdown-body pre tt:before,
.markdown-body pre tt:after {
	content: normal;
}

.highlight .pl-coc,
.highlight .pl-entl,
.highlight .pl-entm,
.highlight .pl-eoa,
.highlight .pl-mai .pl-sf,
.highlight .pl-mm,
.highlight .pl-pdv,
.highlight .pl-sc,
.highlight .pl-som,
.highlight .pl-sr,
.highlight .pl-v,
.highlight .pl-vpf {
	color: #0086b3;
}
.highlight .pl-eoac,
.highlight .pl-mdht,
.highlight .pl-mi1,
.highlight .pl-mri,
.highlight .pl-va,
.highlight .pl-vpu {
	color: #008080;
}
.highlight .pl-c,
.highlight .pl-pdc {
	color: #b4b7b4;
	font-style: italic;
}
.highlight .pl-k,
.highlight .pl-ko,
.highlight .pl-kolp,
.highlight .pl-mc,
.highlight .pl-mr,
.highlight .pl-ms,
.highlight .pl-s,
.highlight .pl-sok,
.highlight .pl-st {
	color: #6e5494;
}
.highlight .pl-ef,
.highlight .pl-enf,
.highlight .pl-enm,
.highlight .pl-entc,
.highlight .pl-eoi,
.highlight .pl-sf,
.highlight .pl-smc {
	color: #d12089;
}
.highlight .pl-ens,
.highlight .pl-eoai,
.highlight .pl-kos,
.highlight .pl-mh .pl-pdh,
.highlight .pl-mp,
.highlight .pl-pde,
.highlight .pl-stp {
	color: #458;
}
.highlight .pl-enti {
	color: #d12089;
	font-weight: bold;
}
.highlight .pl-cce,
.highlight .pl-enc,
.highlight .pl-kou,
.highlight .pl-mq {
	color: #f93;
}
.highlight .pl-mp1 .pl-sf {
	color: #458;
	font-weight: bold;
}
.highlight .pl-cos,
.highlight .pl-ent,
.highlight .pl-md,
.highlight .pl-mdhf,
.highlight .pl-ml,
.highlight .pl-pdc1,
.highlight .pl-pds,
.highlight .pl-s1,
.highlight .pl-scp,
.highlight .pl-sol {
	color: #df5000;
}
.highlight .pl-c1,
.highlight .pl-cn,
.highlight .pl-pse,
.highlight .pl-pse .pl-s2,
.highlight .pl-vi {
	color: #a31515;
}
.highlight .pl-mb,
.highlight .pl-pdb {
	color: #df5000;
	font-weight: bold;
}
.highlight .pl-mi,
.highlight .pl-pdi {
	color: #6e5494;
	font-style: italic;
}
.highlight .pl-ms1 {
	background-color: #f5f5f5;
}
.highlight .pl-mdh,
.highlight .pl-mdi {
	font-weight: bold;
}
.highlight .pl-mdr {
	color: #0086b3;
	font-weight: bold;
}
.highlight .pl-s2 {
	color: #333;
}
.highlight .pl-ii {
	background-color: #df5000;
	color: #fff;
}
.highlight .pl-ib {
	background-color: #f93;
}
.highlight .pl-id {
	background-color: #a31515;
	color: #fff;
}
.highlight .pl-iu {
	background-color: #b4b7b4;
}
.highlight .pl-mo {
	color: #969896;
}

</style>


<script type="text/javascript">

function getDocumentScrollTop() 
{
   var res = document.body.scrollTop || document.documentElement.scrollTop || window.pageYOffset || 0;
   // alert(res);
   return res;
}

function setDocumentScrollTop(ypos) 
{
	window.scrollTo(0, ypos);
}

</script>


</head>
<body class="markdown-body">
<h1> <a id="angular-2-纯-javascript-中文开发教程" class="anchor" href="#angular-2-%E7%BA%AF-javascript-%E4%B8%AD%E6%96%87%E5%BC%80%E5%8F%91%E6%95%99%E7%A8%8B" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Angular 2 纯 JavaScript 中文开发教程</h1> 
<p><strong>Angular 为现代设计，拥抱未来。</strong></p> 
<p><a href="doc/images/angular.png" target="_blank"><img src="doc/images/angular.png" alt="Angular logo" style="max-width:100%;" /></a></p> 
<p>在吸收了当下最先进的思想和技术后， Angular 2 框架问世，这是一个新时代，完全颠覆挥别了 AngularJS 1 平台，名字也准确定义在 <strong>Angular</strong> 而不再是 AngularJS。<em>（后文 Angular 均指代 Angular 2.X 以上版本，AngularJS 指代 Angular 1.X）</em></p> 
<p>Angular 2 带来了更先进的应用开发平台，它基于最新的 ES6 进行开发，提供移动优化，支持跨平台开发的能力，以 <code>Component</code> 组件而非 <code>DOM</code> 为核心，实现了突破性的速度与性能。包含了这一代的技术和思想顶峰。 </p> 
<p>而 Angular 团队计划每六个月发布一个主要版本来跟进技术，与此同时官方承诺<em>“不会再做任何像升级到 Angular 2 一样会破坏软件生态系统的重大更改重，API 也将不会有重大更改”</em>，这是一个对未来技术的可靠预见。全新来过，Angular 2 是未来的先进可靠选择。</p> 
<p>和之前不同，一个很大的变化是，Angular 主要使用 TypeScript 来开发，这一代官方目前的文档和案例都是以 TypeScript 语言为指导。</p> 
<p>这让我想起来十几年以前使用 <code>JavaScript</code>，<code>JScript</code>，<code>VBScript</code> 在网页中写脚本的混乱年代；然后，几年以后<code>JavaScript</code> 成为互联网第一大语言，面向的方面和需要的功能越来越多，眼看一统江湖，语言的广泛使用却对应着标准实现的进展缓慢；再几年，<code>CoffeeScript</code>，<code>Dart</code>，<code>TypeScript</code> 又重新制造混乱…… 实则不过十几年，技术语言起起伏伏，分裂统一又分裂，最终为在技术面前仍像个孩子一样在探索的自己留下一些对混沌和秩序的冷静。</p> 
<h2> <a id="关于-javascript-中文开发教程" class="anchor" href="#%E5%85%B3%E4%BA%8E-javascript-%E4%B8%AD%E6%96%87%E5%BC%80%E5%8F%91%E6%95%99%E7%A8%8B" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>关于 JavaScript 中文开发教程</h2> 
<p><strong>纯 JavaScript 版本的中文开发教程。</strong></p> 
<p><a href="https://github.com/ushelp/Angular-for-javascript-turorial">https://github.com/ushelp/Angular-for-javascript-turorial</a></p> 
<p>由于版本生态的颠覆，以及官方缺少系统的 JavaScript 语言的应用开发指导教程，对于使用 JavaScript 语言开发 Angular 应用程序的用户来说会遇到很多的困难和问题。</p> 
<p><strong>这份教程是使用纯 JavaScript 来进行 Angular 开发指导，思想内容和步骤实现上都参考了官方教程，配套完整开发步骤和案例。力求从开发流程，组件定义，结构设计上不偏颇官方主旨，提供一个标准的 Angular 开发流程和项目结构。</strong></p> 
<p>同时能够发现 Angular 跨平台的野心带来了更大的责任和挑战，Angular 团队在纯 JavaScript 上的测试用例还不够全面充分，开发者在使用纯 JavaScript 应用开发中有一些已经发现的 bug，可以借助笔者的经验教训去注意规避和解决。</p> 
<p><strong>不是什么？</strong></p> 
<ul> 
 <li><p>不是中文版的翻译，如寻求官方权威中文翻译，请访问官方中文网站：<a href="https://angular.cn%E3%80%82">https://angular.cn。</a></p></li> 
 <li><p>不是 API 和组件详细使用介绍文档，Angular 开发组件的基础知识和使用请移步官网。</p></li> 
</ul> 
<p><strong>是什么？</strong></p> 
<ul> 
 <li> <p>是结合按步骤演进的开发案例，指导如何从零一步一步构建开发出一个纯 JavaScript 的 Angular 应用，包含完整的重构过程和理由，以及对应的源代码。</p> <p>为准备和正在 Angular 使用道路上的开发者或团队，在使用纯 JavaScript 进行 Angular 开发时，提供完整开发流程，组件定义，代码结构设计上的开发教程和经验。</p> </li> 
</ul> 
<blockquote> 
 <p>欢迎交流讨论，转载请注明出处，商业用途需经许可。<a href="https://github.com/ushelp/Angular-for-javascript-turorial">https://github.com/ushelp/Angular-for-javascript-turorial</a></p> 
</blockquote> 
<h2> <a id="案例说明" class="anchor" href="#%E6%A1%88%E4%BE%8B%E8%AF%B4%E6%98%8E" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>案例说明</h2> 
<p>案例演示了构建一个应用市场的程序，包括应用列表的管理和分类管理，支持应用即时搜索。</p> 
<p>应用市场程序覆盖了 Angular 的核心原理。包含 <code>Module 模块</code>，<code>Component 组件</code>，<code>Template 模板</code>，<code>Directive 指令</code>，<code>Data binding 数据绑定</code>，<code>Event 事件处理</code>，<code>Service 服务</code>， <code>Router 路由</code>等 Angular 核心组件，以及 <code>From 表单验证</code>，<code>HTTP</code>，<code>Promise 承诺</code>， <code>Observable 可观察对象</code>等等 Angular 实用功能。</p> 
<p><strong>在线演示：</strong></p> 
<p><a href="http://easyproject.cn/angular-appstore">http://easyproject.cn/angular-appstore</a></p> 
<p><a href="doc/images/demo-optimize.gif" target="_blank"><img src="doc/images/demo-optimize.gif" alt="Demp" style="max-width:100%;" /></a></p> 
<p><strong>环境要求：</strong></p> 
<p>Angular 需要使用 <code>NodeJS 4+</code> 和 <code>npm 3+</code> 来构建和初始化项目。</p> 
<pre><code># node 4.X+
node -v
# npm 3.X+
npm –v
</code></pre> 
<p><strong>运行案例：</strong></p> 
<p>所有案例均按文档步骤分类，使用 <code>lite-server</code> 开发插件直接运行，<code>npm start</code> 即可查看。</p> 
<p><a href="doc/images/example.png" target="_blank"><img src="doc/images/example.png" alt="Example" style="max-width:100%;" /></a></p> 
<pre><code>cd step1-init
npm intall
npm start
</code></pre> 
<h2> <a id="教程目录" class="anchor" href="#%E6%95%99%E7%A8%8B%E7%9B%AE%E5%BD%95" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>教程目录</h2> 
<p><a href="#1-%E5%88%9D%E5%A7%8B%E5%8C%96%E9%A1%B9%E7%9B%AE" title="1. 初始化项目">1. 初始化项目</a></p> 
<p><a href="#2-%E7%BB%84%E4%BB%B6%E5%92%8C%E6%A8%A1%E5%9D%97%E4%BF%A1%E6%81%AF%E5%AE%9A%E4%B9%89" title="2. 组件和模块信息定义">2. 组件和模块信息定义</a></p> 
<p><a href="#3-%E7%B1%BB%E6%95%B0%E6%8D%AE%E5%8F%8A%E6%A8%A1%E6%9D%BF%E5%88%9D%E5%A7%8B%E5%8C%96" title="3. 类数据及模板初始化">3. 类数据及模板初始化</a></p> 
<p><a href="#4-%E6%95%B0%E6%8D%AE%E7%BB%91%E5%AE%9A%E4%BA%8B%E4%BB%B6%E5%A4%84%E7%90%86" title="4. 数据绑定事件处理">4. 数据绑定事件处理</a></p> 
<p><a href="#5-%E6%9C%8D%E5%8A%A1%E5%BC%80%E5%8F%91" title="5. 服务开发">5. 服务开发</a></p> 
<p><a href="#6-%E5%BC%82%E6%AD%A5%E6%9C%8D%E5%8A%A1%E4%B8%8E%E6%89%BF%E8%AF%BA-promise" title="6. 异步服务与承诺 Promise">6. 异步服务与承诺 Promise</a></p> 
<p><a href="#7-%E4%BD%BF%E7%94%A8%E8%B7%AF%E7%94%B1%E6%9E%84%E5%BB%BA%E8%A7%86%E5%9B%BE%E5%AF%BC%E8%88%AA" title="7. 使用路由构建视图导航">7. 使用路由构建视图导航</a></p> 
<p><a href="#8-http-%E4%BA%A4%E4%BA%92" title="8. HTTP 交互">8. HTTP 交互</a></p> 
<p><a href="#9-%E4%BD%BF%E7%94%A8%E5%8F%AF%E8%A7%82%E5%AF%9F%E5%AF%B9%E8%B1%A1observable%E5%8D%B3%E5%88%BB%E6%90%9C%E7%B4%A2" title="9. 使用可观察对象(Observable)即刻搜索">9. 使用可观察对象(Observable)即刻搜索</a></p> 
<p><a href="#10-%E5%BA%94%E7%94%A8%E5%88%86%E7%B1%BB%E5%BC%80%E5%8F%91%E5%AE%9E%E6%88%98" title="10. 应用分类开发实战">10. 应用分类开发实战</a></p> 
<h2> <a id="1-初始化项目" class="anchor" href="#1-%E5%88%9D%E5%A7%8B%E5%8C%96%E9%A1%B9%E7%9B%AE" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>1. 初始化项目</h2> 
<p>实现代码：<code>step1-init</code></p> 
<p><a href="doc/images/step1-demo.png" target="_blank"><img src="doc/images/step1-demo.png" alt="Example" style="max-width:100%;" /></a></p> 
<h3> <a id="项目基础结构" class="anchor" href="#%E9%A1%B9%E7%9B%AE%E5%9F%BA%E7%A1%80%E7%BB%93%E6%9E%84" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>项目基础结构</h3> 
<p>一个 Angular 项目的基础必备结构包括:</p> 
<ul> 
 <li> <code>index.html</code> 应用主页面</li> 
 <li> <code>app.module.js</code> 应用模块文件（<code>AppModule</code> 根模块）</li> 
 <li> <code>app.component.js</code> 应用组件文件（<code>AppComponent</code> 根组件）</li> 
 <li> <code>main.js</code> 应用引导启动文件</li> 
 <li> <code>package.json</code> 存储项目元数据，包依赖管理使用 npm</li> 
 <li> <code>bs-config.json</code> 配置 <code>lite-server</code> 运行信息。</li> 
</ul> 
<p>根据开发指导规范，请按以上命名规范名。</p> 
<h3> <a id="模块化" class="anchor" href="#%E6%A8%A1%E5%9D%97%E5%8C%96" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>模块化</h3> 
<p>Angular 应用都是模块化的，ES5 没有内置的模块化系统，可以使用第三方模块系统，然后我们为应用创建独立的命名空间 app，文件代码可以包裹在 <code>IIFE</code>（立即执行函数表达式）中：</p> 
<div class="highlight highlight-source-js">
 <pre><span class="pl-c"><span class="pl-c">//</span> IIFE( Immediately-Invoked Function Expression )</span>
(<span class="pl-k">function</span>(<span class="pl-smi">app</span>) {


})(<span class="pl-c1">window</span>.<span class="pl-smi">app</span> <span class="pl-k">||</span> (<span class="pl-c1">window</span>.<span class="pl-smi">app</span> <span class="pl-k">=</span> {}));</pre>
</div> 
<h3> <a id="项目搭建步骤" class="anchor" href="#%E9%A1%B9%E7%9B%AE%E6%90%AD%E5%BB%BA%E6%AD%A5%E9%AA%A4" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>项目搭建步骤</h3> 
<ol> 
 <li> <p>搭建开发环境</p> <p><a href="doc/images/step1.png" target="_blank"><img src="doc/images/step1.png" alt="Example" style="max-width:100%;" /></a></p> </li> 
 <li> <p>配置项目元数据和服务器运行参数（<code>package.json</code>，<code>bs-config.json</code>）</p> <p><strong>package.json</strong>:</p> 
  <div class="highlight highlight-source-json">
   <pre>{
    <span class="pl-s"><span class="pl-pds">&quot;</span>name<span class="pl-pds">&quot;</span></span>: <span class="pl-s"><span class="pl-pds">&quot;</span>angular-appstore<span class="pl-pds">&quot;</span></span>,
    <span class="pl-s"><span class="pl-pds">&quot;</span>version<span class="pl-pds">&quot;</span></span>: <span class="pl-s"><span class="pl-pds">&quot;</span>1.0.0<span class="pl-pds">&quot;</span></span>,
    <span class="pl-s"><span class="pl-pds">&quot;</span>description<span class="pl-pds">&quot;</span></span>: <span class="pl-s"><span class="pl-pds">&quot;</span><span class="pl-pds">&quot;</span></span>,
    <span class="pl-s"><span class="pl-pds">&quot;</span>license<span class="pl-pds">&quot;</span></span>: <span class="pl-s"><span class="pl-pds">&quot;</span>MIT<span class="pl-pds">&quot;</span></span>,
    <span class="pl-s"><span class="pl-pds">&quot;</span>scripts<span class="pl-pds">&quot;</span></span>: {
    <span class="pl-s"><span class="pl-pds">&quot;</span>start<span class="pl-pds">&quot;</span></span>: <span class="pl-s"><span class="pl-pds">&quot;</span>npm run lite<span class="pl-pds">&quot;</span></span>,
    <span class="pl-s"><span class="pl-pds">&quot;</span>lite<span class="pl-pds">&quot;</span></span>: <span class="pl-s"><span class="pl-pds">&quot;</span>lite-server<span class="pl-pds">&quot;</span></span>
  },
  <span class="pl-s"><span class="pl-pds">&quot;</span>dependencies<span class="pl-pds">&quot;</span></span>: {
    <span class="pl-s"><span class="pl-pds">&quot;</span>@angular/common<span class="pl-pds">&quot;</span></span>: <span class="pl-s"><span class="pl-pds">&quot;</span>~2.4.7<span class="pl-pds">&quot;</span></span>,
    <span class="pl-s"><span class="pl-pds">&quot;</span>@angular/compiler<span class="pl-pds">&quot;</span></span>: <span class="pl-s"><span class="pl-pds">&quot;</span>~2.4.7<span class="pl-pds">&quot;</span></span>,
    <span class="pl-s"><span class="pl-pds">&quot;</span>@angular/core<span class="pl-pds">&quot;</span></span>: <span class="pl-s"><span class="pl-pds">&quot;</span>~2.4.7<span class="pl-pds">&quot;</span></span>,
    <span class="pl-s"><span class="pl-pds">&quot;</span>@angular/forms<span class="pl-pds">&quot;</span></span>: <span class="pl-s"><span class="pl-pds">&quot;</span>~2.4.7<span class="pl-pds">&quot;</span></span>,
    <span class="pl-s"><span class="pl-pds">&quot;</span>@angular/http<span class="pl-pds">&quot;</span></span>: <span class="pl-s"><span class="pl-pds">&quot;</span>~2.4.7<span class="pl-pds">&quot;</span></span>,
    <span class="pl-s"><span class="pl-pds">&quot;</span>@angular/platform-browser<span class="pl-pds">&quot;</span></span>: <span class="pl-s"><span class="pl-pds">&quot;</span>~2.4.7<span class="pl-pds">&quot;</span></span>,
    <span class="pl-s"><span class="pl-pds">&quot;</span>@angular/platform-browser-dynamic<span class="pl-pds">&quot;</span></span>: <span class="pl-s"><span class="pl-pds">&quot;</span>~2.4.7<span class="pl-pds">&quot;</span></span>,
    <span class="pl-s"><span class="pl-pds">&quot;</span>@angular/router<span class="pl-pds">&quot;</span></span>: <span class="pl-s"><span class="pl-pds">&quot;</span>~3.4.7<span class="pl-pds">&quot;</span></span>,
    <span class="pl-s"><span class="pl-pds">&quot;</span>@angular/upgrade<span class="pl-pds">&quot;</span></span>: <span class="pl-s"><span class="pl-pds">&quot;</span>~2.4.7<span class="pl-pds">&quot;</span></span>,

    <span class="pl-s"><span class="pl-pds">&quot;</span>angular-in-memory-web-api<span class="pl-pds">&quot;</span></span>: <span class="pl-s"><span class="pl-pds">&quot;</span>~0.2.4<span class="pl-pds">&quot;</span></span>,
    <span class="pl-s"><span class="pl-pds">&quot;</span>core-js<span class="pl-pds">&quot;</span></span>: <span class="pl-s"><span class="pl-pds">&quot;</span>^2.4.1<span class="pl-pds">&quot;</span></span>,
    <span class="pl-s"><span class="pl-pds">&quot;</span>rxjs<span class="pl-pds">&quot;</span></span>: <span class="pl-s"><span class="pl-pds">&quot;</span>^5.1.1<span class="pl-pds">&quot;</span></span>,
    <span class="pl-s"><span class="pl-pds">&quot;</span>zone.js<span class="pl-pds">&quot;</span></span>: <span class="pl-s"><span class="pl-pds">&quot;</span>^0.7.7<span class="pl-pds">&quot;</span></span>
  },
  <span class="pl-s"><span class="pl-pds">&quot;</span>devDependencies<span class="pl-pds">&quot;</span></span>: {
    <span class="pl-s"><span class="pl-pds">&quot;</span>concurrently<span class="pl-pds">&quot;</span></span>: <span class="pl-s"><span class="pl-pds">&quot;</span>^3.3.0<span class="pl-pds">&quot;</span></span>,
    <span class="pl-s"><span class="pl-pds">&quot;</span>lite-server<span class="pl-pds">&quot;</span></span>: <span class="pl-s"><span class="pl-pds">&quot;</span>^2.2.2<span class="pl-pds">&quot;</span></span>
  }
}</pre>
  </div> <p><strong>bs-config.json</strong>:</p> 
  <div class="highlight highlight-source-json">
   <pre>{
  <span class="pl-s"><span class="pl-pds">&quot;</span>server<span class="pl-pds">&quot;</span></span>: {
    <span class="pl-s"><span class="pl-pds">&quot;</span>baseDir<span class="pl-pds">&quot;</span></span>: <span class="pl-s"><span class="pl-pds">&quot;</span>src<span class="pl-pds">&quot;</span></span>,    
    <span class="pl-s"><span class="pl-pds">&quot;</span>routes<span class="pl-pds">&quot;</span></span>: { 
      <span class="pl-s"><span class="pl-pds">&quot;</span>/node_modules<span class="pl-pds">&quot;</span></span>: <span class="pl-s"><span class="pl-pds">&quot;</span>node_modules<span class="pl-pds">&quot;</span></span>
    }
  }
}</pre>
  </div> </li> 
 <li> <p>为 App 编写 Angular 根组件 AppComponent（<code>app.component.js</code>，<code>app.component.css</code> ）</p> <p><strong>Component 组件介绍</strong>：</p> 
  <ul> 
   <li>组件用于组合程序逻辑和 HTML 模板，把数据渲染到视图 (view)。Angular 使用 Component 组件而非 DOM，是借鉴了<code>虚拟 DOM</code>（ <code>vue.js</code>） 的思想，使得页面更新的速度提高。</li> 
  </ul> <p><strong>Component 组件定义语法</strong>：</p> 
  <div class="highlight highlight-source-js">
   <pre><span class="pl-smi">ng</span>.<span class="pl-smi">core</span>.<span class="pl-en">Component</span>({
    <span class="pl-k">...</span>
}).<span class="pl-en">Class</span>({
    <span class="pl-en">constructor</span><span class="pl-k">:</span><span class="pl-k">function</span>(){
    }
    <span class="pl-k">...</span>
});</pre>
  </div> <p><strong>app.component.js</strong>:</p> 
  <div class="highlight highlight-source-js">
   <pre>(<span class="pl-k">function</span>(<span class="pl-smi">app</span>) {
<span class="pl-smi">app</span>.<span class="pl-smi">AppComponent</span> <span class="pl-k">=</span> <span class="pl-smi">ng</span>.<span class="pl-smi">core</span>
    .<span class="pl-en">Component</span>({
        selector<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>appstore-app<span class="pl-pds">'</span></span>, 
        template<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">`</span></span>
<span class="pl-s">        &lt;h1&gt; {{title}} &lt;/h1&gt;</span>
<span class="pl-s">        <span class="pl-pds">`</span></span>,
        styleUrls<span class="pl-k">:</span> [<span class="pl-s"><span class="pl-pds">'</span>app/app.component.css<span class="pl-pds">'</span></span>]
    })
    .<span class="pl-en">Class</span>({
        <span class="pl-en">constructor</span><span class="pl-k">:</span> <span class="pl-k">function</span>() {
            <span class="pl-c1">this</span>.<span class="pl-c1">title</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">&quot;</span>Angular App Store<span class="pl-pds">&quot;</span></span>;
        }
    });
})(<span class="pl-c1">window</span>.<span class="pl-smi">app</span> <span class="pl-k">||</span> (<span class="pl-c1">window</span>.<span class="pl-smi">app</span> <span class="pl-k">=</span> {}));</pre>
  </div> <p><strong>app.component.css</strong>:</p> 
  <div class="highlight highlight-source-css">
   <pre><span class="pl-ent">h1</span>{<span class="pl-c1"><span class="pl-c1">text-align</span></span>: <span class="pl-c1">center</span>;}</pre>
  </div> </li> 
 <li> <p>添加 Angular 根模块 AppModule（<code>app.module.js</code>）</p> <p><strong>Module 模块介绍</strong>：</p> 
  <ul> 
   <li><p>Angular apps 应用程序由 Angular Modules 模块组成，模块包含了组件和应用程序所需的一切信息。</p></li> 
   <li><p>模块如果需要什么东西，那就导入 (import)&nbsp;它。</p></li> 
   <li><p>每个 Angular 应用都有一个根模块类。</p></li> 
   <li><p>对于组件很少的简单应用来说，只用一个根模块就足够了。 随着应用规模的增长，我们逐步从根模块中重构出一些特性模块，来代表一组相关功能的集合。 然后，在根模块中导入它们。</p></li> 
  </ul> <p><strong>Module 模块定义语法</strong>：</p> 
  <div class="highlight highlight-source-js">
   <pre><span class="pl-smi">ng</span>.<span class="pl-smi">core</span>.<span class="pl-en">NgModule</span>({
    <span class="pl-k">...</span>
}).<span class="pl-en">Class</span>({
    <span class="pl-en">constructor</span><span class="pl-k">:</span><span class="pl-k">function</span>(){
    }
    <span class="pl-k">...</span>
});</pre>
  </div> <p><strong>app.module.js</strong>:</p> 
  <div class="highlight highlight-source-js">
   <pre>(<span class="pl-k">function</span>(<span class="pl-smi">app</span>) {
  <span class="pl-smi">app</span>.<span class="pl-smi">AppModule</span> <span class="pl-k">=</span>
    <span class="pl-c"><span class="pl-c">//</span> 模块定义</span>
    <span class="pl-smi">ng</span>.<span class="pl-smi">core</span>.<span class="pl-en">NgModule</span>({
      imports<span class="pl-k">:</span> [ <span class="pl-smi">ng</span>.<span class="pl-smi">platformBrowser</span>.<span class="pl-smi">BrowserModule</span>, <span class="pl-smi">ng</span>.<span class="pl-c1">forms</span>.<span class="pl-smi">FormsModule</span> ], 
      declarations<span class="pl-k">:</span> [ <span class="pl-smi">app</span>.<span class="pl-smi">AppComponent</span> ], <span class="pl-c"><span class="pl-c">//</span> 添加 HeroFormComponent</span>
      bootstrap<span class="pl-k">:</span> [ <span class="pl-smi">app</span>.<span class="pl-smi">AppComponent</span>] <span class="pl-c"><span class="pl-c">//</span> 根组件</span>
    })
    .<span class="pl-en">Class</span>({
      <span class="pl-en">constructor</span><span class="pl-k">:</span> <span class="pl-k">function</span>() {
      }
    });
})(<span class="pl-c1">window</span>.<span class="pl-smi">app</span> <span class="pl-k">||</span> (<span class="pl-c1">window</span>.<span class="pl-smi">app</span> <span class="pl-k">=</span> {}));</pre>
  </div> </li> 
 <li> <p>为主 Web 应用页面编写引导/启动文件（<code>main.js</code>）</p> <p><code>ng.core.enableProdMode();</code>：在产品发布时可以启用产品模式，禁用不必要的开发检测跟踪。</p> <p><strong>main.js</strong>:</p> 
  <div class="highlight highlight-source-js">
   <pre>(<span class="pl-k">function</span>(<span class="pl-smi">app</span>) {
  <span class="pl-c1">document</span>.<span class="pl-c1">addEventListener</span>(<span class="pl-s"><span class="pl-pds">'</span>DOMContentLoaded<span class="pl-pds">'</span></span>, <span class="pl-k">function</span>() {
     <span class="pl-c"><span class="pl-c">//</span> 启用产品模式（ production mode）运行，禁用开发模式（development mod）</span>
        <span class="pl-c"><span class="pl-c">//</span>  ng.core.enableProdMode();</span>
    <span class="pl-smi">ng</span>.<span class="pl-smi">platformBrowserDynamic</span>
      .<span class="pl-en">platformBrowserDynamic</span>()
      .<span class="pl-en">bootstrapModule</span>(<span class="pl-smi">app</span>.<span class="pl-smi">AppModule</span>); <span class="pl-c"><span class="pl-c">//</span> 启动 AppModule</span>
    });
})(<span class="pl-c1">window</span>.<span class="pl-smi">app</span> <span class="pl-k">||</span> (<span class="pl-c1">window</span>.<span class="pl-smi">app</span> <span class="pl-k">=</span> {}));</pre>
  </div> </li> 
 <li> <p>编写 Web 应用主页面（<code>index.html</code>）</p> <p><strong>index.html</strong>:</p> 
  <div class="highlight highlight-text-html-basic">
   <pre>&lt;!doctype html&gt;
&lt;<span class="pl-ent">html</span>&gt;
    &lt;<span class="pl-ent">head</span>&gt;
<span class="pl-s1">        &lt;<span class="pl-ent">script</span>&gt;<span class="pl-c1">document</span>.<span class="pl-c1">write</span>(<span class="pl-s"><span class="pl-pds">'</span>&lt;base href=&quot;<span class="pl-pds">'</span></span> <span class="pl-k">+</span> <span class="pl-c1">document</span>.<span class="pl-c1">location</span> <span class="pl-k">+</span> <span class="pl-s"><span class="pl-pds">'</span>&quot; /&gt;<span class="pl-pds">'</span></span>);&lt;/<span class="pl-ent">script</span>&gt;</span>
        &lt;<span class="pl-ent">meta</span> <span class="pl-e">charset</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>utf-8<span class="pl-pds">&quot;</span></span> /&gt;
        &lt;<span class="pl-ent">title</span>&gt;Angular AppStore&lt;/<span class="pl-ent">title</span>&gt;
        &lt;<span class="pl-ent">meta</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>viewport<span class="pl-pds">&quot;</span></span> <span class="pl-e">content</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>width=device-width, initial-scale=1<span class="pl-pds">&quot;</span></span>&gt;
        <span class="pl-c"><span class="pl-c">&lt;!--</span> CSS<span class="pl-c">--&gt;</span></span>
        &lt;<span class="pl-ent">link</span> <span class="pl-e">rel</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>stylesheet<span class="pl-pds">&quot;</span></span> <span class="pl-e">href</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>css/bootstrap.min.css<span class="pl-pds">&quot;</span></span>&gt;
        &lt;<span class="pl-ent">link</span> <span class="pl-e">rel</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>stylesheet<span class="pl-pds">&quot;</span></span> <span class="pl-e">href</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>css/styles.css<span class="pl-pds">&quot;</span></span>&gt;
        &lt;<span class="pl-ent">link</span> <span class="pl-e">rel</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>stylesheet<span class="pl-pds">&quot;</span></span> <span class="pl-e">href</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>css/forms.css<span class="pl-pds">&quot;</span></span>&gt;

        <span class="pl-c"><span class="pl-c">&lt;!--</span> 1. Load libraries <span class="pl-c">--&gt;</span></span>
        <span class="pl-c"><span class="pl-c">&lt;!--</span> IE required polyfill <span class="pl-c">--&gt;</span></span>
<span class="pl-s1">        &lt;<span class="pl-ent">script</span> <span class="pl-e">src</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>node_modules/core-js/client/shim.min.js<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">script</span>&gt;</span>

<span class="pl-s1">        &lt;<span class="pl-ent">script</span> <span class="pl-e">src</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>node_modules/zone.js/dist/zone.js<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">script</span>&gt;</span>

<span class="pl-s1">        &lt;<span class="pl-ent">script</span> <span class="pl-e">src</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>node_modules/rxjs/bundles/Rx.js<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">script</span>&gt;</span>
<span class="pl-s1">        &lt;<span class="pl-ent">script</span> <span class="pl-e">src</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>node_modules/@angular/core/bundles/core.umd.js<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">script</span>&gt;</span>
<span class="pl-s1">        &lt;<span class="pl-ent">script</span> <span class="pl-e">src</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>node_modules/@angular/common/bundles/common.umd.js<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">script</span>&gt;</span>
<span class="pl-s1">        &lt;<span class="pl-ent">script</span> <span class="pl-e">src</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>node_modules/@angular/compiler/bundles/compiler.umd.js<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">script</span>&gt;</span>
<span class="pl-s1">        &lt;<span class="pl-ent">script</span> <span class="pl-e">src</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>node_modules/@angular/platform-browser/bundles/platform-browser.umd.js<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">script</span>&gt;</span>
<span class="pl-s1">        &lt;<span class="pl-ent">script</span> <span class="pl-e">src</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>node_modules/@angular/platform-browser-dynamic/bundles/platform-browser-dynamic.umd.js<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">script</span>&gt;</span>
<span class="pl-s1">        &lt;<span class="pl-ent">script</span> <span class="pl-e">src</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>node_modules/@angular/forms/bundles/forms.umd.min.js<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">script</span>&gt;</span>
<span class="pl-s1">        &lt;<span class="pl-ent">script</span> <span class="pl-e">src</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>node_modules/@angular/router/bundles/router.umd.min.js<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">script</span>&gt;</span>

        <span class="pl-c"><span class="pl-c">&lt;!--</span> 2. Load our 'modules' <span class="pl-c">--&gt;</span></span>
<span class="pl-s1">        &lt;<span class="pl-ent">script</span> <span class="pl-e">src</span>=<span class="pl-s"><span class="pl-pds">'</span>app/app.component.js<span class="pl-pds">'</span></span>&gt;&lt;/<span class="pl-ent">script</span>&gt;</span>
<span class="pl-s1">        &lt;<span class="pl-ent">script</span> <span class="pl-e">src</span>=<span class="pl-s"><span class="pl-pds">'</span>app/app.module.js<span class="pl-pds">'</span></span>&gt;&lt;/<span class="pl-ent">script</span>&gt; </span>
<span class="pl-s1">        &lt;<span class="pl-ent">script</span> <span class="pl-e">src</span>=<span class="pl-s"><span class="pl-pds">'</span>main.js<span class="pl-pds">'</span></span>&gt;&lt;/<span class="pl-ent">script</span>&gt;</span>

    &lt;/<span class="pl-ent">head</span>&gt;

    <span class="pl-c"><span class="pl-c">&lt;!--</span> 3. Display the application <span class="pl-c">--&gt;</span></span>
    &lt;<span class="pl-ent">body</span>&gt;
        &lt;<span class="pl-ent">appstore</span><span class="pl-e">-app</span>&gt;Loading...&lt;/<span class="pl-ent">appstore</span><span class="pl-e">-app</span>&gt;
    &lt;/<span class="pl-ent">body</span>&gt;
&lt;/<span class="pl-ent">html</span>&gt;</pre>
  </div> </li> 
 <li> <p>添加 CSS 样式（<code>bootstrap.min.css</code>，<code>forms.css</code>，<code>style.css</code>）</p> <p><strong>bootstrap.min.css</strong>:</p> <p>bootstrap CSS，从 <code>step1-init</code> 获取。你也可以选择自己喜欢的样式组件，Angular 并不限制对样式组件的使用，并能很好的和这些组件一起工作。</p> <p><strong>forms.css</strong>:</p> <p>定义带验证视觉效果的表单样式。</p> 
  <div class="highlight highlight-source-css">
   <pre><span class="pl-e">.ng-valid</span>[<span class="pl-e">required</span>], <span class="pl-e">.ng-valid.required</span>  {
  <span class="pl-c1"><span class="pl-c1">border-left</span></span>: <span class="pl-c1">5<span class="pl-k">px</span></span> <span class="pl-c1">solid</span> <span class="pl-c1">#42A948</span>; <span class="pl-c"><span class="pl-c">/*</span> green <span class="pl-c">*/</span></span>
}

<span class="pl-e">.ng-invalid</span><span class="pl-e">:not</span>(<span class="pl-ent">form</span>)  {
  <span class="pl-c1"><span class="pl-c1">border-left</span></span>: <span class="pl-c1">5<span class="pl-k">px</span></span> <span class="pl-c1">solid</span> <span class="pl-c1">#a94442</span>; <span class="pl-c"><span class="pl-c">/*</span> red <span class="pl-c">*/</span></span>
}</pre>
  </div> <p><strong>styles.css</strong>:</p> <p>通用样式。</p> 
  <div class="highlight highlight-source-css">
   <pre><span class="pl-ent">h1</span> {
    <span class="pl-c1"><span class="pl-c1">color</span></span>: <span class="pl-c1">#369</span>;
    <span class="pl-c1"><span class="pl-c1">font-family</span></span>: <span class="pl-c1">Arial</span>, <span class="pl-c1">Helvetica</span>, <span class="pl-c1">sans-serif</span>;
    <span class="pl-c1"><span class="pl-c1">font-size</span></span>: <span class="pl-c1">250<span class="pl-k">%</span></span>;
}

<span class="pl-ent">body</span> {
    <span class="pl-c1"><span class="pl-c1">margin</span></span>: <span class="pl-c1">2<span class="pl-k">em</span></span>;
}</pre>
  </div> </li> 
</ol> 
<h2> <a id="2-组件和模块信息定义" class="anchor" href="#2-%E7%BB%84%E4%BB%B6%E5%92%8C%E6%A8%A1%E5%9D%97%E4%BF%A1%E6%81%AF%E5%AE%9A%E4%B9%89" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>2. 组件和模块信息定义</h2> 
<p>实现代码：<code>step2-components&amp;modules</code></p> 
<p><a href="doc/images/step2-demo.png" target="_blank"><img src="doc/images/step2-demo.png" alt="Example" style="max-width:100%;" /></a></p> 
<p>为每个管理功能创建独立的<code>目录</code>和 <code>Module 模块</code>，有利于复杂应用的开发管理。</p> 
<h3> <a id="开发指导规范" class="anchor" href="#%E5%BC%80%E5%8F%91%E6%8C%87%E5%AF%BC%E8%A7%84%E8%8C%83" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>　开发指导规范</h3> 
<ul> 
 <li><p>职责单一原则，每个文件只定义一样东西，每个组件单独定义文件</p></li> 
 <li> <p>为应用中每个明显的具有多个伴随文件 (<code>.js</code>、<code>.html</code>何<code>.css</code>)的特性创建一个文件夹</p> 
  <ul> 
   <li>如 <code>app/application</code>，<code>app/application/application-detail</code> </li> 
  </ul> </li> 
 <li> <p>文件命名要求 <code>feature.type.extension</code></p> 
  <ul> 
   <li><p><code>feature 功能</code>：使用横杠来分隔多个单词</p></li> 
   <li><p><code>type 类型</code>：<code>component</code>, <code>service</code>, <code>module</code>, <code>directive</code>...</p></li> 
   <li><p><code>extension 扩展名</code>：<code>js</code>, <code>css</code>, <code>html</code>...</p></li> 
   <li><p>如：<code>application-detail.component.js</code></p></li> 
  </ul> </li> 
 <li> <p>把组件的模板和样式提取到它们自己的文件</p> 
  <ul> 
   <li><p><code>[component-name].component.html</code></p></li> 
   <li><p><code>[component-name].component.css</code></p></li> 
  </ul> </li> 
 <li> <p>类名称与文件名一致，并添加类型后缀</p> 
  <ul> 
   <li><p><code>ApplicationComponent</code>：application.component.js:</p></li> 
   <li><p><code>ApplicationModule</code>：application.module.js</p></li> 
  </ul> </li> 
 <li> <p>在组件中只包含与视图相关的逻辑，其它逻辑都应该放到 <code>Service</code> 服务中 </p> 
  <ul> 
   <li><code>[component-name].service.js</code></li> 
  </ul> </li> 
 <li> <p>使用中线 (<code>dashed</code>) 或烤串 (<code>kebab</code>) 命名法来命名组件中的元素选择器</p> 
  <ul> 
   <li>正确示例：selector: '<code>admin-users</code>'</li> 
  </ul> </li> 
 <li> <p>把组件当做元素，坚持通过选择器将组件直接定义为元素</p> 
  <ul> 
   <li>错误示例：selector: '<code>[admin-users]</code>',</li> 
  </ul> </li> 
</ul> 
<h3> <a id="组件和模块信息定义" class="anchor" href="#%E7%BB%84%E4%BB%B6%E5%92%8C%E6%A8%A1%E5%9D%97%E4%BF%A1%E6%81%AF%E5%AE%9A%E4%B9%89" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>组件和模块信息定义</h3> 
<p><a href="doc/images/step2.png" target="_blank"><img src="doc/images/step2.png" alt="Example" style="max-width:100%;" /></a></p> 
<p>定义应用管理功能的模块和组件文件:</p> 
<ul> 
 <li><p>应用管理功能模块（<code>ApplicationModule</code>）</p></li> 
 <li><p>应用列表组件（<code>ApplicationsComponent</code>）</p></li> 
 <li><p>应用详情组件（<code>ApplicationDetailComponent</code>） </p></li> 
</ul> 
<p>为 <code>angular-appstore</code> 的应用管理功能创建一个专门的目录 <code>src/app/application</code>，存放应用管理功能的所有组件文件，并创建一个子目录 <code>src/app/application/application-detail</code> 存放应用详情组件。</p> 
<h3> <a id="实现步骤" class="anchor" href="#%E5%AE%9E%E7%8E%B0%E6%AD%A5%E9%AA%A4" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>实现步骤</h3> 
<ol> 
 <li> <p>定义应用组件 ApplicationsComponent（<code>applications.component.js</code>）和相关模板文件（<code>applications.component.html</code>）</p> <p><strong>applications.component.js</strong>:</p> 
  <div class="highlight highlight-source-js">
   <pre>(<span class="pl-k">function</span>(<span class="pl-smi">app</span>) {
    <span class="pl-smi">app</span>.<span class="pl-smi">ApplicationsComponent</span> <span class="pl-k">=</span> <span class="pl-smi">ng</span>.<span class="pl-smi">core</span>
        .<span class="pl-en">Component</span>({
            selector<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>application-list<span class="pl-pds">'</span></span>,
            templateUrl<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>app/application/applications.component.html<span class="pl-pds">'</span></span>
        })
        .<span class="pl-en">Class</span>({
            <span class="pl-en">constructor</span><span class="pl-k">:</span> <span class="pl-k">function</span>() {
            }
        });
})(<span class="pl-c1">window</span>.<span class="pl-smi">app</span> <span class="pl-k">||</span> (<span class="pl-c1">window</span>.<span class="pl-smi">app</span> <span class="pl-k">=</span> {}));</pre>
  </div> <p><strong>applications.component.html</strong>:</p> 
  <div class="highlight highlight-text-html-basic">
   <pre>应用列表
...
<span class="pl-c"><span class="pl-c">&lt;!--</span> 在应用列表后此处渲染显示引用详情 <span class="pl-c">--&gt;</span></span>
<span class="pl-c"><span class="pl-c">&lt;!--</span> `ApplicationDetailComponent` 中的模板内容会渲染到  `selector` 选择器选择的标签中。将标签定义在 `ApplicationComponent` 中 <span class="pl-c">--&gt;</span></span>
&lt;<span class="pl-ent">application</span><span class="pl-e">-detail</span>&gt;&lt;/<span class="pl-ent">application</span><span class="pl-e">-detail</span>&gt;</pre>
  </div> </li> 
 <li> <p>定义应用详情组件 ApplicationDetailComponent（<code>application-detail.component.js</code>）和相关模板文件（<code>application-detail.component.html</code>）</p> <p><strong>application-detail.component.js</strong>：</p> 
  <div class="highlight highlight-source-js">
   <pre>(<span class="pl-k">function</span>(<span class="pl-smi">app</span>) {
    <span class="pl-smi">app</span>.<span class="pl-smi">ApplicationDetailComponent</span> <span class="pl-k">=</span> <span class="pl-smi">ng</span>.<span class="pl-smi">core</span>
        .<span class="pl-en">Component</span>({
            selector<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>application-detail<span class="pl-pds">'</span></span>,
            templateUrl<span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">'</span>app/application/application-detail/application-detail.component.html<span class="pl-pds">'</span></span>
        })
        .<span class="pl-en">Class</span>({
            <span class="pl-en">constructor</span><span class="pl-k">:</span> <span class="pl-k">function</span>() {
            }
        });
})(<span class="pl-c1">window</span>.<span class="pl-smi">app</span> <span class="pl-k">||</span> (<span class="pl-c1">window</span>.<span class="pl-smi">app</span> <span class="pl-k">=</span> {}));</pre>
  </div> <p><strong>application-detail.component.html</strong>：</p> 
  <div class="highlight highlight-text-html-basic">
   <pre>应用详情
...</pre>
  </div> </li> 
 <li> <p>在 AppComponent 中定义组件显示标签</p> <p><code>ApplicationsComponent</code> 中的模板内容会渲染到 <code>selector</code> 选择器选择的标签中。将标签定义在 <code>AppComponent</code> 中。</p> <p><strong>app.component.js</strong>：</p> 
  <div class="highlight highlight-source-js">
   <pre>(<span class="pl-k">function</span>(<span class="pl-smi">app</span>) {
    <span class="pl-smi">app</span>.<span class="pl-smi">AppComponent</span> <span class="pl-k">=</span> <span class="pl-smi">ng</span>.<span class="pl-smi">core</span>
        .<span class="pl-en">Component</span>({
            selector<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>appstore-app<span class="pl-pds">'</span></span>, 
            template<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">`</span></span>
<span class="pl-s">            &lt;h1&gt; {{title}} &lt;/h1&gt;</span>
<span class="pl-s">            &lt;application-list&gt;&lt;/application-list&gt;</span>
<span class="pl-s">            <span class="pl-pds">`</span></span>,
            styleUrls<span class="pl-k">:</span> [<span class="pl-s"><span class="pl-pds">'</span>app/app.component.css<span class="pl-pds">'</span></span>]
        })
        .<span class="pl-en">Class</span>({
            <span class="pl-en">constructor</span><span class="pl-k">:</span> <span class="pl-k">function</span>() {
                <span class="pl-c1">this</span>.<span class="pl-c1">title</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">&quot;</span>Angular App Store<span class="pl-pds">&quot;</span></span>;
            }
        });
})(<span class="pl-c1">window</span>.<span class="pl-smi">app</span> <span class="pl-k">||</span> (<span class="pl-c1">window</span>.<span class="pl-smi">app</span> <span class="pl-k">=</span> {}));</pre>
  </div> </li> 
 <li> <p>在 ApplicationsModule（<code>applications.module.js</code>） 中定义和导出组件</p> <p>将之前定义的 <code>ApplicationsComponent</code> 和 <code>ApplicationDetailComponent</code> 组件在应用管理模块声明并导出。</p> <p><strong>applications.module.js</strong></p> 
  <div class="highlight highlight-source-js">
   <pre>(<span class="pl-k">function</span>(<span class="pl-smi">app</span>) {
    <span class="pl-smi">app</span>.<span class="pl-smi">ApplicationsModule</span> <span class="pl-k">=</span> <span class="pl-smi">ng</span>.<span class="pl-smi">core</span>
        .<span class="pl-en">NgModule</span>({
            <span class="pl-c"><span class="pl-c">//</span> 导入的模块</span>
            imports<span class="pl-k">:</span> [<span class="pl-smi">ng</span>.<span class="pl-smi">platformBrowser</span>.<span class="pl-smi">BrowserModule</span>, <span class="pl-smi">ng</span>.<span class="pl-c1">forms</span>.<span class="pl-smi">FormsModule</span>],
            <span class="pl-c"><span class="pl-c">//</span> 定义声明模块</span>
            declarations<span class="pl-k">:</span> [<span class="pl-smi">app</span>.<span class="pl-smi">ApplicationsComponent</span>, <span class="pl-smi">app</span>.<span class="pl-smi">ApplicationDetailComponent</span>],
            <span class="pl-c"><span class="pl-c">//</span> 导出模块</span>
            exports<span class="pl-k">:</span> [<span class="pl-smi">app</span>.<span class="pl-smi">ApplicationsComponent</span>, <span class="pl-smi">app</span>.<span class="pl-smi">ApplicationDetailComponent</span>]
        })
        .<span class="pl-en">Class</span>({
            <span class="pl-en">constructor</span><span class="pl-k">:</span> <span class="pl-k">function</span>() {}
        });
})(<span class="pl-c1">window</span>.<span class="pl-smi">app</span> <span class="pl-k">||</span> (<span class="pl-c1">window</span>.<span class="pl-smi">app</span> <span class="pl-k">=</span> {}));</pre>
  </div> </li> 
 <li> <p>在 AppModule（<code>app.module.js</code>） 中导入开发的应用管理功能模块 ApplicationModule（<code>applications.module.js</code>）</p> <p>为每个主要功能定义独立的模块，然后在主模块中 <code>imports</code> 导入，可以使得大项目结构更加清晰有序。</p> <p><strong>app.module.js</strong></p> 
  <div class="highlight highlight-source-js">
   <pre>(<span class="pl-k">function</span>(<span class="pl-smi">app</span>) {
  <span class="pl-smi">app</span>.<span class="pl-smi">AppModule</span> <span class="pl-k">=</span>
    <span class="pl-c"><span class="pl-c">//</span> 模块定义</span>
    <span class="pl-smi">ng</span>.<span class="pl-smi">core</span>.<span class="pl-en">NgModule</span>({
        <span class="pl-c"><span class="pl-c">//</span> 导入的模块</span>
      imports<span class="pl-k">:</span> [ <span class="pl-smi">ng</span>.<span class="pl-smi">platformBrowser</span>.<span class="pl-smi">BrowserModule</span>, <span class="pl-smi">ng</span>.<span class="pl-c1">forms</span>.<span class="pl-smi">FormsModule</span>, <span class="pl-smi">app</span>.<span class="pl-smi">ApplicationsModule</span> ], 
      declarations<span class="pl-k">:</span> [ <span class="pl-smi">app</span>.<span class="pl-smi">AppComponent</span> ], 
      bootstrap<span class="pl-k">:</span> [ <span class="pl-smi">app</span>.<span class="pl-smi">AppComponent</span>] 
    })
    .<span class="pl-en">Class</span>({
      <span class="pl-en">constructor</span><span class="pl-k">:</span> <span class="pl-k">function</span>() {
      }
    });
})(<span class="pl-c1">window</span>.<span class="pl-smi">app</span> <span class="pl-k">||</span> (<span class="pl-c1">window</span>.<span class="pl-smi">app</span> <span class="pl-k">=</span> {}));</pre>
  </div> </li> 
 <li> <p>在 <code>index.html</code> 中引入开发的 <code>js</code> 文件</p> 
  <div class="highlight highlight-text-html-basic">
   <pre>&lt;<span class="pl-ent">script</span> <span class="pl-e">src</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>app/application/applications.component.js<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">script</span>&gt;
&lt;<span class="pl-ent">script</span> <span class="pl-e">src</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>app/application/application-detail/application-detail.component.js<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">script</span>&gt;
&lt;<span class="pl-ent">script</span> <span class="pl-e">src</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>app/application/applications.module.js<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">script</span>&gt;</pre>
  </div> </li> 
</ol> 
<h2> <a id="3-类数据及模板初始化" class="anchor" href="#3-%E7%B1%BB%E6%95%B0%E6%8D%AE%E5%8F%8A%E6%A8%A1%E6%9D%BF%E5%88%9D%E5%A7%8B%E5%8C%96" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>3. 类数据及模板初始化</h2> 
<p>实现代码：<code>step3-components&amp;modules</code></p> 
<p>通过类，模拟数据和 HTML 模板，将效果展现出来。</p> 
<p><a href="doc/images/step3-demo.png" target="_blank"><img src="doc/images/step3-demo.png" alt="Example" style="max-width:100%;" /></a></p> 
<h3> <a id="添加类文件" class="anchor" href="#%E6%B7%BB%E5%8A%A0%E7%B1%BB%E6%96%87%E4%BB%B6" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>添加类文件</h3> 
<p><a href="doc/images/step3.png" target="_blank"><img src="doc/images/step3.png" alt="Example" style="max-width:100%;" /></a></p> 
<h3> <a id="实现步骤-1" class="anchor" href="#%E5%AE%9E%E7%8E%B0%E6%AD%A5%E9%AA%A4-1" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>实现步骤</h3> 
<ol> 
 <li> <p>创建应用类（<code>Application.js</code>），保存应用信息</p> <p><strong>Application.js</strong>:</p> 
  <div class="highlight highlight-source-js">
   <pre>(<span class="pl-k">function</span>(<span class="pl-smi">app</span>) {
  <span class="pl-smi">app</span>.<span class="pl-smi">Application</span> <span class="pl-k">=</span> Application;

  <span class="pl-c"><span class="pl-c">/**</span></span>
<span class="pl-c">   * 应用类</span>
<span class="pl-c">   * <span class="pl-k">@param</span> <span class="pl-en">{number}</span> <span class="pl-smi">id</span> </span>
<span class="pl-c">   * <span class="pl-k">@param</span> <span class="pl-en">{string}</span> <span class="pl-smi">name</span> 名称</span>
<span class="pl-c">   * <span class="pl-k">@param</span> <span class="pl-en">{number}</span> <span class="pl-smi">downloads</span> 下载量</span>
<span class="pl-c">   * <span class="pl-k">@param</span> <span class="pl-en">{string}</span> <span class="pl-smi">category</span> 分类</span>
<span class="pl-c">   <span class="pl-c">*/</span></span>
  <span class="pl-k">function</span> <span class="pl-en">Application</span>(<span class="pl-smi">id</span>, <span class="pl-smi">name</span>, <span class="pl-smi">downloads</span>, <span class="pl-smi">category</span>) {
    <span class="pl-c1">this</span>.<span class="pl-c1">id</span> <span class="pl-k">=</span> id;
    <span class="pl-c1">this</span>.<span class="pl-c1">name</span> <span class="pl-k">=</span> name;
    <span class="pl-c1">this</span>.<span class="pl-smi">downloads</span> <span class="pl-k">=</span> downloads;
    <span class="pl-c1">this</span>.<span class="pl-smi">category</span> <span class="pl-k">=</span> category;
  }
})(<span class="pl-c1">window</span>.<span class="pl-smi">app</span> <span class="pl-k">||</span> (<span class="pl-c1">window</span>.<span class="pl-smi">app</span> <span class="pl-k">=</span> {}));</pre>
  </div> </li> 
 <li> <p>创建分类类（<code>Category.js</code>），保存分类信息</p> <p>由于应用需要分类数据，在 app 目录下创建一个 <code>category 分类管理功能</code>目录，并创建 <code>Category.js</code> 类别类：</p> <p><strong>app/category/Category.js</strong>:</p> 
  <div class="highlight highlight-source-js">
   <pre>(<span class="pl-k">function</span>(<span class="pl-smi">app</span>) {
  <span class="pl-smi">app</span>.<span class="pl-smi">Category</span> <span class="pl-k">=</span> Category;

  <span class="pl-c"><span class="pl-c">/**</span></span>
<span class="pl-c">   * 应用类别类</span>
<span class="pl-c">   * <span class="pl-k">@param</span> <span class="pl-en">{number}</span> <span class="pl-smi">id</span> </span>
<span class="pl-c">   * <span class="pl-k">@param</span> <span class="pl-en">{string}</span> <span class="pl-smi">name</span> 分类名称</span>
<span class="pl-c">   <span class="pl-c">*/</span></span>
  <span class="pl-k">function</span> <span class="pl-en">Category</span>(<span class="pl-smi">id</span>, <span class="pl-smi">name</span>) {
    <span class="pl-c1">this</span>.<span class="pl-c1">id</span> <span class="pl-k">=</span> id;
    <span class="pl-c1">this</span>.<span class="pl-c1">name</span> <span class="pl-k">=</span> name;
  }
})(<span class="pl-c1">window</span>.<span class="pl-smi">app</span> <span class="pl-k">||</span> (<span class="pl-c1">window</span>.<span class="pl-smi">app</span> <span class="pl-k">=</span> {}));</pre>
  </div> </li> 
 <li> <p>在 <code>index.html</code> 页面引入新添加的类文件</p> 
  <div class="highlight highlight-text-html-basic">
   <pre>&lt;<span class="pl-ent">script</span> <span class="pl-e">src</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>app/category/Category.js<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">script</span>&gt;
&lt;<span class="pl-ent">script</span> <span class="pl-e">src</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>app/application/Application.js<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">script</span>&gt;</pre>
  </div> </li> 
 <li> <p>编写应用列表模板（<code>applications.component.html</code>）</p> <p><strong>applications.component.html</strong>:</p> 
  <div class="highlight highlight-text-html-basic">
   <pre>&lt;<span class="pl-ent">div</span> <span class="pl-e">class</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>container<span class="pl-pds">&quot;</span></span>&gt;
    &lt;<span class="pl-ent">table</span> <span class="pl-e">class</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>table table-hover<span class="pl-pds">&quot;</span></span>&gt;
        &lt;<span class="pl-ent">tr</span>&gt;
            &lt;<span class="pl-ent">th</span>&gt;编号&lt;/<span class="pl-ent">th</span>&gt;
            &lt;<span class="pl-ent">th</span>&gt;应用名称&lt;/<span class="pl-ent">th</span>&gt;
            &lt;<span class="pl-ent">th</span>&gt;下载量&lt;/<span class="pl-ent">th</span>&gt;
            &lt;<span class="pl-ent">th</span>&gt;类别&lt;/<span class="pl-ent">th</span>&gt;
        &lt;/<span class="pl-ent">tr</span>&gt;
        &lt;<span class="pl-ent">tr</span> *<span class="pl-e">ngFor</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>let application of applications<span class="pl-pds">&quot;</span></span>&gt;
            &lt;<span class="pl-ent">td</span>&gt;
                {{application.id}}
            &lt;/<span class="pl-ent">td</span>&gt;
            &lt;<span class="pl-ent">td</span>&gt;
                {{application.name}}
            &lt;/<span class="pl-ent">td</span>&gt;
            &lt;<span class="pl-ent">td</span>&gt;
                {{application.downloads}}
            &lt;/<span class="pl-ent">td</span>&gt;
            &lt;<span class="pl-ent">td</span>&gt;
                {{application.category}}
            &lt;/<span class="pl-ent">td</span>&gt;
        &lt;/<span class="pl-ent">tr</span>&gt;
    &lt;/<span class="pl-ent">table</span>&gt;
&lt;/<span class="pl-ent">div</span>&gt;
<span class="pl-c"><span class="pl-c">&lt;!--</span> 应用详情组件标签 <span class="pl-c">--&gt;</span></span>
&lt;<span class="pl-ent">application</span><span class="pl-e">-detail</span>&gt;&lt;/<span class="pl-ent">application</span><span class="pl-e">-detail</span>&gt;</pre>
  </div> </li> 
 <li> <p>在父组件 ApplicationsComponent 中初始化数据</p> <p><strong>applications.component.js</strong>:</p> 
  <div class="highlight highlight-source-js">
   <pre>(<span class="pl-k">function</span>(<span class="pl-smi">app</span>) {

    <span class="pl-c"><span class="pl-c">//</span> 模拟数据</span>
    <span class="pl-k">const</span> <span class="pl-c1">CATEGORYS</span><span class="pl-k">=</span>[
        <span class="pl-k">new</span> <span class="pl-en">app.Category</span>(<span class="pl-c1">1</span>, <span class="pl-s"><span class="pl-pds">'</span>应用<span class="pl-pds">'</span></span>),
        <span class="pl-k">new</span> <span class="pl-en">app.Category</span>(<span class="pl-c1">2</span>, <span class="pl-s"><span class="pl-pds">'</span>游戏<span class="pl-pds">'</span></span>),
        <span class="pl-k">new</span> <span class="pl-en">app.Category</span>(<span class="pl-c1">3</span>, <span class="pl-s"><span class="pl-pds">'</span>音乐<span class="pl-pds">'</span></span>),
        <span class="pl-k">new</span> <span class="pl-en">app.Category</span>(<span class="pl-c1">4</span>, <span class="pl-s"><span class="pl-pds">'</span>图书<span class="pl-pds">'</span></span>)
    ];
    <span class="pl-k">const</span> <span class="pl-c1">APPLICATIONS</span><span class="pl-k">=</span>[
        <span class="pl-k">new</span> <span class="pl-en">app.Application</span>(<span class="pl-c1">1001</span>, <span class="pl-s"><span class="pl-pds">'</span>Angular App<span class="pl-pds">'</span></span>, <span class="pl-c1">300</span>, <span class="pl-c1">CATEGORYS</span>[<span class="pl-c1">0</span>].<span class="pl-c1">name</span>),
        <span class="pl-k">new</span> <span class="pl-en">app.Application</span>(<span class="pl-c1">1002</span>, <span class="pl-s"><span class="pl-pds">'</span>Big Game<span class="pl-pds">'</span></span>, <span class="pl-c1">120</span>, <span class="pl-c1">CATEGORYS</span>[<span class="pl-c1">1</span>].<span class="pl-c1">name</span>),
        <span class="pl-k">new</span> <span class="pl-en">app.Application</span>(<span class="pl-c1">1003</span>, <span class="pl-s"><span class="pl-pds">'</span>Fantasy<span class="pl-pds">'</span></span>, <span class="pl-c1">240</span>, <span class="pl-c1">CATEGORYS</span>[<span class="pl-c1">2</span>].<span class="pl-c1">name</span>),
        <span class="pl-k">new</span> <span class="pl-en">app.Application</span>(<span class="pl-c1">1004</span>, <span class="pl-s"><span class="pl-pds">'</span>Think in Java<span class="pl-pds">'</span></span>, <span class="pl-c1">480</span>, <span class="pl-c1">CATEGORYS</span>[<span class="pl-c1">3</span>].<span class="pl-c1">name</span>),
        <span class="pl-k">new</span> <span class="pl-en">app.Application</span>(<span class="pl-c1">1005</span>, <span class="pl-s"><span class="pl-pds">'</span>Bang Game<span class="pl-pds">'</span></span>, <span class="pl-c1">310</span>, <span class="pl-c1">CATEGORYS</span>[<span class="pl-c1">1</span>].<span class="pl-c1">name</span>),
        <span class="pl-k">new</span> <span class="pl-en">app.Application</span>(<span class="pl-c1">1006</span>, <span class="pl-s"><span class="pl-pds">'</span>The Mythical Man-Month<span class="pl-pds">'</span></span>, <span class="pl-c1">680</span>, <span class="pl-c1">CATEGORYS</span>[<span class="pl-c1">3</span>].<span class="pl-c1">name</span>),
        <span class="pl-k">new</span> <span class="pl-en">app.Application</span>(<span class="pl-c1">1007</span>, <span class="pl-s"><span class="pl-pds">'</span>BootStrap App<span class="pl-pds">'</span></span>, <span class="pl-c1">290</span>, <span class="pl-c1">CATEGORYS</span>[<span class="pl-c1">0</span>].<span class="pl-c1">name</span>)
    ];

    <span class="pl-smi">app</span>.<span class="pl-smi">ApplicationsComponent</span> <span class="pl-k">=</span> <span class="pl-smi">ng</span>.<span class="pl-smi">core</span>
        .<span class="pl-en">Component</span>({
            selector<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>application-list<span class="pl-pds">'</span></span>,
            templateUrl<span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">'</span>app/application/applications.component.html<span class="pl-pds">'</span></span>
        })
        .<span class="pl-en">Class</span>({
            <span class="pl-en">constructor</span><span class="pl-k">:</span> <span class="pl-k">function</span>() {
                <span class="pl-c"><span class="pl-c">//</span> 分类和应用数据列表</span>
                <span class="pl-c1">this</span>.<span class="pl-smi">categories</span> <span class="pl-k">=</span> <span class="pl-c1">CATEGORYS</span>;
                <span class="pl-c1">this</span>.<span class="pl-smi">applications</span> <span class="pl-k">=</span> <span class="pl-c1">APPLICATIONS</span>;
            }
        });
})(<span class="pl-c1">window</span>.<span class="pl-smi">app</span> <span class="pl-k">||</span> (<span class="pl-c1">window</span>.<span class="pl-smi">app</span> <span class="pl-k">=</span> {}));</pre>
  </div> </li> 
 <li><p>测试</p></li> 
</ol> 
<h2> <a id="4-数据绑定事件处理" class="anchor" href="#4-%E6%95%B0%E6%8D%AE%E7%BB%91%E5%AE%9A%E4%BA%8B%E4%BB%B6%E5%A4%84%E7%90%86" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>4. 数据绑定事件处理</h2> 
<p>实现代码：<code>step4-databinding&amp;event</code></p> 
<p>通过事件处理和数据绑定，实现应用数据的增删改查。</p> 
<ul> 
 <li> <p>在 <code>applications.component.html</code> 中增加添加数据表单</p> 
  <ul> 
   <li>编写添加数据事件处理器</li> 
  </ul> </li> 
 <li> <p>处理表格数据点击事件</p> 
  <ul> 
   <li><p>应用选中类样式</p></li> 
   <li><p>输入选中数据到 detail 详细组件</p></li> 
   <li><p>显示详情组件，数据双向绑定编辑</p></li> 
  </ul> </li> 
 <li><p>实现删除</p></li> 
</ul> 
<p><a href="doc/images/step4-demo.png" target="_blank"><img src="doc/images/step4-demo.png" alt="Example" style="max-width:100%;" /></a></p> 
<h3> <a id="实现步骤-2" class="anchor" href="#%E5%AE%9E%E7%8E%B0%E6%AD%A5%E9%AA%A4-2" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>实现步骤</h3> 
<ol> 
 <li> <p>修改 <code>applications.component.html</code> 模板</p> <p>增加应用信息添加表单，注册处理事件。</p> <p><strong>数据绑定 data binding</strong>：</p> 
  <ul> 
   <li><p><code>{{property}}</code>：插值表达式。</p></li> 
   <li><p><code>[property]</code>: 属性绑定。 </p></li> 
   <li><p><code>[class.cssClassName]</code>: CSS class 绑定 </p></li> 
   <li><p><code>(event)</code>：事件绑定。</p></li> 
  </ul> <p><strong>指令 directive</strong>：</p> <p><code>*ngFor=&quot;let i of iterator&quot;</code>：循环指令。</p> <p><code>*ngIf</code>：判断指令</p> <p><code>[(ngModel)]</code>：双向数据绑定指令</p> 
  <div class="highlight highlight-text-html-basic">
   <pre>&lt;<span class="pl-ent">div</span> <span class="pl-e">class</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>container<span class="pl-pds">&quot;</span></span>&gt;
    <span class="pl-c"><span class="pl-c">&lt;!--</span> 添加应用信息表单 <span class="pl-c">--&gt;</span></span>
    &lt;<span class="pl-ent">div</span> <span class="pl-e">style</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>margin: 20px auto; text-align: center;<span class="pl-pds">&quot;</span></span>&gt;
        &lt;<span class="pl-ent">form</span> <span class="pl-e">class</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>form-inline<span class="pl-pds">&quot;</span></span> #<span class="pl-e">addForm</span>&gt;
            &lt;<span class="pl-ent">div</span> <span class="pl-e">class</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>form-group<span class="pl-pds">&quot;</span></span>&gt;
                &lt;<span class="pl-ent">label</span> <span class="pl-e">for</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>addId<span class="pl-pds">&quot;</span></span>&gt;id&lt;/<span class="pl-ent">label</span>&gt;
                &lt;<span class="pl-ent">input</span> <span class="pl-e">type</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>text<span class="pl-pds">&quot;</span></span> <span class="pl-e">class</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>form-control<span class="pl-pds">&quot;</span></span> <span class="pl-e">id</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>addId<span class="pl-pds">&quot;</span></span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>id<span class="pl-pds">&quot;</span></span> <span class="pl-e">required</span> #<span class="pl-e">id</span>&gt;
            &lt;/<span class="pl-ent">div</span>&gt;
            &lt;<span class="pl-ent">div</span> <span class="pl-e">class</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>form-group<span class="pl-pds">&quot;</span></span>&gt;
                &lt;<span class="pl-ent">label</span> <span class="pl-e">for</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>addName<span class="pl-pds">&quot;</span></span>&gt;应用名称&lt;/<span class="pl-ent">label</span>&gt;
                &lt;<span class="pl-ent">input</span> <span class="pl-e">type</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>text<span class="pl-pds">&quot;</span></span> <span class="pl-e">class</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>form-control<span class="pl-pds">&quot;</span></span> <span class="pl-e">id</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>addName<span class="pl-pds">&quot;</span></span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>name<span class="pl-pds">&quot;</span></span> <span class="pl-e">required</span> #<span class="pl-e">name</span>&gt;
            &lt;/<span class="pl-ent">div</span>&gt;
            &lt;<span class="pl-ent">div</span> <span class="pl-e">class</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>form-group<span class="pl-pds">&quot;</span></span>&gt;
                &lt;<span class="pl-ent">label</span> <span class="pl-e">for</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>addDownloads<span class="pl-pds">&quot;</span></span>&gt;下载量&lt;/<span class="pl-ent">label</span>&gt;
                &lt;<span class="pl-ent">input</span> <span class="pl-e">type</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>text<span class="pl-pds">&quot;</span></span> <span class="pl-e">class</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>form-control<span class="pl-pds">&quot;</span></span> <span class="pl-e">id</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>addDownloads<span class="pl-pds">&quot;</span></span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>downloads<span class="pl-pds">&quot;</span></span> <span class="pl-e">required</span> #<span class="pl-e">sal</span>&gt;
            &lt;/<span class="pl-ent">div</span>&gt;
            &lt;<span class="pl-ent">div</span> <span class="pl-e">class</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>form-group<span class="pl-pds">&quot;</span></span>&gt;
                &lt;<span class="pl-ent">label</span> <span class="pl-e">for</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>addCategory<span class="pl-pds">&quot;</span></span>&gt;分类&lt;/<span class="pl-ent">label</span>&gt;
                &lt;<span class="pl-ent">select</span> <span class="pl-e">class</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>form-control<span class="pl-pds">&quot;</span></span> <span class="pl-e">id</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>addCategory<span class="pl-pds">&quot;</span></span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>category<span class="pl-pds">&quot;</span></span> #<span class="pl-e">category</span>&gt;
                   &lt;<span class="pl-ent">option</span> *<span class="pl-e">ngFor</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>let category of categories<span class="pl-pds">&quot;</span></span> [<span class="pl-e">value</span>]=<span class="pl-s"><span class="pl-pds">&quot;</span>category.name<span class="pl-pds">&quot;</span></span>&gt;{{category.name}}&lt;/<span class="pl-ent">option</span>&gt;
                &lt;/<span class="pl-ent">select</span>&gt;
            &lt;/<span class="pl-ent">div</span>&gt;
            &lt;<span class="pl-ent">button</span> <span class="pl-e">type</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>button<span class="pl-pds">&quot;</span></span> <span class="pl-e">class</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>btn btn-success<span class="pl-pds">&quot;</span></span> (<span class="pl-e">click</span>)=<span class="pl-s"><span class="pl-pds">&quot;</span>create(addForm)<span class="pl-pds">&quot;</span></span>&gt;添加&lt;/<span class="pl-ent">button</span>&gt;
        &lt;/<span class="pl-ent">form</span>&gt;
    &lt;/<span class="pl-ent">div</span>&gt;

    <span class="pl-c"><span class="pl-c">&lt;!--</span> 列表 <span class="pl-c">--&gt;</span></span>
    &lt;<span class="pl-ent">table</span> <span class="pl-e">class</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>table table-hover<span class="pl-pds">&quot;</span></span>&gt;
        &lt;<span class="pl-ent">tr</span>&gt;
            &lt;<span class="pl-ent">th</span>&gt;编号&lt;/<span class="pl-ent">th</span>&gt;
            &lt;<span class="pl-ent">th</span>&gt;应用名称&lt;/<span class="pl-ent">th</span>&gt;
            &lt;<span class="pl-ent">th</span>&gt;下载量&lt;/<span class="pl-ent">th</span>&gt;
            &lt;<span class="pl-ent">th</span>&gt;类别&lt;/<span class="pl-ent">th</span>&gt;
            &lt;<span class="pl-ent">th</span>&gt;&lt;/<span class="pl-ent">th</span>&gt;
        &lt;/<span class="pl-ent">tr</span>&gt;
        &lt;<span class="pl-ent">tr</span> *<span class="pl-e">ngFor</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>let application of applications<span class="pl-pds">&quot;</span></span> [<span class="pl-e">class</span>.<span class="pl-e">active</span>]=<span class="pl-s"><span class="pl-pds">&quot;</span>application === selectedApplication<span class="pl-pds">&quot;</span></span> (<span class="pl-e">click</span>)=<span class="pl-s"><span class="pl-pds">&quot;</span>onSelect(application)<span class="pl-pds">&quot;</span></span>&gt;
            &lt;<span class="pl-ent">td</span>&gt;
                {{application.id}}
            &lt;/<span class="pl-ent">td</span>&gt;
            &lt;<span class="pl-ent">td</span>&gt;
                {{application.name}}
            &lt;/<span class="pl-ent">td</span>&gt;
            &lt;<span class="pl-ent">td</span>&gt;
                {{application.downloads}}
            &lt;/<span class="pl-ent">td</span>&gt;
            &lt;<span class="pl-ent">td</span>&gt;
                {{application.category}}
            &lt;/<span class="pl-ent">td</span>&gt;
            &lt;<span class="pl-ent">td</span> <span class="pl-e">width</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>100<span class="pl-pds">&quot;</span></span>&gt;
                &lt;<span class="pl-ent">button</span> <span class="pl-e">class</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>btn btn-danger<span class="pl-pds">&quot;</span></span> (<span class="pl-e">click</span>)=<span class="pl-s"><span class="pl-pds">&quot;</span>delete(application);$event.stopPropagation()<span class="pl-pds">&quot;</span></span>&gt;删除&lt;/<span class="pl-ent">button</span>&gt;
            &lt;/<span class="pl-ent">td</span>&gt;
        &lt;/<span class="pl-ent">tr</span>&gt;
    &lt;/<span class="pl-ent">table</span>&gt;
&lt;/<span class="pl-ent">div</span>&gt;
<span class="pl-c"><span class="pl-c">&lt;!--</span> 从父组件传入属性值到子组件 <span class="pl-c">--&gt;</span></span>
&lt;<span class="pl-ent">application</span><span class="pl-e">-detail</span> [<span class="pl-e">categories</span>]=<span class="pl-s"><span class="pl-pds">&quot;</span>categories<span class="pl-pds">&quot;</span></span> [<span class="pl-e">selectedApplication</span>]=<span class="pl-s"><span class="pl-pds">&quot;</span>selectedApplication<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">application</span><span class="pl-e">-detail</span>&gt;</pre>
  </div> 
  <ul> 
   <li> <p><strong>添加应用信息表单</strong></p> <p><code>#addForm</code>： 模板引用变量，模板引用变量能从模块中直接访问标记的元素。在处理添加事件时，将表单对象传递到事件处理器中，获得表单的值。</p> <p><code>(click)=&quot;create(addForm)&quot;</code>：注册单击事件处理器，将 <code>addForm</code> 传递到组件的 <code>create</code> 方法中去。</p> 
    <div class="highlight highlight-text-html-basic">
     <pre>&lt;<span class="pl-ent">form</span> <span class="pl-e">class</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>form-inline<span class="pl-pds">&quot;</span></span> #<span class="pl-e">addForm</span>&gt;
    &lt;<span class="pl-ent">button</span> <span class="pl-e">type</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>button<span class="pl-pds">&quot;</span></span> <span class="pl-e">class</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>btn btn-success<span class="pl-pds">&quot;</span></span> (<span class="pl-e">click</span>)=<span class="pl-s"><span class="pl-pds">&quot;</span>create(addForm)<span class="pl-pds">&quot;</span></span>&gt;添加&lt;/<span class="pl-ent">button</span>&gt;
&lt;/<span class="pl-ent">form</span>&gt;</pre>
    </div> </li> 
   <li> <p><strong>数据选中效果</strong></p> <p>为数据行注册了 <code>(click)</code> 单击事件，并在组件中将点击的数据保存到 <code>this.selectedApplication 选中数据</code>。</p> <p>当循环的数据和 <code>this.selectedApplication</code> 一致则使用 <code>Class 绑定</code> <code>active</code> 类样式。</p> 
    <div class="highlight highlight-text-html-basic">
     <pre>&lt;<span class="pl-ent">tr</span> *<span class="pl-e">ngFor</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>let application of applications<span class="pl-pds">&quot;</span></span> [<span class="pl-e">class</span>.<span class="pl-e">active</span>]=<span class="pl-s"><span class="pl-pds">&quot;</span>application === selectedApplication<span class="pl-pds">&quot;</span></span> (<span class="pl-e">click</span>)=<span class="pl-s"><span class="pl-pds">&quot;</span>onSelect(application)<span class="pl-pds">&quot;</span></span>&gt;</pre>
    </div> </li> 
   <li> <p><strong>注册删除处理事件</strong></p> <p><strong>$event</strong>:</p> <p>绑定会通过名叫 <code>$event</code> 的事件对象传递关于此事件的信息和数据值，如果目标事件是原生 <code>DOM</code> 元素事件， <code>$event</code> 就是 <code>DOM 事件对象</code>，它有像 <code>target</code> 和 <code>target.value</code> 这样的属性。<code>$event.stopPropagation()</code> 可以阻止删除按钮的事件继续传播，防止触发选中操作。</p> 
    <div class="highlight highlight-text-html-basic">
     <pre>&lt;<span class="pl-ent">button</span> <span class="pl-e">class</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>btn btn-danger<span class="pl-pds">&quot;</span></span> (<span class="pl-e">click</span>)=<span class="pl-s"><span class="pl-pds">&quot;</span>delete(application);$event.stopPropagation();<span class="pl-pds">&quot;</span></span>&gt;删除&lt;/<span class="pl-ent">button</span>&gt;</pre>
    </div> </li> 
   <li> <p><strong>父子组件数据传递</strong></p> <p>当选中数据时，使用 <code>ApplicationDetailComponent</code> 组件用来显示应用详情，以便编辑。<code>[categories]=&quot;categories&quot;</code> 和 <code>[selectedApplication]=&quot;selectedApplication&quot;</code> 表示将父组件的两个属性值传入向子组件（<code>ApplicationDetailComponent</code>）。</p> <p><strong>注意</strong>：要实现父子组件的数据传递，还需要在子组件中额外使用 <code>inputs</code> 定义输入的属性名称列表。</p> 
    <div class="highlight highlight-text-html-basic">
     <pre>&lt;<span class="pl-ent">application</span><span class="pl-e">-detail</span> [<span class="pl-e">categories</span>]=<span class="pl-s"><span class="pl-pds">&quot;</span>categories<span class="pl-pds">&quot;</span></span> [<span class="pl-e">selectedApplication</span>]=<span class="pl-s"><span class="pl-pds">&quot;</span>selectedApplication<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">application</span><span class="pl-e">-detail</span>&gt;</pre>
    </div> </li> 
  </ul> </li> 
 <li> <p>实现 ApplicationsComponent 事件处理函数</p> <p><strong>applications.component.js</strong>:</p> 
  <div class="highlight highlight-source-js">
   <pre>(<span class="pl-k">function</span>(<span class="pl-smi">app</span>) {

    <span class="pl-c"><span class="pl-c">//</span> 模拟数据</span>
    <span class="pl-k">const</span> <span class="pl-c1">CATEGORYS</span><span class="pl-k">=</span>[
        <span class="pl-k">new</span> <span class="pl-en">app.Category</span>(<span class="pl-c1">1</span>, <span class="pl-s"><span class="pl-pds">'</span>应用<span class="pl-pds">'</span></span>),
        <span class="pl-k">new</span> <span class="pl-en">app.Category</span>(<span class="pl-c1">2</span>, <span class="pl-s"><span class="pl-pds">'</span>游戏<span class="pl-pds">'</span></span>),
        <span class="pl-k">new</span> <span class="pl-en">app.Category</span>(<span class="pl-c1">3</span>, <span class="pl-s"><span class="pl-pds">'</span>音乐<span class="pl-pds">'</span></span>),
        <span class="pl-k">new</span> <span class="pl-en">app.Category</span>(<span class="pl-c1">4</span>, <span class="pl-s"><span class="pl-pds">'</span>图书<span class="pl-pds">'</span></span>)
    ];
    <span class="pl-k">const</span> <span class="pl-c1">APPLICATIONS</span><span class="pl-k">=</span>[
        <span class="pl-k">new</span> <span class="pl-en">app.Application</span>(<span class="pl-c1">1001</span>, <span class="pl-s"><span class="pl-pds">'</span>Angular App<span class="pl-pds">'</span></span>, <span class="pl-c1">300</span>, <span class="pl-c1">CATEGORYS</span>[<span class="pl-c1">0</span>].<span class="pl-c1">name</span>),
        <span class="pl-k">new</span> <span class="pl-en">app.Application</span>(<span class="pl-c1">1002</span>, <span class="pl-s"><span class="pl-pds">'</span>Big Game<span class="pl-pds">'</span></span>, <span class="pl-c1">120</span>, <span class="pl-c1">CATEGORYS</span>[<span class="pl-c1">1</span>].<span class="pl-c1">name</span>),
        <span class="pl-k">new</span> <span class="pl-en">app.Application</span>(<span class="pl-c1">1003</span>, <span class="pl-s"><span class="pl-pds">'</span>Fantasy<span class="pl-pds">'</span></span>, <span class="pl-c1">240</span>, <span class="pl-c1">CATEGORYS</span>[<span class="pl-c1">2</span>].<span class="pl-c1">name</span>),
        <span class="pl-k">new</span> <span class="pl-en">app.Application</span>(<span class="pl-c1">1004</span>, <span class="pl-s"><span class="pl-pds">'</span>Think in Java<span class="pl-pds">'</span></span>, <span class="pl-c1">480</span>, <span class="pl-c1">CATEGORYS</span>[<span class="pl-c1">3</span>].<span class="pl-c1">name</span>),
        <span class="pl-k">new</span> <span class="pl-en">app.Application</span>(<span class="pl-c1">1005</span>, <span class="pl-s"><span class="pl-pds">'</span>Bang Game<span class="pl-pds">'</span></span>, <span class="pl-c1">310</span>, <span class="pl-c1">CATEGORYS</span>[<span class="pl-c1">1</span>].<span class="pl-c1">name</span>),
        <span class="pl-k">new</span> <span class="pl-en">app.Application</span>(<span class="pl-c1">1006</span>, <span class="pl-s"><span class="pl-pds">'</span>The Mythical Man-Month<span class="pl-pds">'</span></span>, <span class="pl-c1">680</span>, <span class="pl-c1">CATEGORYS</span>[<span class="pl-c1">3</span>].<span class="pl-c1">name</span>),
        <span class="pl-k">new</span> <span class="pl-en">app.Application</span>(<span class="pl-c1">1007</span>, <span class="pl-s"><span class="pl-pds">'</span>BootStrap App<span class="pl-pds">'</span></span>, <span class="pl-c1">290</span>, <span class="pl-c1">CATEGORYS</span>[<span class="pl-c1">0</span>].<span class="pl-c1">name</span>)
    ];

    <span class="pl-smi">app</span>.<span class="pl-smi">ApplicationsComponent</span> <span class="pl-k">=</span> <span class="pl-smi">ng</span>.<span class="pl-smi">core</span>
        .<span class="pl-en">Component</span>({
            selector<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>application-list<span class="pl-pds">'</span></span>,
            templateUrl<span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">'</span>app/application/applications.component.html<span class="pl-pds">'</span></span>
        })
        .<span class="pl-en">Class</span>({
            <span class="pl-en">constructor</span><span class="pl-k">:</span> <span class="pl-k">function</span>() {
                <span class="pl-c"><span class="pl-c">//</span> 分类和应用数据列表</span>
                <span class="pl-c1">this</span>.<span class="pl-smi">categories</span> <span class="pl-k">=</span> <span class="pl-c1">CATEGORYS</span>;
                <span class="pl-c1">this</span>.<span class="pl-smi">applications</span> <span class="pl-k">=</span> <span class="pl-c1">APPLICATIONS</span>;
            },
            <span class="pl-c"><span class="pl-c">//</span> 处理选中处理</span>
            <span class="pl-en">onSelect</span><span class="pl-k">:</span><span class="pl-k">function</span>(<span class="pl-smi">application</span>){
                <span class="pl-c1">this</span>.<span class="pl-smi">selectedApplication</span><span class="pl-k">=</span>application;
            },
            <span class="pl-c"><span class="pl-c">//</span> 添加</span>
            <span class="pl-en">create</span><span class="pl-k">:</span> <span class="pl-k">function</span>(<span class="pl-smi">addForm</span>) {
                <span class="pl-c"><span class="pl-c">//</span> 获得数据并验证</span>
                <span class="pl-k">var</span> id <span class="pl-k">=</span> <span class="pl-smi">addForm</span>.<span class="pl-c1">id</span>.<span class="pl-c1">value</span>;
                <span class="pl-k">var</span> name <span class="pl-k">=</span> <span class="pl-smi">addForm</span>.<span class="pl-c1">name</span>.<span class="pl-c1">value</span>;
                <span class="pl-k">var</span> downloads <span class="pl-k">=</span> <span class="pl-smi">addForm</span>.<span class="pl-smi">downloads</span>.<span class="pl-c1">value</span>;
                <span class="pl-k">var</span> category <span class="pl-k">=</span> <span class="pl-smi">addForm</span>.<span class="pl-smi">category</span>.<span class="pl-c1">value</span>;
                <span class="pl-k">if</span>(<span class="pl-k">!</span><span class="pl-smi">id</span>.<span class="pl-en">trim</span>() <span class="pl-k">||</span> <span class="pl-k">!</span><span class="pl-smi">name</span>.<span class="pl-en">trim</span>() <span class="pl-k">||</span> <span class="pl-k">!</span><span class="pl-smi">downloads</span>.<span class="pl-en">trim</span>()) {
                    <span class="pl-k">return</span>;
                }
                <span class="pl-c1">this</span>.<span class="pl-smi">applications</span>.<span class="pl-c1">push</span>(<span class="pl-k">new</span> <span class="pl-en">app.Application</span>(id, name, downloads, category));
                <span class="pl-smi">addForm</span>.<span class="pl-c1">reset</span>(); <span class="pl-c"><span class="pl-c">//</span> 重置添加表单</span>
                <span class="pl-c1">this</span>.<span class="pl-smi">selectedApplication</span> <span class="pl-k">=</span> <span class="pl-c1">null</span>;
            },
            <span class="pl-c"><span class="pl-c">//</span> 删除</span>
            <span class="pl-en">delete</span><span class="pl-k">:</span> <span class="pl-k">function</span>(<span class="pl-smi">application</span>) {
                <span class="pl-c1">this</span>.<span class="pl-smi">applications</span> <span class="pl-k">=</span> <span class="pl-c1">this</span>.<span class="pl-smi">applications</span>.<span class="pl-en">filter</span>(<span class="pl-k">function</span>(<span class="pl-smi">o</span>) {
                        <span class="pl-k">return</span> o <span class="pl-k">!==</span> application;
                });
                <span class="pl-k">if</span>(<span class="pl-c1">this</span>.<span class="pl-smi">selectedApplication</span> <span class="pl-k">===</span> application) {
                    <span class="pl-c1">this</span>.<span class="pl-smi">selectedApplication</span> <span class="pl-k">=</span> <span class="pl-c1">null</span>;
                }
            }
        });
})(<span class="pl-c1">window</span>.<span class="pl-smi">app</span> <span class="pl-k">||</span> (<span class="pl-c1">window</span>.<span class="pl-smi">app</span> <span class="pl-k">=</span> {}));</pre>
  </div> </li> 
 <li> <p>编写 <code>application-detail.component.html</code> 详情模板编辑应用信息</p> 
  <ul> 
   <li><p>ApplicationDetailComponent 子组件的 <code>selectedApplication</code> 和 <code>categories</code> 属性值从 ApplicationsComponent 父组件输入。</p></li> 
   <li><p><code>*ngIf=&quot;selectedApplication&quot;</code> 指令，存在选中数据则才显示详情表单。</p></li> 
   <li><p>使用 <code>[(ngModel)]</code> 实现选中数据的双向绑定。使用 ngModel 做双向数据绑定前，得先导入 <code>ng.forms.FormsModule</code>， 加入 Angular 模块的 <code>imports</code> 列表</p></li> 
   <li><p><code>{{selectedApplication.name | uppercase}}</code> : UpperCasePipe 管道将名称转换为大写。 </p></li> 
  </ul> <p><strong>application-detail.component.html</strong>: </p> 
  <div class="highlight highlight-text-html-basic">
   <pre>&lt;<span class="pl-ent">div</span> <span class="pl-e">class</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>container<span class="pl-pds">&quot;</span></span> [<span class="pl-e">hidden</span>]=<span class="pl-s"><span class="pl-pds">&quot;</span>submitted<span class="pl-pds">&quot;</span></span> *<span class="pl-e">ngIf</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>selectedApplication<span class="pl-pds">&quot;</span></span>&gt;
    &lt;<span class="pl-ent">h2</span>&gt;{{selectedApplication.name | uppercase}} 详情!&lt;/<span class="pl-ent">h2</span>&gt;
    &lt;<span class="pl-ent">form</span>&gt;
      &lt;<span class="pl-ent">div</span> <span class="pl-e">class</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>form-group<span class="pl-pds">&quot;</span></span>&gt;
        &lt;<span class="pl-ent">label</span> <span class="pl-e">for</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>name<span class="pl-pds">&quot;</span></span>&gt;应用名&lt;/<span class="pl-ent">label</span>&gt;
        &lt;<span class="pl-ent">input</span> <span class="pl-e">type</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>text<span class="pl-pds">&quot;</span></span> <span class="pl-e">class</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>form-control<span class="pl-pds">&quot;</span></span> <span class="pl-e">id</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>name<span class="pl-pds">&quot;</span></span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>name<span class="pl-pds">&quot;</span></span> <span class="pl-e">required</span> [(<span class="pl-e">ngModel</span>)]=<span class="pl-s"><span class="pl-pds">&quot;</span>selectedApplication.name<span class="pl-pds">&quot;</span></span>&gt;
      &lt;/<span class="pl-ent">div</span>&gt;
      &lt;<span class="pl-ent">div</span> <span class="pl-e">class</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>form-group<span class="pl-pds">&quot;</span></span>&gt;
        &lt;<span class="pl-ent">label</span> <span class="pl-e">for</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>downloads<span class="pl-pds">&quot;</span></span>&gt;下载量&lt;/<span class="pl-ent">label</span>&gt;
        &lt;<span class="pl-ent">input</span> <span class="pl-e">type</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>text<span class="pl-pds">&quot;</span></span> <span class="pl-e">class</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>form-control<span class="pl-pds">&quot;</span></span> <span class="pl-e">id</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>downloads<span class="pl-pds">&quot;</span></span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>downloads<span class="pl-pds">&quot;</span></span> <span class="pl-e">required</span> [(<span class="pl-e">ngModel</span>)]=<span class="pl-s"><span class="pl-pds">&quot;</span>selectedApplication.downloads<span class="pl-pds">&quot;</span></span>&gt;
      &lt;/<span class="pl-ent">div</span>&gt;
      &lt;<span class="pl-ent">div</span> <span class="pl-e">class</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>form-group<span class="pl-pds">&quot;</span></span>&gt;
        &lt;<span class="pl-ent">label</span> <span class="pl-e">for</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>category<span class="pl-pds">&quot;</span></span>&gt;分类&lt;/<span class="pl-ent">label</span>&gt;
        &lt;<span class="pl-ent">select</span> <span class="pl-e">class</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>form-control<span class="pl-pds">&quot;</span></span> <span class="pl-e">id</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>category<span class="pl-pds">&quot;</span></span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>category<span class="pl-pds">&quot;</span></span> <span class="pl-e">required</span> [(<span class="pl-e">ngModel</span>)]=<span class="pl-s"><span class="pl-pds">&quot;</span>selectedApplication.category<span class="pl-pds">&quot;</span></span>&gt;
            &lt;<span class="pl-ent">option</span> *<span class="pl-e">ngFor</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>let category of categories<span class="pl-pds">&quot;</span></span> [<span class="pl-e">value</span>]=<span class="pl-s"><span class="pl-pds">&quot;</span>category.name<span class="pl-pds">&quot;</span></span>&gt;{{category.name}}&lt;/<span class="pl-ent">option</span>&gt;
          &lt;/<span class="pl-ent">select</span>&gt;
      &lt;/<span class="pl-ent">div</span>&gt;
    &lt;/<span class="pl-ent">form</span>&gt;
&lt;/<span class="pl-ent">div</span>&gt;</pre>
  </div> </li> 
 <li> <p>在子组件 ApplicationDetailComponent 中定义 <code>inputs</code> 接收父组件的输入</p> 
  <div class="highlight highlight-source-js">
   <pre>(<span class="pl-k">function</span>(<span class="pl-smi">app</span>) {
    <span class="pl-smi">app</span>.<span class="pl-smi">ApplicationDetailComponent</span> <span class="pl-k">=</span> <span class="pl-smi">ng</span>.<span class="pl-smi">core</span>
        .<span class="pl-en">Component</span>({
            selector<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>application-detail<span class="pl-pds">'</span></span>,
            templateUrl<span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">'</span>app/application/application-detail/application-detail.component.html<span class="pl-pds">'</span></span>,
            <span class="pl-c"><span class="pl-c">//</span> 接收父组件输入的属性</span>
            inputs<span class="pl-k">:</span>[<span class="pl-s"><span class="pl-pds">'</span>categories<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>selectedApplication<span class="pl-pds">'</span></span>]
        })
        .<span class="pl-en">Class</span>({
            <span class="pl-en">constructor</span><span class="pl-k">:</span> <span class="pl-k">function</span>() {
            }
        });
})(<span class="pl-c1">window</span>.<span class="pl-smi">app</span> <span class="pl-k">||</span> (<span class="pl-c1">window</span>.<span class="pl-smi">app</span> <span class="pl-k">=</span> {}));</pre>
  </div> </li> 
 <li> <p>trackBy 追踪函数优化</p> <p>当更改了部分属性的数据然后刷新时， NgFor 指令会重新新建整个 DOM 列表，导致性能问题。</p> <p><strong>trackBy 追踪函数</strong>，可以在刷新时，让 NgFor 跟踪当前每一条数据是否改变，未改变的数据 DOM 不用改变。</p> <p><strong>applications.component.html</strong>:</p> 
  <div class="highlight highlight-text-html-basic">
   <pre>&lt;<span class="pl-ent">tr</span> *<span class="pl-e">ngFor</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>let application of applications; trackBy:trackByApplications<span class="pl-pds">&quot;</span></span> [<span class="pl-e">class</span>.<span class="pl-e">active</span>]=<span class="pl-s"><span class="pl-pds">&quot;</span>application === selectedApplication<span class="pl-pds">&quot;</span></span> (<span class="pl-e">click</span>)=<span class="pl-s"><span class="pl-pds">&quot;</span>onSelect(application)<span class="pl-pds">&quot;</span></span>&gt;
</pre>
  </div> <p><strong>applications.component.js</strong>:</p> 
  <div class="highlight highlight-source-js">
   <pre><span class="pl-c"><span class="pl-c">//</span> 通过 id 跟踪，判断数据条目是否存在，是否需要更新</span>
<span class="pl-en">trackByApplications</span><span class="pl-k">:</span> <span class="pl-k">function</span>(<span class="pl-smi">index</span>, <span class="pl-smi">application</span>){
    <span class="pl-k">return</span> <span class="pl-smi">application</span>.<span class="pl-c1">id</span>;
}</pre>
  </div> </li> 
</ol> 
<h2> <a id="5-服务开发" class="anchor" href="#5-%E6%9C%8D%E5%8A%A1%E5%BC%80%E5%8F%91" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>5. 服务开发</h2> 
<p>实现代码：<code>step5-service</code></p> 
<p>重构数据访问代码，把它隔离到一个独立的<strong>Service 服务</strong>中去，让组件尽可能保持精简，专注于为视图提供支持。 在这种方式下，借助模拟服务来对组件进行单元测试也会更容易，我们可以从网络服务器，浏览器的局部存储区，模拟的数据源等获取数据。</p> 
<p>独立的服务有利于<strong>依赖注入（DI）</strong>，创建一个单一的、可复用的数据服务，然后把它注入到那些需要它的组件中去。</p> 
<h3> <a id="创建-mock-数据源文件和-service-文件" class="anchor" href="#%E5%88%9B%E5%BB%BA-mock-%E6%95%B0%E6%8D%AE%E6%BA%90%E6%96%87%E4%BB%B6%E5%92%8C-service-%E6%96%87%E4%BB%B6" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>创建 mock 数据源文件和 Service 文件</h3> 
<p>添加模拟数据源文件 <code>mock/mock-applications.js</code></p> 
<p>添加服务文件 <code>application.service.js</code></p> 
<p><a href="doc/images/step5.png" target="_blank"><img src="doc/images/step5.png" alt="Example" style="max-width:100%;" /></a></p> 
<h3> <a id="实现步骤-3" class="anchor" href="#%E5%AE%9E%E7%8E%B0%E6%AD%A5%E9%AA%A4-3" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>实现步骤</h3> 
<ol> 
 <li> <p>创建 Mock 数据源</p> <p><strong>mock/mock-applications.js</strong>:</p> 
  <div class="highlight highlight-source-js">
   <pre>(<span class="pl-k">function</span>(<span class="pl-smi">app</span>) {
    <span class="pl-c"><span class="pl-c">//</span> 模拟数据</span>
    <span class="pl-k">const</span> <span class="pl-c1">CATEGORYS</span><span class="pl-k">=</span>[
        <span class="pl-k">new</span> <span class="pl-en">app.Category</span>(<span class="pl-c1">1</span>, <span class="pl-s"><span class="pl-pds">'</span>应用<span class="pl-pds">'</span></span>),
        <span class="pl-k">new</span> <span class="pl-en">app.Category</span>(<span class="pl-c1">2</span>, <span class="pl-s"><span class="pl-pds">'</span>游戏<span class="pl-pds">'</span></span>),
        <span class="pl-k">new</span> <span class="pl-en">app.Category</span>(<span class="pl-c1">3</span>, <span class="pl-s"><span class="pl-pds">'</span>音乐<span class="pl-pds">'</span></span>),
        <span class="pl-k">new</span> <span class="pl-en">app.Category</span>(<span class="pl-c1">4</span>, <span class="pl-s"><span class="pl-pds">'</span>图书<span class="pl-pds">'</span></span>)
    ];
    <span class="pl-k">const</span> <span class="pl-c1">APPLICATIONS</span><span class="pl-k">=</span>[
        <span class="pl-k">new</span> <span class="pl-en">app.Application</span>(<span class="pl-c1">1001</span>, <span class="pl-s"><span class="pl-pds">'</span>Angular App<span class="pl-pds">'</span></span>, <span class="pl-c1">300</span>, <span class="pl-c1">CATEGORYS</span>[<span class="pl-c1">0</span>].<span class="pl-c1">name</span>),
        <span class="pl-k">new</span> <span class="pl-en">app.Application</span>(<span class="pl-c1">1002</span>, <span class="pl-s"><span class="pl-pds">'</span>Big Game<span class="pl-pds">'</span></span>, <span class="pl-c1">120</span>, <span class="pl-c1">CATEGORYS</span>[<span class="pl-c1">1</span>].<span class="pl-c1">name</span>),
        <span class="pl-k">new</span> <span class="pl-en">app.Application</span>(<span class="pl-c1">1003</span>, <span class="pl-s"><span class="pl-pds">'</span>Fantasy<span class="pl-pds">'</span></span>, <span class="pl-c1">240</span>, <span class="pl-c1">CATEGORYS</span>[<span class="pl-c1">2</span>].<span class="pl-c1">name</span>),
        <span class="pl-k">new</span> <span class="pl-en">app.Application</span>(<span class="pl-c1">1004</span>, <span class="pl-s"><span class="pl-pds">'</span>Think in Java<span class="pl-pds">'</span></span>, <span class="pl-c1">480</span>, <span class="pl-c1">CATEGORYS</span>[<span class="pl-c1">3</span>].<span class="pl-c1">name</span>),
        <span class="pl-k">new</span> <span class="pl-en">app.Application</span>(<span class="pl-c1">1005</span>, <span class="pl-s"><span class="pl-pds">'</span>Bang Game<span class="pl-pds">'</span></span>, <span class="pl-c1">310</span>, <span class="pl-c1">CATEGORYS</span>[<span class="pl-c1">1</span>].<span class="pl-c1">name</span>),
        <span class="pl-k">new</span> <span class="pl-en">app.Application</span>(<span class="pl-c1">1006</span>, <span class="pl-s"><span class="pl-pds">'</span>The Mythical Man-Month<span class="pl-pds">'</span></span>, <span class="pl-c1">680</span>, <span class="pl-c1">CATEGORYS</span>[<span class="pl-c1">3</span>].<span class="pl-c1">name</span>),
        <span class="pl-k">new</span> <span class="pl-en">app.Application</span>(<span class="pl-c1">1007</span>, <span class="pl-s"><span class="pl-pds">'</span>BootStrap App<span class="pl-pds">'</span></span>, <span class="pl-c1">290</span>, <span class="pl-c1">CATEGORYS</span>[<span class="pl-c1">0</span>].<span class="pl-c1">name</span>)
    ];
    <span class="pl-smi">app</span>.<span class="pl-smi">categories</span><span class="pl-k">=</span><span class="pl-c1">CATEGORYS</span>;
    <span class="pl-smi">app</span>.<span class="pl-smi">applications</span><span class="pl-k">=</span><span class="pl-c1">APPLICATIONS</span>;
})(<span class="pl-c1">window</span>.<span class="pl-smi">app</span> <span class="pl-k">||</span> (<span class="pl-c1">window</span>.<span class="pl-smi">app</span> <span class="pl-k">=</span> {}));</pre>
  </div> </li> 
 <li> <p>编写 ApplicationService 服务类，使用模拟数据定义提供数据的函数 </p> <p><strong>Service 服务定义语法</strong>：</p> 
  <div class="highlight highlight-source-js">
   <pre><span class="pl-smi">ng</span>.<span class="pl-smi">core</span>.<span class="pl-en">Class</span>({
    <span class="pl-en">constructor</span><span class="pl-k">:</span><span class="pl-k">function</span>(){
    }
    <span class="pl-k">...</span>
});</pre>
  </div> <p><strong>application.service.js</strong>:</p> 
  <div class="highlight highlight-source-js">
   <pre>(<span class="pl-k">function</span>(<span class="pl-smi">app</span>) {
    <span class="pl-smi">app</span>.<span class="pl-smi">ApplicationService</span> <span class="pl-k">=</span> <span class="pl-smi">ng</span>.<span class="pl-smi">core</span>.<span class="pl-en">Class</span>({
        <span class="pl-en">constructor</span><span class="pl-k">:</span> <span class="pl-k">function</span>() {},
        <span class="pl-en">getCategories</span><span class="pl-k">:</span> <span class="pl-k">function</span>() {
            <span class="pl-k">return</span> <span class="pl-smi">app</span>.<span class="pl-smi">categories</span>;
        },
        <span class="pl-en">getApplications</span><span class="pl-k">:</span> <span class="pl-k">function</span>(){
            <span class="pl-k">return</span> <span class="pl-smi">app</span>.<span class="pl-smi">applications</span>;
        }
    });
})(<span class="pl-c1">window</span>.<span class="pl-smi">app</span> <span class="pl-k">||</span> (<span class="pl-c1">window</span>.<span class="pl-smi">app</span> <span class="pl-k">=</span> {}));</pre>
  </div> </li> 
 <li> <p>在 index.html 引入 mock 数据源和 Service 服务文件</p> 
  <div class="highlight highlight-text-html-basic">
   <pre>&lt;<span class="pl-ent">script</span> <span class="pl-e">src</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>app/mock/mock-applications.js<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">script</span>&gt;
&lt;<span class="pl-ent">script</span> <span class="pl-e">src</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>app/application/application.service.js<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">script</span>&gt;</pre>
  </div> </li> 
 <li> <p>在 AppModule 注册 ApplicationService 提供商，准备依赖注入</p> 
  <ul> 
   <li><p>添加可注入的 <code>app.ApplicationService</code> 类到 <code>AppModule</code> 的 <code>providers</code> 数组中。</p></li> 
   <li><p>在 <code>ngModule</code> 而非 <code>ngComponent</code> 定义可以避免多个组件使用服务时重复创建。</p></li> 
  </ul> <p><strong>app.module.js</strong>:</p> <pre><code>(function(app) {
  app.AppModule =
    // 模块定义
    ng.core.NgModule({
      // 导入的模块
      imports: [ 
          ng.platformBrowser.BrowserModule,
          ng.forms.FormsModule, 
          app.ApplicationsModule
      ],
      declarations: [ app.AppComponent, app.DashboardComponent ], 
      bootstrap: [ app.AppComponent],
      // 服务提供商
      providers: [app.ApplicationService] 
    })
    .Class({
      constructor: function() {
      }
    });
})(window.app || (window.app = {}));
</code></pre> </li> 
 <li> <p>在 ApplicationsComponent 通过依赖注入使用 ApplicationService</p> <p><strong>依赖注入的优点</strong>：</p> 
  <ul> 
   <li><p>无需自行 new 创建对象，防止构造函数修改带来的问题</p></li> 
   <li><p>对象可共享，有利缓存</p></li> 
   <li><p>便于更换各种不同实现，方便测试等</p></li> 
  </ul> <p><strong>依赖注入的实现</strong>：</p> 
  <ul> 
   <li><p>可以通过服务和组件的构造函数进行依赖注入</p></li> 
   <li><p>不要在构造函数中获取数据，构造函数仅完成参数赋值给属性</p></li> 
   <li><p>通过 <code>ngOnInit</code> 生命周期钩子调用 Service 获得数据的方法</p></li> 
  </ul> <p><strong>applications.component.js</strong>：</p> 
  <div class="highlight highlight-source-js">
   <pre><span class="pl-k">...</span>
<span class="pl-c"><span class="pl-c">//</span> 使用 ngOnInit 生命周期钩子，避免在构造函数中获取数据</span>
<span class="pl-en">ngOnInit</span><span class="pl-k">:</span> <span class="pl-k">function</span>(){
    <span class="pl-c1">this</span>.<span class="pl-smi">categories</span> <span class="pl-k">=</span> <span class="pl-c1">this</span>.<span class="pl-smi">service</span>.<span class="pl-en">getCategories</span>();
    <span class="pl-c1">this</span>.<span class="pl-smi">applications</span> <span class="pl-k">=</span> <span class="pl-c1">this</span>.<span class="pl-smi">service</span>.<span class="pl-en">getApplications</span>();
},
<span class="pl-c"><span class="pl-c">//</span> 依赖注入服务对象， 构造函数仅完成参数赋值给属性</span>
<span class="pl-en">constructor</span>: [app.ApplicationService, <span class="pl-k">function</span>(<span class="pl-smi">service</span>) {
    <span class="pl-c"><span class="pl-c">//</span> 保存服务对象</span>
    <span class="pl-c1">this</span>.<span class="pl-smi">service</span> <span class="pl-k">=</span> service;
}],
<span class="pl-k">...</span></pre>
  </div> </li> 
</ol> 
<h2> <a id="6-异步服务与承诺-promise" class="anchor" href="#6-%E5%BC%82%E6%AD%A5%E6%9C%8D%E5%8A%A1%E4%B8%8E%E6%89%BF%E8%AF%BA-promise" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>6. 异步服务与承诺 Promise</h2> 
<p>实现代码：<code>step6-promise service</code></p> 
<p>因为数据服务通常都是异步的，创建一个基于<strong>承诺 (Promise)</strong>的数据服务，可以在不改变方法签名的情况下使用异步技术。</p> 
<p><em>Promise 是异步编程的一种解决方案，是 ES6 语言标准。</em></p> 
<h3> <a id="实现步骤-4" class="anchor" href="#%E5%AE%9E%E7%8E%B0%E6%AD%A5%E9%AA%A4-4" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>实现步骤</h3> 
<ol> 
 <li> <p>修改 ApplicationService，把服务设计为返回承诺 Promise</p> <p><strong>application.service.js</strong>：</p> 
  <div class="highlight highlight-source-js">
   <pre>(<span class="pl-k">function</span>(<span class="pl-smi">app</span>) {
    <span class="pl-smi">app</span>.<span class="pl-smi">ApplicationService</span> <span class="pl-k">=</span> <span class="pl-smi">ng</span>.<span class="pl-smi">core</span>.<span class="pl-en">Class</span>({
        <span class="pl-en">constructor</span><span class="pl-k">:</span> <span class="pl-k">function</span>() {},
        <span class="pl-en">getCategories</span><span class="pl-k">:</span> <span class="pl-k">function</span>() {
            <span class="pl-c"><span class="pl-c">//</span> 基于 Promise 承诺的服务</span>
            <span class="pl-k">return</span> <span class="pl-c1">Promise</span>.<span class="pl-en">resolve</span>(<span class="pl-smi">app</span>.<span class="pl-smi">categories</span>);
        },
        <span class="pl-en">getApplications</span><span class="pl-k">:</span> <span class="pl-k">function</span>(){
            <span class="pl-c"><span class="pl-c">//</span> 基于 Promise 承诺的服务</span>
            <span class="pl-k">return</span> <span class="pl-c1">Promise</span>.<span class="pl-en">resolve</span>(<span class="pl-smi">app</span>.<span class="pl-smi">applications</span>);
        }
    });
})(<span class="pl-c1">window</span>.<span class="pl-smi">app</span> <span class="pl-k">||</span> (<span class="pl-c1">window</span>.<span class="pl-smi">app</span> <span class="pl-k">=</span> {}));</pre>
  </div> </li> 
 <li> <p>ApplicationsComponent 组件使用基于承诺的方式获取数据</p> <p><strong>applications.component.js</strong>:</p> 
  <div class="highlight highlight-source-js">
   <pre><span class="pl-c"><span class="pl-c">//</span> 使用 ngOnInit 生命周期钩子，避免在构造函数中获取数据</span>
<span class="pl-en">ngOnInit</span><span class="pl-k">:</span> <span class="pl-k">function</span>(){
    <span class="pl-c"><span class="pl-c">//</span>  this.categories = this.service.getCategories();</span>
    <span class="pl-c"><span class="pl-c">//</span>  this.applications = this.service.getApplications();</span>

    <span class="pl-c"><span class="pl-c">//</span> 基于承诺的行动（使用 ES2015 箭头函数）</span>
    <span class="pl-c1">this</span>.<span class="pl-smi">service</span>.<span class="pl-en">getCategories</span>().<span class="pl-en">then</span>(<span class="pl-smi">categories</span><span class="pl-k">=&gt;</span>{<span class="pl-c1">this</span>.<span class="pl-smi">categories</span> <span class="pl-k">=</span> categories});
    <span class="pl-c1">this</span>.<span class="pl-smi">service</span>.<span class="pl-en">getApplications</span>().<span class="pl-en">then</span>(<span class="pl-smi">applications</span><span class="pl-k">=&gt;</span>{<span class="pl-c1">this</span>.<span class="pl-smi">applications</span> <span class="pl-k">=</span> applications});
},
</pre>
  </div> </li> 
 <li> <p>可选：模拟异步请求的延迟加载应用列表数据，进行测试</p> <p><strong>application.service.js</strong>：</p> 
  <div class="highlight highlight-source-js">
   <pre>(<span class="pl-k">function</span>(<span class="pl-smi">app</span>) {
    <span class="pl-smi">app</span>.<span class="pl-smi">ApplicationService</span> <span class="pl-k">=</span> <span class="pl-smi">ng</span>.<span class="pl-smi">core</span>.<span class="pl-en">Class</span>({
        <span class="pl-en">constructor</span><span class="pl-k">:</span> <span class="pl-k">function</span>() {},
        <span class="pl-en">getCategories</span><span class="pl-k">:</span> <span class="pl-k">function</span>() {
            <span class="pl-c"><span class="pl-c">//</span> 基于 Promise 承诺的服务</span>
            <span class="pl-k">return</span> <span class="pl-c1">Promise</span>.<span class="pl-en">resolve</span>(<span class="pl-smi">app</span>.<span class="pl-smi">categories</span>);
        },
        <span class="pl-en">getApplications</span><span class="pl-k">:</span> <span class="pl-k">function</span>(){
            <span class="pl-c"><span class="pl-c">//</span> 基于 Promise 承诺的服务</span>
            <span class="pl-c"><span class="pl-c">//</span> return Promise.resolve(app.applications);</span>

            <span class="pl-c"><span class="pl-c">//</span> 模拟异步延迟的 Promise</span>
            <span class="pl-k">return</span> <span class="pl-k">new</span> <span class="pl-en">Promise</span>(<span class="pl-smi">resolve</span> <span class="pl-k">=&gt;</span>
                <span class="pl-c1">setTimeout</span>(resolve, <span class="pl-c1">2000</span>)) <span class="pl-c"><span class="pl-c">//</span> delay 2 seconds</span>
                .<span class="pl-en">then</span>(() <span class="pl-k">=&gt;</span> <span class="pl-smi">app</span>.<span class="pl-smi">applications</span>);
        }
    });
})(<span class="pl-c1">window</span>.<span class="pl-smi">app</span> <span class="pl-k">||</span> (<span class="pl-c1">window</span>.<span class="pl-smi">app</span> <span class="pl-k">=</span> {}));</pre>
  </div> </li> 
</ol> 
<h2> <a id="7-使用路由构建视图导航" class="anchor" href="#7-%E4%BD%BF%E7%94%A8%E8%B7%AF%E7%94%B1%E6%9E%84%E5%BB%BA%E8%A7%86%E5%9B%BE%E5%AF%BC%E8%88%AA" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>7. 使用路由构建视图导航</h2> 
<p>实现代码：<code>step7-router</code></p> 
<p><a href="doc/images/step7-demo.png" target="_blank"><img src="doc/images/step7-demo.png" alt="Example" style="max-width:100%;" /></a></p> 
<p><a href="doc/images/step7-demo2.png" target="_blank"><img src="doc/images/step7-demo2.png" alt="Example" style="max-width:100%;" /></a></p> 
<p><strong>路由</strong>是导航的另一个名字。路由器就是从一个视图导航到另一个视图的机制。</p> 
<p>路由告诉路由器，当用户点击链接或者把 URL 粘贴到浏览器地址栏时，应该显示哪个视图。</p> 
<p>路由器包含了多种服务(<code>RouterModule</code>)、多种指令(<code>RouterOutlet</code>、<code>RouterLink</code>、<code>RouterLinkActive</code>)、 和一套配置(<code>Routes</code>)</p> 
<h3> <a id="添加路由模块文件和-dashboard-组件" class="anchor" href="#%E6%B7%BB%E5%8A%A0%E8%B7%AF%E7%94%B1%E6%A8%A1%E5%9D%97%E6%96%87%E4%BB%B6%E5%92%8C-dashboard-%E7%BB%84%E4%BB%B6" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>添加路由模块文件和 Dashboard 组件</h3> 
<p><a href="doc/images/step7.png" target="_blank"><img src="doc/images/step7.png" alt="Example" style="max-width:100%;" /></a></p> 
<h3> <a id="实现步骤-5" class="anchor" href="#%E5%AE%9E%E7%8E%B0%E6%AD%A5%E9%AA%A4-5" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>实现步骤</h3> 
<ol> 
 <li> <p>创建应用路由模块 AppRouterModule，编写路由配置(<code>app-routing.module.js</code>)</p> 
  <ul> 
   <li><p>Routes 是一个路由定义的数组。暂时只实现应用管理模块相关的导航。</p></li> 
   <li><p><code>RouterModule.forRoot()</code> 产生一个 <code>Angular ModuleWithProviders</code>，所以这个路由类应该是一种模块类。 它应该是一个路由模块，后面将要添加到 <code>imports</code>。</p></li> 
   <li><p>路由模块的名字应该包含 “Routing”。</p></li> 
   <li><p>路由地址可以使用参数 <code>:参数名</code></p></li> 
  </ul> <p><strong>app-routing.module.js</strong>：</p> 
  <div class="highlight highlight-source-js">
   <pre>(<span class="pl-k">function</span>(<span class="pl-smi">app</span>) {
    <span class="pl-c"><span class="pl-c">//</span> 配置路由</span>
    <span class="pl-k">var</span> routes <span class="pl-k">=</span> [
        { path<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span><span class="pl-pds">'</span></span>, redirectTo<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>/dashboard<span class="pl-pds">'</span></span>, pathMatch<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>full<span class="pl-pds">'</span></span> }, <span class="pl-c"><span class="pl-c">//</span> 重定向</span>
        { path<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>dashboard<span class="pl-pds">'</span></span>, component<span class="pl-k">:</span> <span class="pl-smi">app</span>.<span class="pl-smi">DashboardComponent</span> },
        { path<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>applications<span class="pl-pds">'</span></span>, component<span class="pl-k">:</span> <span class="pl-smi">app</span>.<span class="pl-smi">ApplicationsComponent</span> },
        { path<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>applications/:id<span class="pl-pds">'</span></span>, component<span class="pl-k">:</span> <span class="pl-smi">app</span>.<span class="pl-smi">ApplicationDetailComponent</span> }
    ];

    <span class="pl-smi">app</span>.<span class="pl-smi">AppRoutingModule</span> <span class="pl-k">=</span> <span class="pl-smi">ng</span>.<span class="pl-smi">router</span>.<span class="pl-smi">RouterModule</span>.<span class="pl-en">forRoot</span>(routes);

})(<span class="pl-c1">window</span>.<span class="pl-smi">app</span> <span class="pl-k">||</span> (<span class="pl-c1">window</span>.<span class="pl-smi">app</span> <span class="pl-k">=</span> {}));</pre>
  </div> </li> 
 <li> <p>创建一个新的 DashboardComponent 仪表盘组件(<code>dashboard.component.js</code>)</p> <p>把 AppComponent 变成应用程序的“壳”，它只处理导航。</p> <p><strong>dashboard.component.js</strong>：</p> 
  <div class="highlight highlight-source-js">
   <pre>(<span class="pl-k">function</span>(<span class="pl-smi">app</span>) {
    <span class="pl-smi">app</span>.<span class="pl-smi">DashboardComponent</span> <span class="pl-k">=</span> <span class="pl-smi">ng</span>.<span class="pl-smi">core</span>
        .<span class="pl-en">Component</span>({
            selector<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>appstore-dashboard<span class="pl-pds">'</span></span>, 
            templateUrl<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>app/dashboard.component.html<span class="pl-pds">'</span></span>
        })
        .<span class="pl-en">Class</span>({
            <span class="pl-c"><span class="pl-c">//</span> 初始化 dashboard 数据</span>
            <span class="pl-en">ngOnInit</span><span class="pl-k">:</span> <span class="pl-k">function</span>(){
                <span class="pl-c1">this</span>.<span class="pl-c1">title</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">&quot;</span>Applications Management<span class="pl-pds">&quot;</span></span>;
                <span class="pl-c1">this</span>.<span class="pl-smi">service</span>.<span class="pl-en">getApplications</span>().<span class="pl-en">then</span>(<span class="pl-smi">applications</span><span class="pl-k">=&gt;</span>{
                    <span class="pl-c"><span class="pl-c">//</span> 分类数量</span>
                    <span class="pl-c1">this</span>.<span class="pl-smi">applications</span><span class="pl-k">=</span>applications; 
                    <span class="pl-c1">this</span>.<span class="pl-smi">applicationCount</span> <span class="pl-k">=</span> <span class="pl-smi">applications</span>.<span class="pl-c1">length</span>;
                    <span class="pl-c"><span class="pl-c">//</span> 下载量 Top 3</span>
                    <span class="pl-c1">this</span>.<span class="pl-smi">sortApplications</span><span class="pl-k">=</span><span class="pl-smi">applications</span>.<span class="pl-c1">slice</span>(<span class="pl-c1">0</span>, <span class="pl-smi">applications</span>.<span class="pl-c1">length</span>); 
                    <span class="pl-c1">this</span>.<span class="pl-smi">sortApplications</span><span class="pl-k">=</span><span class="pl-c1">this</span>.<span class="pl-smi">sortApplications</span>.<span class="pl-c1">sort</span>(<span class="pl-k">function</span>(<span class="pl-smi">e1</span>,<span class="pl-smi">e2</span>){
                        <span class="pl-k">return</span> <span class="pl-smi">e2</span>.<span class="pl-smi">downloads</span><span class="pl-k">-</span><span class="pl-smi">e1</span>.<span class="pl-smi">downloads</span>;
                    }).<span class="pl-c1">slice</span>(<span class="pl-c1">0</span>,<span class="pl-c1">3</span>);
                });
                <span class="pl-c1">this</span>.<span class="pl-smi">service</span>.<span class="pl-en">getCategories</span>().<span class="pl-en">then</span>(<span class="pl-smi">categories</span><span class="pl-k">=&gt;</span>{<span class="pl-c1">this</span>.<span class="pl-smi">categories</span><span class="pl-k">=</span>categories; <span class="pl-c1">this</span>.<span class="pl-smi">categoryCount</span> <span class="pl-k">=</span> <span class="pl-smi">categories</span>.<span class="pl-c1">length</span>});
            },
            <span class="pl-en">constructor</span>: [app.ApplicationService, <span class="pl-k">function</span>(<span class="pl-smi">service</span>) {
                <span class="pl-c1">this</span>.<span class="pl-smi">service</span><span class="pl-k">=</span>service;
            }]
        });
})(<span class="pl-c1">window</span>.<span class="pl-smi">app</span> <span class="pl-k">||</span> (<span class="pl-c1">window</span>.<span class="pl-smi">app</span> <span class="pl-k">=</span> {}));</pre>
  </div> </li> 
 <li> <p>编写 DashboardComponent 的渲染模板文件(<code>dashboard.component.html</code>)</p> <p>显示分类数量和下载量 Top 3。</p> <p><strong>dashboard.component.html</strong>：</p> 
  <div class="highlight highlight-source-js">
   <pre><span class="pl-k">&lt;</span>div <span class="pl-k">class</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">&quot;</span>row<span class="pl-pds">&quot;</span></span> style<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">&quot;</span>margin: 20px;<span class="pl-pds">&quot;</span></span><span class="pl-k">&gt;</span>
    <span class="pl-k">&lt;</span>div <span class="pl-k">class</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">&quot;</span>col-md-1<span class="pl-pds">&quot;</span></span><span class="pl-k">&gt;&lt;</span><span class="pl-k">/</span>div<span class="pl-k">&gt;</span>
    <span class="pl-k">&lt;</span>div <span class="pl-k">class</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">&quot;</span>bg-info col-md-5<span class="pl-pds">&quot;</span></span><span class="pl-k">&gt;</span>
        <span class="pl-k">&lt;</span>h3<span class="pl-k">&gt;</span>分类统计<span class="pl-k">&lt;</span><span class="pl-k">/</span>h3<span class="pl-k">&gt;</span>
        <span class="pl-k">&lt;</span>p<span class="pl-k">&gt;</span>共 {{categoryCount}} 分类<span class="pl-k">&lt;</span><span class="pl-k">/</span>p<span class="pl-k">&gt;</span>
        <span class="pl-k">&lt;</span>ul <span class="pl-k">class</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">&quot;</span>list-group<span class="pl-pds">&quot;</span></span><span class="pl-k">&gt;</span>
            <span class="pl-k">&lt;</span>li <span class="pl-k">class</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">&quot;</span>list-group-item<span class="pl-pds">&quot;</span></span> <span class="pl-k">*</span>ngFor<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">&quot;</span>let category of categories<span class="pl-pds">&quot;</span></span><span class="pl-k">&gt;</span>
                {{<span class="pl-smi">category</span>.<span class="pl-c1">name</span>}}
            <span class="pl-k">&lt;</span><span class="pl-k">/</span>li<span class="pl-k">&gt;</span>
        <span class="pl-k">&lt;</span><span class="pl-k">/</span>ul<span class="pl-k">&gt;</span>
    <span class="pl-k">&lt;</span><span class="pl-k">/</span>div<span class="pl-k">&gt;</span>

    <span class="pl-k">&lt;</span>div <span class="pl-k">class</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">&quot;</span>col-md-1<span class="pl-pds">&quot;</span></span><span class="pl-k">&gt;&lt;</span><span class="pl-k">/</span>div<span class="pl-k">&gt;</span>
    <span class="pl-k">&lt;</span>div <span class="pl-k">class</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">&quot;</span>bg-success col-md-5<span class="pl-pds">&quot;</span></span><span class="pl-k">&gt;</span>
        <span class="pl-k">&lt;</span>h3<span class="pl-k">&gt;</span>应用统计<span class="pl-k">&lt;</span><span class="pl-k">/</span>h3<span class="pl-k">&gt;</span>
        <span class="pl-k">&lt;</span>p<span class="pl-k">&gt;</span>共 {{applicationCount}} 应用<span class="pl-k">&lt;</span><span class="pl-k">/</span>p<span class="pl-k">&gt;</span>
        <span class="pl-k">&lt;</span>div <span class="pl-k">class</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">&quot;</span>list-group<span class="pl-pds">&quot;</span></span><span class="pl-k">&gt;</span>
            <span class="pl-k">&lt;</span>a href<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">&quot;</span>#<span class="pl-pds">&quot;</span></span> <span class="pl-k">class</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">&quot;</span>list-group-item active<span class="pl-pds">&quot;</span></span><span class="pl-k">&gt;</span>
                下载量 Top3 应用
            <span class="pl-k">&lt;</span><span class="pl-k">/</span>a<span class="pl-k">&gt;</span>
            <span class="pl-k">&lt;</span>a href<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">&quot;</span>#<span class="pl-pds">&quot;</span></span> <span class="pl-k">class</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">&quot;</span>list-group-item<span class="pl-pds">&quot;</span></span> <span class="pl-k">*</span>ngFor<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">&quot;</span>let application of sortApplications<span class="pl-pds">&quot;</span></span> routerLink<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">&quot;</span>/applications/{{application.id}}<span class="pl-pds">&quot;</span></span><span class="pl-k">&gt;</span>
                {{<span class="pl-smi">application</span>.<span class="pl-c1">name</span>}}
                <span class="pl-k">&lt;</span>span <span class="pl-k">class</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">&quot;</span>badge<span class="pl-pds">&quot;</span></span><span class="pl-k">&gt;</span>${{<span class="pl-smi">application</span>.<span class="pl-smi">downloads</span>}}<span class="pl-k">&lt;</span><span class="pl-k">/</span>span<span class="pl-k">&gt;</span>
            <span class="pl-k">&lt;</span><span class="pl-k">/</span>a<span class="pl-k">&gt;</span>
        <span class="pl-k">&lt;</span><span class="pl-k">/</span>div<span class="pl-k">&gt;</span>
    <span class="pl-k">&lt;</span><span class="pl-k">/</span>div<span class="pl-k">&gt;</span>
<span class="pl-k">&lt;</span><span class="pl-k">/</span>div<span class="pl-k">&gt;</span></pre>
  </div> <p><code>routerLink=&quot;/applications/{{application.id}}&quot;</code> 实现路由导航， 告诉路由器，当用户点击这个链接时，应该导航到哪里。</p> </li> 
 <li> <p>将 DashboardComponent 组件和 AppRouterModule 注册到 AppModule</p> 
  <ul> 
   <li><p>将 <code>DashboardComponent</code> 添加到<code>AppModule</code> 的 <code>declarations</code></p></li> 
   <li><p>将 <code>AppRouterModule</code> 添加到<code>AppModule</code> 的 <code>imports</code></p></li> 
  </ul> <p><strong>app.module.js</strong>：</p> 
  <div class="highlight highlight-source-js">
   <pre>(<span class="pl-k">function</span>(<span class="pl-smi">app</span>) {
  <span class="pl-smi">app</span>.<span class="pl-smi">AppModule</span> <span class="pl-k">=</span>
    <span class="pl-c"><span class="pl-c">//</span> 模块定义</span>
    <span class="pl-smi">ng</span>.<span class="pl-smi">core</span>.<span class="pl-en">NgModule</span>({
      <span class="pl-c"><span class="pl-c">//</span> 导入的模块</span>
      imports<span class="pl-k">:</span> [ <span class="pl-smi">ng</span>.<span class="pl-smi">platformBrowser</span>.<span class="pl-smi">BrowserModule</span>, <span class="pl-smi">ng</span>.<span class="pl-c1">forms</span>.<span class="pl-smi">FormsModule</span>,<span class="pl-smi">app</span>.<span class="pl-smi">AppRoutingModule</span>, <span class="pl-smi">app</span>.<span class="pl-smi">ApplicationsModule</span> ], 
      declarations<span class="pl-k">:</span> [ <span class="pl-smi">app</span>.<span class="pl-smi">AppComponent</span>, <span class="pl-smi">app</span>.<span class="pl-smi">DashboardComponent</span> ], 
      bootstrap<span class="pl-k">:</span> [ <span class="pl-smi">app</span>.<span class="pl-smi">AppComponent</span>],
      <span class="pl-c"><span class="pl-c">//</span> 服务提供商</span>
      providers<span class="pl-k">:</span> [<span class="pl-smi">app</span>.<span class="pl-smi">ApplicationService</span>]  
    })
    .<span class="pl-en">Class</span>({
      <span class="pl-en">constructor</span><span class="pl-k">:</span> <span class="pl-k">function</span>() {
      }
    });
})(<span class="pl-c1">window</span>.<span class="pl-smi">app</span> <span class="pl-k">||</span> (<span class="pl-c1">window</span>.<span class="pl-smi">app</span> <span class="pl-k">=</span> {}));</pre>
  </div> </li> 
 <li> <p>修改 AppComponent，定义导航元素（<code>app.component.js</code>）</p> 
  <ul> 
   <li><p>使用 <code>&lt;router-outlet&gt;</code> 在应用组件中显示路由激活的组件</p></li> 
   <li> <p>使用<code>routerLink</code> 导航</p> <p>锚标签中的 <code>[routerLink]</code> 绑定把 <code>RouterLink</code> 指令绑定到一个字符串。 告诉路由器，当用户点击这个链接时，应该导航到哪里。</p> </li> 
   <li> <p>使用 <code>routerLinkActive</code> 控制当前激活导航对应的组件类样式</p> <p><code>routerLinkActive</code> 路由链接激活时显示的类样式，会匹配父路径相同的路径</p> </li> 
   <li><p><code>[routerLinkActiveOptions]=&quot;{ exact: true }&quot;</code> 仅在路由完全匹配时才应用 <code>routerLinkActive</code> 的类样式，排除匹配的父路径</p></li> 
  </ul> <p><strong>app.component.js</strong>：</p> 
  <div class="highlight highlight-source-js">
   <pre>(<span class="pl-k">function</span>(<span class="pl-smi">app</span>) {
    <span class="pl-smi">app</span>.<span class="pl-smi">AppComponent</span> <span class="pl-k">=</span> <span class="pl-smi">ng</span>.<span class="pl-smi">core</span>
        .<span class="pl-en">Component</span>({
            selector<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>appstore-app<span class="pl-pds">'</span></span>, 
            <span class="pl-c"><span class="pl-c">//</span> 将模板定义为应用的壳，只处理导航</span>
            template<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">`</span></span>
<span class="pl-s">            &lt;div class=&quot;container-fluid&quot;&gt;</span>
<span class="pl-s">                &lt;h1&gt; {{title}} &lt;/h1&gt;</span>
<span class="pl-s">                &lt;ul class=&quot;nav nav-pills&quot;&gt;</span>
<span class="pl-s">                      &lt;li routerLinkActive=&quot;active&quot; [routerLinkActiveOptions]=&quot;{ exact: true }&quot;&gt;&lt;a routerLink=&quot;/dashboard&quot;&gt;管理中心&lt;/a&gt;&lt;/li&gt;</span>
<span class="pl-s">                      &lt;li routerLinkActive=&quot;active&quot; [routerLinkActiveOptions]=&quot;{ exact: true }&quot;&gt;&lt;a routerLink=&quot;/applications&quot;&gt;应用管理&lt;/a&gt;&lt;/li&gt;</span>
<span class="pl-s">                      &lt;li routerLinkActive=&quot;active&quot; [routerLinkActiveOptions]=&quot;{ exact: true }&quot;&gt;&lt;a routerLink=&quot;/categories&quot;&gt;分类管理&lt;/a&gt;&lt;/li&gt;</span>
<span class="pl-s">                    &lt;/ul&gt;</span>
<span class="pl-s">                &lt;router-outlet&gt;&lt;/router-outlet&gt;</span>
<span class="pl-s">            &lt;/div&gt;</span>
<span class="pl-s">            <span class="pl-pds">`</span></span>,
            styleUrls<span class="pl-k">:</span> [<span class="pl-s"><span class="pl-pds">'</span>app/app.component.css<span class="pl-pds">'</span></span>]
        })
        .<span class="pl-en">Class</span>({
            <span class="pl-en">constructor</span><span class="pl-k">:</span> <span class="pl-k">function</span>() {
                <span class="pl-c1">this</span>.<span class="pl-c1">title</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">&quot;</span>Angular App Store<span class="pl-pds">&quot;</span></span>;
            }
        });
})(<span class="pl-c1">window</span>.<span class="pl-smi">app</span> <span class="pl-k">||</span> (<span class="pl-c1">window</span>.<span class="pl-smi">app</span> <span class="pl-k">=</span> {}));</pre>
  </div> </li> 
 <li> <p>在 ApplicationService 添加根据 id 获得应用对象函数</p> <p>定义 <code>getApplication</code> 以便根据路由 id 参数的值显示应用详情时查询应用信息。</p> <p><strong>application.service.js</strong>：</p> 
  <div class="highlight highlight-source-js">
   <pre><span class="pl-en">getApplication</span><span class="pl-k">:</span> <span class="pl-k">function</span>(<span class="pl-smi">id</span>){
    <span class="pl-k">return</span> <span class="pl-c1">Promise</span>.<span class="pl-en">resolve</span>(<span class="pl-c1">this</span>.<span class="pl-en">getApplications</span>().<span class="pl-en">then</span>(<span class="pl-smi">applications</span> <span class="pl-k">=&gt;</span> <span class="pl-smi">applications</span>.<span class="pl-c1">find</span>(<span class="pl-smi">application</span> <span class="pl-k">=&gt;</span> <span class="pl-smi">application</span>.<span class="pl-c1">id</span><span class="pl-k">==</span>id)));
}</pre>
  </div> </li> 
 <li> <p>修改 ApplicationDetailComponent, 根据路由参数查询详情（<code>emp-detail.component.js</code>）</p> 
  <ul> 
   <li><p>注入 <code>ng.router.ActivatedRoute</code>，在组件中通过注入ActivatedRoute 获得路由参数值</p></li> 
   <li><p>获得路由参数对象 <code>var params=this.router.params.value;</code></p></li> 
   <li><p>调用服务获得对象 <code>ApplicationService getApplicationService(parmas.id)</code> </p></li> 
   <li><p>注入 <code>ng.common.Location</code>，在详情页面实现返回</p></li> 
  </ul> <p><strong>application-detail.component.html</strong>：</p> 
  <div class="highlight highlight-text-html-basic">
   <pre>&lt;<span class="pl-ent">button</span> <span class="pl-e">class</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>btn btn-default<span class="pl-pds">&quot;</span></span> (<span class="pl-e">click</span>)=<span class="pl-s"><span class="pl-pds">&quot;</span>goBack()<span class="pl-pds">&quot;</span></span>&gt;返回&lt;/<span class="pl-ent">button</span>&gt;</pre>
  </div> <p><strong>application-detail.component.js</strong>：</p> 
  <div class="highlight highlight-source-js">
   <pre>(<span class="pl-k">function</span>(<span class="pl-smi">app</span>) {
    <span class="pl-smi">app</span>.<span class="pl-smi">ApplicationDetailComponent</span> <span class="pl-k">=</span> <span class="pl-smi">ng</span>.<span class="pl-smi">core</span>
        .<span class="pl-en">Component</span>({
            selector<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>application-detail<span class="pl-pds">'</span></span>,
            templateUrl<span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">'</span>app/application/application-detail/application-detail.component.html<span class="pl-pds">'</span></span>,
            <span class="pl-c"><span class="pl-c">//</span> 接收父组件输入的属性</span>
            inputs<span class="pl-k">:</span>[<span class="pl-s"><span class="pl-pds">'</span>categories<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>selectedApplication<span class="pl-pds">'</span></span>]
        })
        .<span class="pl-en">Class</span>({
            <span class="pl-c"><span class="pl-c">//</span> 获得路由参数，显示 id 对应的详情</span>
            <span class="pl-en">ngOnInit</span><span class="pl-k">:</span> <span class="pl-k">function</span>() {
                <span class="pl-k">var</span> params<span class="pl-k">=</span><span class="pl-c1">this</span>.<span class="pl-smi">router</span>.<span class="pl-smi">params</span>.<span class="pl-c1">value</span>; <span class="pl-c"><span class="pl-c">//</span> 路由参数</span>
                <span class="pl-c1">this</span>.<span class="pl-smi">service</span>.<span class="pl-en">getCategories</span>().<span class="pl-en">then</span>(<span class="pl-smi">categories</span><span class="pl-k">=&gt;</span>{<span class="pl-c1">this</span>.<span class="pl-smi">categories</span> <span class="pl-k">=</span> categories});
                <span class="pl-c1">this</span>.<span class="pl-smi">service</span>.<span class="pl-en">getApplication</span>(<span class="pl-smi">params</span>.<span class="pl-c1">id</span>).<span class="pl-en">then</span>(<span class="pl-smi">applications</span> <span class="pl-k">=&gt;</span> <span class="pl-c1">this</span>.<span class="pl-smi">selectedApplication</span> <span class="pl-k">=</span> applications);
            },
            <span class="pl-c"><span class="pl-c">//</span> 依赖注入 ActivatedRoute，Location</span>
            <span class="pl-en">constructor</span>: [ng.router.ActivatedRoute, ng.common.Location, app.ApplicationService, <span class="pl-k">function</span>(<span class="pl-smi">router</span>, <span class="pl-smi">location</span>, <span class="pl-smi">service</span>) {
                <span class="pl-c1">this</span>.<span class="pl-c1">location</span><span class="pl-k">=</span>location;
                <span class="pl-c1">this</span>.<span class="pl-smi">router</span><span class="pl-k">=</span>router;
                <span class="pl-c1">this</span>.<span class="pl-smi">service</span><span class="pl-k">=</span>service;
            }],
            <span class="pl-c"><span class="pl-c">//</span> 返回</span>
            <span class="pl-en">goBack</span><span class="pl-k">:</span> <span class="pl-k">function</span>() {
                <span class="pl-c1">this</span>.<span class="pl-c1">location</span>.<span class="pl-c1">back</span>();
            }
        });
})(<span class="pl-c1">window</span>.<span class="pl-smi">app</span> <span class="pl-k">||</span> (<span class="pl-c1">window</span>.<span class="pl-smi">app</span> <span class="pl-k">=</span> {}));</pre>
  </div> </li> 
 <li> <p>修改 index.html</p> <p><strong>index.html</strong>:</p> 
  <ul> 
   <li><p>在 <code>&lt;head&gt;</code> 区顶部添加 <code>&lt;base href=&quot;/&quot;&gt;</code> 语句</p></li> 
   <li> <p>引入路由和 Dashboard 文件</p> 
    <div class="highlight highlight-text-html-basic">
     <pre><span class="pl-c"><span class="pl-c">&lt;!--</span> Dashboard <span class="pl-c">--&gt;</span></span>
&lt;<span class="pl-ent">script</span> <span class="pl-e">src</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>app/dashboard.component.js<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">script</span>&gt;
<span class="pl-c"><span class="pl-c">&lt;!--</span> Router 路由 <span class="pl-c">--&gt;</span></span>
&lt;<span class="pl-ent">script</span> <span class="pl-e">src</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>app/app-routing.module.js<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">script</span>&gt;</pre>
    </div> </li> 
  </ul> </li> 
 <li> <p>在 ApplicationsComponent 实现选择行时跳转到详情组件</p> <p><strong>applications.component.html</strong>：</p> <p><code>(click)=&quot;gotoDetail(application)&quot;</code> 点击行时跳到详情。</p> 
  <div class="highlight highlight-source-js">
   <pre><span class="pl-k">&lt;</span>tr <span class="pl-k">*</span>ngFor<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">&quot;</span>let application of applications; trackBy:trackByApplications<span class="pl-pds">&quot;</span></span> [<span class="pl-k">class</span>.<span class="pl-smi">active</span>]<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">&quot;</span>application === selectedApplication<span class="pl-pds">&quot;</span></span> (click)<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">&quot;</span>gotoDetail(application)<span class="pl-pds">&quot;</span></span><span class="pl-k">&gt;</span></pre>
  </div> <p><strong>applications.component.js</strong>：</p> <p>注入 <code>ng.router.Router</code>，使用 <code>navigate</code> 方法请求带参数的路由</p> 
  <div class="highlight highlight-source-js">
   <pre><span class="pl-c"><span class="pl-c">//</span> 依赖注入服务对象， 构造函数仅完成参数赋值给属性</span>
<span class="pl-en">constructor</span>: [ng.router.Router, app.ApplicationService, <span class="pl-k">function</span>(<span class="pl-smi">router</span>, <span class="pl-smi">service</span>) {
    <span class="pl-c"><span class="pl-c">//</span> 保存 Router 对象</span>
    <span class="pl-c1">this</span>.<span class="pl-smi">router</span> <span class="pl-k">=</span> router;
    <span class="pl-c"><span class="pl-c">//</span> 保存服务对象</span>
    <span class="pl-c1">this</span>.<span class="pl-smi">service</span> <span class="pl-k">=</span> service;
}],
<span class="pl-c"><span class="pl-c">//</span> 转到详情</span>
<span class="pl-en">gotoDetail</span><span class="pl-k">:</span> <span class="pl-k">function</span>(<span class="pl-smi">application</span>) {
    <span class="pl-c"><span class="pl-c">//</span> 注入 ng.router.Router，使用 navigate 方法请求带参数的路由</span>
    <span class="pl-c1">this</span>.<span class="pl-smi">router</span>.<span class="pl-c1">navigate</span>([<span class="pl-s"><span class="pl-pds">'</span>/applications<span class="pl-pds">'</span></span>, <span class="pl-smi">application</span>.<span class="pl-c1">id</span>]);
}</pre>
  </div> </li> 
</ol> 
<h2> <a id="8-http-交互" class="anchor" href="#8-http-%E4%BA%A4%E4%BA%92" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>8. HTTP 交互</h2> 
<p>实现代码：<code>step8-http</code></p> 
<p><a href="doc/images/step8-demo.png" target="_blank"><img src="doc/images/step8-demo.png" alt="Example" style="max-width:100%;" /></a></p> 
<p>通过 <code>Angular HTTP</code> 服务和<code>内存 Web API</code>&nbsp;模拟服务器开发交互和测试。</p> 
<ul> 
 <li><p>从服务器查询数据</p></li> 
 <li><p>更新数据到服务器</p></li> 
 <li><p>添加数据到服务器</p></li> 
 <li><p>删除服务器数据</p></li> 
</ul> 
<h3> <a id="添加内存-web-api-数据文件" class="anchor" href="#%E6%B7%BB%E5%8A%A0%E5%86%85%E5%AD%98-web-api-%E6%95%B0%E6%8D%AE%E6%96%87%E4%BB%B6" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>添加内存 Web API 数据文件</h3> 
<p><a href="doc/images/step8.png" target="_blank"><img src="doc/images/step8.png" alt="Example" style="max-width:100%;" /></a></p> 
<h3> <a id="实现步骤-6" class="anchor" href="#%E5%AE%9E%E7%8E%B0%E6%AD%A5%E9%AA%A4-6" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>实现步骤</h3> 
<ol> 
 <li> <p>定义内存 Web API&nbsp;模拟服务文件</p> <p>如果暂时没有对应的 Web API 服务器，可以使用<strong>内存 Web API</strong>&nbsp;模拟服务器开发测试。</p> <p><strong>app/mock/in-memory-data.service.js</strong>：</p> 
  <ul> 
   <li>实现 <code>createDb</code> 函数定义内存数据服务。</li> 
  </ul> 
  <div class="highlight highlight-source-js">
   <pre>(<span class="pl-k">function</span>(<span class="pl-smi">app</span>) {
    <span class="pl-smi">app</span>.<span class="pl-smi">InMemoryDataService</span> <span class="pl-k">=</span> <span class="pl-smi">ng</span>.<span class="pl-smi">core</span>.<span class="pl-en">Class</span>({
        <span class="pl-en">constructor</span><span class="pl-k">:</span> <span class="pl-k">function</span>() {},
        <span class="pl-c"><span class="pl-c">//</span> CreateDb</span>
        <span class="pl-en">createDb</span><span class="pl-k">:</span> <span class="pl-k">function</span>() {
            <span class="pl-k">var</span> categories <span class="pl-k">=</span> [
                <span class="pl-k">new</span> <span class="pl-en">app.Category</span>(<span class="pl-c1">1</span>, <span class="pl-s"><span class="pl-pds">'</span>应用<span class="pl-pds">'</span></span>),
                <span class="pl-k">new</span> <span class="pl-en">app.Category</span>(<span class="pl-c1">2</span>, <span class="pl-s"><span class="pl-pds">'</span>游戏<span class="pl-pds">'</span></span>),
                <span class="pl-k">new</span> <span class="pl-en">app.Category</span>(<span class="pl-c1">3</span>, <span class="pl-s"><span class="pl-pds">'</span>音乐<span class="pl-pds">'</span></span>),
                <span class="pl-k">new</span> <span class="pl-en">app.Category</span>(<span class="pl-c1">4</span>, <span class="pl-s"><span class="pl-pds">'</span>图书<span class="pl-pds">'</span></span>)
            ];
            <span class="pl-k">var</span> applications <span class="pl-k">=</span> [
                <span class="pl-k">new</span> <span class="pl-en">app.Application</span>(<span class="pl-c1">1001</span>, <span class="pl-s"><span class="pl-pds">'</span>Angular App<span class="pl-pds">'</span></span>, <span class="pl-c1">300</span>, categories[<span class="pl-c1">0</span>].<span class="pl-c1">name</span>),
                <span class="pl-k">new</span> <span class="pl-en">app.Application</span>(<span class="pl-c1">1002</span>, <span class="pl-s"><span class="pl-pds">'</span>Big Game<span class="pl-pds">'</span></span>, <span class="pl-c1">120</span>, categories[<span class="pl-c1">1</span>].<span class="pl-c1">name</span>),
                <span class="pl-k">new</span> <span class="pl-en">app.Application</span>(<span class="pl-c1">1003</span>, <span class="pl-s"><span class="pl-pds">'</span>Fantasy<span class="pl-pds">'</span></span>, <span class="pl-c1">240</span>, categories[<span class="pl-c1">2</span>].<span class="pl-c1">name</span>),
                <span class="pl-k">new</span> <span class="pl-en">app.Application</span>(<span class="pl-c1">1004</span>, <span class="pl-s"><span class="pl-pds">'</span>Think in Java<span class="pl-pds">'</span></span>, <span class="pl-c1">480</span>, categories[<span class="pl-c1">3</span>].<span class="pl-c1">name</span>),
                <span class="pl-k">new</span> <span class="pl-en">app.Application</span>(<span class="pl-c1">1005</span>, <span class="pl-s"><span class="pl-pds">'</span>Bang Game<span class="pl-pds">'</span></span>, <span class="pl-c1">310</span>, categories[<span class="pl-c1">1</span>].<span class="pl-c1">name</span>),
                <span class="pl-k">new</span> <span class="pl-en">app.Application</span>(<span class="pl-c1">1006</span>, <span class="pl-s"><span class="pl-pds">'</span>The Mythical Man-Month<span class="pl-pds">'</span></span>, <span class="pl-c1">680</span>, categories[<span class="pl-c1">3</span>].<span class="pl-c1">name</span>),
                <span class="pl-k">new</span> <span class="pl-en">app.Application</span>(<span class="pl-c1">1007</span>, <span class="pl-s"><span class="pl-pds">'</span>BootStrap App<span class="pl-pds">'</span></span>, <span class="pl-c1">290</span>, categories[<span class="pl-c1">0</span>].<span class="pl-c1">name</span>)
            ];
            <span class="pl-k">return</span> { <span class="pl-s"><span class="pl-pds">&quot;</span>applications<span class="pl-pds">&quot;</span></span><span class="pl-k">:</span> applications, <span class="pl-s"><span class="pl-pds">&quot;</span>categories<span class="pl-pds">&quot;</span></span><span class="pl-k">:</span> categories };
        }
    });
})(<span class="pl-c1">window</span>.<span class="pl-smi">app</span> <span class="pl-k">||</span> (<span class="pl-c1">window</span>.<span class="pl-smi">app</span> <span class="pl-k">=</span> {}));</pre>
  </div> </li> 
 <li> <p>准备 HTTP 服务和内存 Web API&nbsp;模拟服务</p> <p><strong>index.html</strong>：</p> <p>在 <code>index.html</code> 引入模块和服务文件，注意定义顺序。</p> 
  <div class="highlight highlight-text-html-basic">
   <pre><span class="pl-c"><span class="pl-c">&lt;!--</span> HTTP <span class="pl-c">--&gt;</span></span>
&lt;<span class="pl-ent">script</span> <span class="pl-e">src</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>node_modules/@angular/http/bundles/http.umd.min.js<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">script</span>&gt;
<span class="pl-c"><span class="pl-c">&lt;!--</span> in-memory-web-api <span class="pl-c">--&gt;</span></span>
&lt;<span class="pl-ent">script</span> <span class="pl-e">src</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>node_modules/angular-in-memory-web-api/bundles/in-memory-web-api.umd.js<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">script</span>&gt;
<span class="pl-c"><span class="pl-c">&lt;!--</span> InMemoryDataService <span class="pl-c">--&gt;</span></span>
&lt;<span class="pl-ent">script</span> <span class="pl-e">src</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>app/mock/in-memory-data.service.js<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">script</span>&gt;</pre>
  </div> <p><strong>app.module.js</strong>：</p> <p>在<code>AppModule</code> 的 <code>imports</code> 中导入<code>ng.http.HttpModule</code> 和 <code>ng.inMemoryWebApi.InMemoryWebApiModule.forRoot(app.InMemoryDataService)</code> 模块。</p> 
  <div class="highlight highlight-source-js">
   <pre>(<span class="pl-k">function</span>(<span class="pl-smi">app</span>) {
  <span class="pl-smi">app</span>.<span class="pl-smi">AppModule</span> <span class="pl-k">=</span>
    <span class="pl-c"><span class="pl-c">//</span> 模块定义</span>
    <span class="pl-smi">ng</span>.<span class="pl-smi">core</span>.<span class="pl-en">NgModule</span>({
      <span class="pl-c"><span class="pl-c">//</span> 导入的模块</span>
      imports<span class="pl-k">:</span> [ 
          <span class="pl-smi">ng</span>.<span class="pl-smi">platformBrowser</span>.<span class="pl-smi">BrowserModule</span>,
          <span class="pl-smi">ng</span>.<span class="pl-c1">forms</span>.<span class="pl-smi">FormsModule</span>, 
          <span class="pl-smi">app</span>.<span class="pl-smi">AppRoutingModule</span>, 
          <span class="pl-c"><span class="pl-c">//</span> HTTP</span>
          <span class="pl-smi">ng</span>.<span class="pl-smi">http</span>.<span class="pl-smi">HttpModule</span>,  
          <span class="pl-c"><span class="pl-c">//</span> InMemoryWebApi</span>
          <span class="pl-smi">ng</span>.<span class="pl-smi">inMemoryWebApi</span>.<span class="pl-smi">InMemoryWebApiModule</span>.<span class="pl-en">forRoot</span>(<span class="pl-smi">app</span>.<span class="pl-smi">InMemoryDataService</span>), 
          <span class="pl-smi">app</span>.<span class="pl-smi">ApplicationsModule</span>
      ],
      declarations<span class="pl-k">:</span> [ <span class="pl-smi">app</span>.<span class="pl-smi">AppComponent</span>, <span class="pl-smi">app</span>.<span class="pl-smi">DashboardComponent</span> ], 
      bootstrap<span class="pl-k">:</span> [ <span class="pl-smi">app</span>.<span class="pl-smi">AppComponent</span>],
      <span class="pl-c"><span class="pl-c">//</span> 服务提供商</span>
      providers<span class="pl-k">:</span> [<span class="pl-smi">app</span>.<span class="pl-smi">ApplicationService</span>]   
    })
    .<span class="pl-en">Class</span>({
      <span class="pl-en">constructor</span><span class="pl-k">:</span> <span class="pl-k">function</span>() {
      }
    });
})(<span class="pl-c1">window</span>.<span class="pl-smi">app</span> <span class="pl-k">||</span> (<span class="pl-c1">window</span>.<span class="pl-smi">app</span> <span class="pl-k">=</span> {}));</pre>
  </div> </li> 
 <li> <p>修改 ApplicationService，使用 HTTP 请求内存 Web API 服务</p> 
  <ul> 
   <li><p>修改 <code>application.service.js</code>， 注入 <code>ng.http.Http</code>，从 <code>内存 Web API</code> 获得数据。</p></li> 
   <li><p>删除之前的 Mock 数据文件 <code>mock-applications.js</code> </p></li> 
   <li> <p>内存 Web API 只需掌握基本的增删改查 URL 格式即可 <code>:base/:collectionName/:id?</code>。</p> 
    <ul> 
     <li><p>查询所有(<code>get</code>)：<code>api/applications</code></p></li> 
     <li><p>根据 ID 查询(<code>get</code>)：<code>api/applications/1001</code></p></li> 
     <li><p>添加(<code>put</code>)：<code>api/applications</code></p></li> 
     <li><p>修改(<code>post</code>)：<code>api/applications/1001</code></p></li> 
     <li><p>删除(<code>delete</code>)：<code>api/applications/1001</code></p></li> 
    </ul> </li> 
   <li><p>Angular 的 <code>http.get|post|put|delete</code> 会返回一个 <code>RxJS</code> 的 <code>Observable对象（可观察对象）</code>，可以通过 <code>.toPromise()</code> 转换成 Promise 对象。</p></li> 
  </ul> <p><strong>application.service.js</strong>： </p> 
  <div class="highlight highlight-source-js">
   <pre>(<span class="pl-k">function</span>(<span class="pl-smi">app</span>) {
    <span class="pl-smi">app</span>.<span class="pl-smi">ApplicationService</span> <span class="pl-k">=</span> <span class="pl-smi">ng</span>.<span class="pl-smi">core</span>.<span class="pl-en">Class</span>({
        <span class="pl-en">constructor</span><span class="pl-k">:</span> <span class="pl-k">function</span>() {},
        <span class="pl-c"><span class="pl-c">//</span> 注入 Http 服务</span>
        <span class="pl-en">constructor</span>:[ ng.http.Http, <span class="pl-k">function</span>(<span class="pl-smi">http</span>) {
            <span class="pl-c1">this</span>.<span class="pl-smi">http</span><span class="pl-k">=</span>http;
             <span class="pl-c"><span class="pl-c">//</span> URL to web api</span>
            <span class="pl-c1">this</span>.<span class="pl-smi">applicationsUrl</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>api/applications<span class="pl-pds">'</span></span>;
            <span class="pl-c1">this</span>.<span class="pl-smi">categoriesUrl</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>api/categories<span class="pl-pds">'</span></span>;
            <span class="pl-c"><span class="pl-c">//</span> web api header</span>
            <span class="pl-c1">this</span>.<span class="pl-c1">headers</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">ng.http.Headers</span>({<span class="pl-s"><span class="pl-pds">'</span>Content-Type<span class="pl-pds">'</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>application/json<span class="pl-pds">'</span></span>});
        }],
        <span class="pl-c"><span class="pl-c">//</span> 处理 HTTP 请求错误</span>
        <span class="pl-en">handleError</span><span class="pl-k">:</span> <span class="pl-k">function</span>(<span class="pl-smi">error</span>){
            <span class="pl-en">console</span>.<span class="pl-c1">error</span>(<span class="pl-s"><span class="pl-pds">'</span>An error occurred<span class="pl-pds">'</span></span>, error); <span class="pl-c"><span class="pl-c">//</span> for demo purposes only</span>
            <span class="pl-k">return</span> <span class="pl-c1">Promise</span>.<span class="pl-en">reject</span>(<span class="pl-smi">error</span>.<span class="pl-smi">message</span> <span class="pl-k">||</span> error);
        },
        <span class="pl-c"><span class="pl-c">//</span> 查询分类列表</span>
        <span class="pl-en">getCategories</span><span class="pl-k">:</span> <span class="pl-k">function</span>() {
            <span class="pl-c"><span class="pl-c">//</span> 使用 get 请求 URL 获得数据</span>
             <span class="pl-k">return</span> <span class="pl-c1">this</span>.<span class="pl-smi">http</span>.<span class="pl-c1">get</span>(<span class="pl-c1">this</span>.<span class="pl-smi">categoriesUrl</span>)
               .<span class="pl-en">toPromise</span>() <span class="pl-c"><span class="pl-c">//</span>转换成Promise对象</span>
               .<span class="pl-en">then</span>(<span class="pl-smi">response</span> <span class="pl-k">=&gt;</span> <span class="pl-smi">response</span>.<span class="pl-en">json</span>().<span class="pl-c1">data</span>) <span class="pl-c"><span class="pl-c">//</span>在 then 回调中提取出数据</span>
               .<span class="pl-en">catch</span>(<span class="pl-c1">this</span>.<span class="pl-smi">handleError</span>);
        },
        <span class="pl-c"><span class="pl-c">//</span> 查询应用列表</span>
        <span class="pl-en">getApplications</span><span class="pl-k">:</span> <span class="pl-k">function</span>(){
            <span class="pl-c"><span class="pl-c">//</span> 使用 get 请求 URL 获得数据</span>
            <span class="pl-k">return</span> <span class="pl-c1">this</span>.<span class="pl-smi">http</span>.<span class="pl-c1">get</span>(<span class="pl-c1">this</span>.<span class="pl-smi">applicationsUrl</span>)
               .<span class="pl-en">toPromise</span>() <span class="pl-c"><span class="pl-c">//</span>转换成Promise对象</span>
               .<span class="pl-en">then</span>(<span class="pl-smi">response</span> <span class="pl-k">=&gt;</span> <span class="pl-smi">response</span>.<span class="pl-en">json</span>().<span class="pl-c1">data</span>) <span class="pl-c"><span class="pl-c">//</span>在 then 回调中提取出数据</span>
               .<span class="pl-en">catch</span>(<span class="pl-c1">this</span>.<span class="pl-smi">handleError</span>);
        },
        <span class="pl-c"><span class="pl-c">//</span> 修改应用</span>
        <span class="pl-en">update</span><span class="pl-k">:</span> <span class="pl-k">function</span>(<span class="pl-smi">selectedApplication</span>){
            <span class="pl-c"><span class="pl-c">//</span> 在 URL 中的id 来告诉服务器应该更新哪个</span>
            <span class="pl-k">var</span> url <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">`</span><span class="pl-s1"><span class="pl-pse">${</span><span class="pl-c1">this</span>.<span class="pl-smi">applicationsUrl</span><span class="pl-pse">}</span></span>/<span class="pl-s1"><span class="pl-pse">${</span><span class="pl-smi">selectedApplication</span>.<span class="pl-c1">id</span><span class="pl-pse">}</span></span><span class="pl-pds">`</span></span>;
            <span class="pl-c"><span class="pl-c">//</span> 使用 put 请求 URL 修改数据</span>
            <span class="pl-c"><span class="pl-c">//</span> put 的 body 是该员工的 JSON 字符串，它是通过调用JSON.stringify得到的</span>
            <span class="pl-c"><span class="pl-c">//</span> 并且在请求头中标记出的 body 的内容类型（application/json）</span>
            <span class="pl-k">return</span> <span class="pl-c1">this</span>.<span class="pl-smi">http</span>
                .<span class="pl-en">put</span>(url, <span class="pl-c1">JSON</span>.<span class="pl-en">stringify</span>(selectedApplication), {headers<span class="pl-k">:</span> <span class="pl-c1">this</span>.<span class="pl-c1">headers</span>})
                .<span class="pl-en">toPromise</span>()
                .<span class="pl-en">catch</span>(<span class="pl-c1">this</span>.<span class="pl-smi">handleError</span>);
        },
        <span class="pl-c"><span class="pl-c">//</span> 添加应用</span>
        <span class="pl-en">create</span><span class="pl-k">:</span> <span class="pl-k">function</span>(<span class="pl-smi">application</span>){
            <span class="pl-c"><span class="pl-c">//</span> 使用 post 请求 URL 添加数据</span>
            <span class="pl-k">return</span> <span class="pl-c1">this</span>.<span class="pl-smi">http</span>
                    .<span class="pl-en">post</span>(<span class="pl-c1">this</span>.<span class="pl-smi">applicationsUrl</span>, <span class="pl-c1">JSON</span>.<span class="pl-en">stringify</span>(application), {headers<span class="pl-k">:</span> <span class="pl-c1">this</span>.<span class="pl-c1">headers</span>})
                    .<span class="pl-en">toPromise</span>()
                    .<span class="pl-en">then</span>(<span class="pl-smi">res</span> <span class="pl-k">=&gt;</span> <span class="pl-smi">res</span>.<span class="pl-en">json</span>().<span class="pl-c1">data</span>)
                    .<span class="pl-en">catch</span>(<span class="pl-c1">this</span>.<span class="pl-smi">handleError</span>);
        },
        <span class="pl-en">delete</span><span class="pl-k">:</span> <span class="pl-k">function</span>(<span class="pl-smi">id</span>){
            <span class="pl-c"><span class="pl-c">//</span> 使用 delete 请求 URL 删除数据</span>
            <span class="pl-k">var</span> url <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">`</span><span class="pl-s1"><span class="pl-pse">${</span><span class="pl-c1">this</span>.<span class="pl-smi">applicationsUrl</span><span class="pl-pse">}</span></span>/<span class="pl-s1"><span class="pl-pse">${</span>id<span class="pl-pse">}</span></span><span class="pl-pds">`</span></span>;
            <span class="pl-k">return</span> <span class="pl-c1">this</span>.<span class="pl-smi">http</span>
                    .<span class="pl-c1">delete</span>(url, {headers<span class="pl-k">:</span> <span class="pl-c1">this</span>.<span class="pl-c1">headers</span>})
                    .<span class="pl-en">toPromise</span>()
                    .<span class="pl-en">catch</span>(<span class="pl-c1">this</span>.<span class="pl-smi">handleError</span>);
        },
        <span class="pl-en">getApplication</span><span class="pl-k">:</span> <span class="pl-k">function</span>(<span class="pl-smi">id</span>){
            <span class="pl-c"><span class="pl-c">//</span> 使用 get 请求 URL 根据 id 查询数据</span>
            <span class="pl-k">var</span> url <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">`</span><span class="pl-s1"><span class="pl-pse">${</span><span class="pl-c1">this</span>.<span class="pl-smi">applicationsUrl</span><span class="pl-pse">}</span></span>/<span class="pl-s1"><span class="pl-pse">${</span>id<span class="pl-pse">}</span></span><span class="pl-pds">`</span></span>;
            <span class="pl-k">return</span> <span class="pl-c1">this</span>.<span class="pl-smi">http</span>.<span class="pl-c1">get</span>(url)
                    .<span class="pl-en">toPromise</span>()
                    .<span class="pl-en">then</span>(<span class="pl-smi">response</span> <span class="pl-k">=&gt;</span> <span class="pl-smi">response</span>.<span class="pl-en">json</span>().<span class="pl-c1">data</span>) <span class="pl-c"><span class="pl-c">//</span>在 then 回调中提取出数据</span>
                    .<span class="pl-en">catch</span>(<span class="pl-c1">this</span>.<span class="pl-smi">handleError</span>);
        }
    });
})(<span class="pl-c1">window</span>.<span class="pl-smi">app</span> <span class="pl-k">||</span> (<span class="pl-c1">window</span>.<span class="pl-smi">app</span> <span class="pl-k">=</span> {}));</pre>
  </div> <p><strong>这里体现出了引入 Service 服务设计理念的好处。当数来源变化时，能够仅需要修改 Service 服务组件即可适应变化，其他的视图组件，模块组件都不用修改。</strong> </p> <p>你现在就可以测试更换为 HTTP 和内存 Web API 的应用是否还能正常获得数据并渲染成功。 </p> </li> 
 <li> <p>HTTP 交互实现：添加，删除</p> <p>现在从服务器获取数据，当执行添加，修改和删除的更新操作时，如果希望这些更改被持久化，就得把它们写回服务器。</p> <p><strong>applications.component.js</strong>：</p> <p>使用服务器端添加和删除。</p> 
  <div class="highlight highlight-source-js">
   <pre><span class="pl-c"><span class="pl-c">//</span> 添加应用</span>
<span class="pl-en">create</span><span class="pl-k">:</span> <span class="pl-k">function</span>(<span class="pl-smi">addForm</span>) {
    <span class="pl-c"><span class="pl-c">//</span> 获得数据并验证</span>
    <span class="pl-k">var</span> id <span class="pl-k">=</span> <span class="pl-smi">addForm</span>.<span class="pl-c1">id</span>.<span class="pl-c1">value</span>;
    <span class="pl-k">var</span> name <span class="pl-k">=</span> <span class="pl-smi">addForm</span>.<span class="pl-c1">name</span>.<span class="pl-c1">value</span>;
    <span class="pl-k">var</span> downloads <span class="pl-k">=</span> <span class="pl-smi">addForm</span>.<span class="pl-smi">downloads</span>.<span class="pl-c1">value</span>;
    <span class="pl-k">var</span> category <span class="pl-k">=</span> <span class="pl-smi">addForm</span>.<span class="pl-smi">category</span>.<span class="pl-c1">value</span>;
    <span class="pl-k">if</span>(<span class="pl-k">!</span><span class="pl-smi">id</span>.<span class="pl-en">trim</span>() <span class="pl-k">||</span> <span class="pl-k">!</span><span class="pl-smi">name</span>.<span class="pl-en">trim</span>() <span class="pl-k">||</span> <span class="pl-k">!</span><span class="pl-smi">downloads</span>.<span class="pl-en">trim</span>()) {
        <span class="pl-k">return</span>;
    }
    <span class="pl-c"><span class="pl-c">//</span> 由于内存 Web API 中 id 为数字，必须转换为数字保存</span>
    <span class="pl-c1">this</span>.<span class="pl-smi">service</span>.<span class="pl-en">create</span>(<span class="pl-k">new</span> <span class="pl-en">app.Application</span>(<span class="pl-c1">parseInt</span>(id), name, downloads, category)).<span class="pl-en">then</span>(<span class="pl-smi">application</span> <span class="pl-k">=&gt;</span> {
        <span class="pl-c1">this</span>.<span class="pl-smi">applications</span>.<span class="pl-c1">push</span>(application);
        <span class="pl-smi">addForm</span>.<span class="pl-c1">reset</span>(); <span class="pl-c"><span class="pl-c">//</span> 重置添加表单</span>
        <span class="pl-c1">this</span>.<span class="pl-smi">selectedApplication</span> <span class="pl-k">=</span> <span class="pl-c1">null</span>;
    });
},
<span class="pl-c"><span class="pl-c">//</span> 删除应用</span>
<span class="pl-en">delete</span><span class="pl-k">:</span> <span class="pl-k">function</span>(<span class="pl-smi">application</span>) {
    <span class="pl-c"><span class="pl-c">//</span> 服务器端删除</span>
    <span class="pl-c1">this</span>.<span class="pl-smi">service</span>.<span class="pl-c1">delete</span>(<span class="pl-smi">application</span>.<span class="pl-c1">id</span>)
        .<span class="pl-en">then</span>(() <span class="pl-k">=&gt;</span> {
            <span class="pl-c"><span class="pl-c">//</span> 客户端删除</span>
            <span class="pl-c1">this</span>.<span class="pl-smi">applications</span> <span class="pl-k">=</span> <span class="pl-c1">this</span>.<span class="pl-smi">applications</span>.<span class="pl-en">filter</span>(<span class="pl-k">function</span>(<span class="pl-smi">o</span>) {
                <span class="pl-k">return</span> o <span class="pl-k">!==</span> application;
            });
            <span class="pl-k">if</span>(<span class="pl-c1">this</span>.<span class="pl-smi">selectedApplication</span> <span class="pl-k">===</span> application) {
                <span class="pl-c1">this</span>.<span class="pl-smi">selectedApplication</span> <span class="pl-k">=</span> <span class="pl-c1">null</span>;
            }
        });
}</pre>
  </div> </li> 
 <li> <p>HTTP 交互实现：保存修改</p> <p><strong>application-detail.component.html</strong></p> <p>在 <code>application-detail.component.html</code> 添加保存按钮，注册单击事件。</p> 
  <div class="highlight highlight-source-js">
   <pre><span class="pl-k">&lt;</span>div <span class="pl-k">class</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">&quot;</span>container<span class="pl-pds">&quot;</span></span> [hidden]<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">&quot;</span>submitted<span class="pl-pds">&quot;</span></span> <span class="pl-k">*</span>ngIf<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">&quot;</span>selectedApplication<span class="pl-pds">&quot;</span></span> <span class="pl-k">&gt;</span>
    <span class="pl-k">&lt;</span>button <span class="pl-k">class</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">&quot;</span>btn btn-default<span class="pl-pds">&quot;</span></span> (click)<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">&quot;</span>goBack()<span class="pl-pds">&quot;</span></span><span class="pl-k">&gt;</span>返回<span class="pl-k">&lt;</span><span class="pl-k">/</span>button<span class="pl-k">&gt;</span>
    <span class="pl-k">&lt;</span>h2<span class="pl-k">&gt;</span>{{<span class="pl-smi">selectedApplication</span>.<span class="pl-c1">name</span> <span class="pl-k">|</span> uppercase}} 详情<span class="pl-k">!</span><span class="pl-k">&lt;</span><span class="pl-k">/</span>h2<span class="pl-k">&gt;</span>
    <span class="pl-k">&lt;</span>form #applicationForm<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">&quot;</span>ngForm<span class="pl-pds">&quot;</span></span><span class="pl-k">&gt;</span>
      <span class="pl-k">&lt;</span>div <span class="pl-k">class</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">&quot;</span>form-group<span class="pl-pds">&quot;</span></span><span class="pl-k">&gt;</span>
        <span class="pl-k">&lt;</span>label <span class="pl-k">for</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">&quot;</span>name<span class="pl-pds">&quot;</span></span><span class="pl-k">&gt;</span>应用名<span class="pl-k">&lt;</span><span class="pl-k">/</span>label<span class="pl-k">&gt;</span>
        <span class="pl-k">&lt;</span>input type<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">&quot;</span>text<span class="pl-pds">&quot;</span></span> <span class="pl-k">class</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">&quot;</span>form-control<span class="pl-pds">&quot;</span></span> id<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">&quot;</span>name<span class="pl-pds">&quot;</span></span> name<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">&quot;</span>name<span class="pl-pds">&quot;</span></span> required [(ngModel)]<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">&quot;</span>selectedApplication.name<span class="pl-pds">&quot;</span></span>
            #name<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">&quot;</span>ngModel<span class="pl-pds">&quot;</span></span><span class="pl-k">&gt;</span>
        <span class="pl-k">&lt;</span>div [hidden]<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">&quot;</span>name.valid || name.pristine<span class="pl-pds">&quot;</span></span> <span class="pl-k">class</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">&quot;</span>alert alert-danger<span class="pl-pds">&quot;</span></span><span class="pl-k">&gt;</span>
            必须填写应用名称
        <span class="pl-k">&lt;</span><span class="pl-k">/</span>div<span class="pl-k">&gt;</span>
      <span class="pl-k">&lt;</span><span class="pl-k">/</span>div<span class="pl-k">&gt;</span>
      <span class="pl-k">&lt;</span>div <span class="pl-k">class</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">&quot;</span>form-group<span class="pl-pds">&quot;</span></span><span class="pl-k">&gt;</span>
        <span class="pl-k">&lt;</span>label <span class="pl-k">for</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">&quot;</span>downloads<span class="pl-pds">&quot;</span></span><span class="pl-k">&gt;</span>下载量<span class="pl-k">&lt;</span><span class="pl-k">/</span>label<span class="pl-k">&gt;</span>
        <span class="pl-k">&lt;</span>input type<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">&quot;</span>text<span class="pl-pds">&quot;</span></span> <span class="pl-k">class</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">&quot;</span>form-control<span class="pl-pds">&quot;</span></span> id<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">&quot;</span>downloads<span class="pl-pds">&quot;</span></span> name<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">&quot;</span>downloads<span class="pl-pds">&quot;</span></span> required [(ngModel)]<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">&quot;</span>selectedApplication.downloads<span class="pl-pds">&quot;</span></span>
            #downloads<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">&quot;</span>ngModel<span class="pl-pds">&quot;</span></span><span class="pl-k">&gt;</span>
        <span class="pl-k">&lt;</span>div [hidden]<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">&quot;</span>downloads.valid || downloads.pristine<span class="pl-pds">&quot;</span></span> <span class="pl-k">class</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">&quot;</span>alert alert-danger<span class="pl-pds">&quot;</span></span><span class="pl-k">&gt;</span>
            必须填写下载量
        <span class="pl-k">&lt;</span><span class="pl-k">/</span>div<span class="pl-k">&gt;</span>
      <span class="pl-k">&lt;</span><span class="pl-k">/</span>div<span class="pl-k">&gt;</span>
      <span class="pl-k">&lt;</span>div <span class="pl-k">class</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">&quot;</span>form-group<span class="pl-pds">&quot;</span></span><span class="pl-k">&gt;</span>
        <span class="pl-k">&lt;</span>label <span class="pl-k">for</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">&quot;</span>category<span class="pl-pds">&quot;</span></span><span class="pl-k">&gt;</span>分类<span class="pl-k">&lt;</span><span class="pl-k">/</span>label<span class="pl-k">&gt;</span>
        <span class="pl-k">&lt;</span>select <span class="pl-k">class</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">&quot;</span>form-control<span class="pl-pds">&quot;</span></span> id<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">&quot;</span>category<span class="pl-pds">&quot;</span></span> name<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">&quot;</span>category<span class="pl-pds">&quot;</span></span> required [(ngModel)]<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">&quot;</span>selectedApplication.category<span class="pl-pds">&quot;</span></span><span class="pl-k">&gt;</span>
            <span class="pl-k">&lt;</span>option <span class="pl-k">*</span>ngFor<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">&quot;</span>let category of categories<span class="pl-pds">&quot;</span></span> [value]<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">&quot;</span>category.name<span class="pl-pds">&quot;</span></span><span class="pl-k">&gt;</span>{{<span class="pl-smi">category</span>.<span class="pl-c1">name</span>}}<span class="pl-k">&lt;</span><span class="pl-k">/</span>option<span class="pl-k">&gt;</span>
          <span class="pl-k">&lt;</span><span class="pl-k">/</span>select<span class="pl-k">&gt;</span>
      <span class="pl-k">&lt;</span><span class="pl-k">/</span>div<span class="pl-k">&gt;</span>
       <span class="pl-k">&lt;</span>button type<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">&quot;</span>button<span class="pl-pds">&quot;</span></span> <span class="pl-k">class</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">&quot;</span>btn btn-success<span class="pl-pds">&quot;</span></span> [disabled]<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">&quot;</span>!applicationForm.form.valid<span class="pl-pds">&quot;</span></span> 
        (click)<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">&quot;</span>save()<span class="pl-pds">&quot;</span></span><span class="pl-k">&gt;</span>Save<span class="pl-k">&lt;</span><span class="pl-k">/</span>button<span class="pl-k">&gt;</span>
    <span class="pl-k">&lt;</span><span class="pl-k">/</span>form<span class="pl-k">&gt;</span>
<span class="pl-k">&lt;</span><span class="pl-k">/</span>div<span class="pl-k">&gt;</span></pre>
  </div> <p><strong>实现表单验证</strong>:</p> 
  <ul> 
   <li><p><code>#applicationForm=&quot;ngForm&quot;</code> 定义验证表单变量</p></li> 
   <li><p><code>#name=&quot;ngModel&quot;</code> 定义验证表单元素</p></li> 
   <li><p>借助 <code>ng-invalid</code> 类来给出有用的提示，当控件是<code>有效的 (valid)</code> 或<code>全新的 (pristine)</code> 时，隐藏消息。</p></li> 
   <li> <p>在按钮上引用表单变量，实现验证无效时按钮禁用</p> <pre><code>&lt;form #applicationForm=&quot;ngForm&quot;&gt;
    ...
    &lt;input type=&quot;text&quot; class=&quot;form-control&quot; id=&quot;name&quot; name=&quot;name&quot; required [(ngModel)]=&quot;selectedApplication.name&quot;
        #name=&quot;ngModel&quot;&gt;
    &lt;div [hidden]=&quot;name.valid || name.pristine&quot; class=&quot;alert alert-danger&quot;&gt;
        必须填写应用名称
    &lt;/div&gt;
    ...
    &lt;button type=&quot;button&quot; class=&quot;btn btn-success&quot; [disabled]=&quot;!applicationForm.form.valid&quot; 
    (click)=&quot;save()&quot;&gt;Save&lt;/button&gt;
&lt;/form&gt;
</code></pre> </li> 
  </ul> <p><strong>application-detail.component.js</strong>：</p> 
  <div class="highlight highlight-source-js">
   <pre><span class="pl-c"><span class="pl-c">//</span> 保存修改</span>
<span class="pl-en">save</span><span class="pl-k">:</span> <span class="pl-k">function</span>(){
     <span class="pl-c1">this</span>.<span class="pl-smi">service</span>.<span class="pl-en">update</span>(<span class="pl-c1">this</span>.<span class="pl-smi">selectedApplication</span>)
    .<span class="pl-en">then</span>(() <span class="pl-k">=&gt;</span> <span class="pl-c1">this</span>.<span class="pl-en">goBack</span>()); <span class="pl-c"><span class="pl-c">//</span> 保存后返回上一页</span>
}</pre>
  </div> </li> 
 <li> <p>完成</p> <p>一个具有 HTTP 交互能力的应用就完成了。</p> </li> 
</ol> 
<h2> <a id="9-使用可观察对象observable即刻搜索" class="anchor" href="#9-%E4%BD%BF%E7%94%A8%E5%8F%AF%E8%A7%82%E5%AF%9F%E5%AF%B9%E8%B1%A1observable%E5%8D%B3%E5%88%BB%E6%90%9C%E7%B4%A2" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>9. 使用可观察对象(Observable)即刻搜索</h2> 
<p>实现代码：<code>step9-observable search</code></p> 
<p><a href="doc/images/step9-demo.png" target="_blank"><img src="doc/images/step9-demo.png" alt="Example" style="max-width:100%;" /></a></p> 
<h3> <a id="使用可观察对象observable-即刻搜索" class="anchor" href="#%E4%BD%BF%E7%94%A8%E5%8F%AF%E8%A7%82%E5%AF%9F%E5%AF%B9%E8%B1%A1observable-%E5%8D%B3%E5%88%BB%E6%90%9C%E7%B4%A2" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>使用<strong>可观察对象(Observable)</strong> 即刻搜索</h3> 
<p>在进行及时搜索时，我们可以开始一个请求， 并且取消它，在服务器对第一个请求作出回应之前，再开始另一个不同的请求。 承诺无法实现请求的取消，对于<strong>可观察对象(Observable)</strong>却很简单。</p> 
<h3> <a id="添加搜索目录和组件" class="anchor" href="#%E6%B7%BB%E5%8A%A0%E6%90%9C%E7%B4%A2%E7%9B%AE%E5%BD%95%E5%92%8C%E7%BB%84%E4%BB%B6" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>添加搜索目录和组件</h3> 
<p><a href="doc/images/step9.png" target="_blank"><img src="doc/images/step9.png" alt="Example" style="max-width:100%;" /></a></p> 
<h2> <a id="可观察对象observable" class="anchor" href="#%E5%8F%AF%E8%A7%82%E5%AF%9F%E5%AF%B9%E8%B1%A1observable" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>可观察对象(Observable)</h2> 
<p><code>可观察对象（Observable）/可观察流（observable stream）</code>来自于 Angular 集成的 <code>Rx.js</code> 库。使用 <code>Reactive programming</code>，实现了针对异步数据流的编程的，可以合并、创建、过滤这些流。流也被称为“可观察的对象”（Observable），因为流可以被观察、订阅。</p> 
<p>Http 服务中的每个方法都返回一个 HTTP Response 对象的 <code>Observable 实例</code>。 之前的 <code>ApplicationService</code> 将 <code>Observable对象</code>转换成了 <code>Promise（承诺）</code>，并把这个承诺返回给了调用者。 </p> 
<div class="highlight highlight-source-js">
 <pre><span class="pl-c"><span class="pl-c">//</span> 查询应用列表</span>
<span class="pl-en">getApplications</span><span class="pl-k">:</span> <span class="pl-k">function</span>(){
    <span class="pl-c"><span class="pl-c">//</span> 使用 get 请求 URL 获得数据</span>
    <span class="pl-k">return</span> <span class="pl-c1">this</span>.<span class="pl-smi">http</span>.<span class="pl-c1">get</span>(<span class="pl-c1">this</span>.<span class="pl-smi">applicationsUrl</span>)
       .<span class="pl-en">toPromise</span>() <span class="pl-c"><span class="pl-c">//</span>转换成Promise对象</span>
       .<span class="pl-en">then</span>(<span class="pl-smi">response</span> <span class="pl-k">=&gt;</span> <span class="pl-smi">response</span>.<span class="pl-en">json</span>().<span class="pl-c1">data</span>) <span class="pl-c"><span class="pl-c">//</span>在 then 回调中提取出数据</span>
       .<span class="pl-en">catch</span>(<span class="pl-c1">this</span>.<span class="pl-smi">handleError</span>);
},</pre>
</div> 
<p>在搜索时用户不断地输入关键字，Promise 承诺无法实现请求的取消或合并，对于可观察对象却很简单。</p> 
<h3> <a id="实现步骤-7" class="anchor" href="#%E5%AE%9E%E7%8E%B0%E6%AD%A5%E9%AA%A4-7" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>实现步骤</h3> 
<ol> 
 <li> <p>在 ApplicationService 实现 search 函数</p> <p>返回一个 <code>map</code> 转换后的 <code>Observable</code> 流对象。</p> 
  <div class="highlight highlight-source-js">
   <pre><span class="pl-en">search</span><span class="pl-k">:</span> <span class="pl-k">function</span>(<span class="pl-smi">term</span>) {
    <span class="pl-c"><span class="pl-c">//</span> 使用 name 模糊查询</span>
     <span class="pl-k">return</span> <span class="pl-c1">this</span>.<span class="pl-smi">http</span>
        .<span class="pl-c1">get</span>(<span class="pl-s"><span class="pl-pds">&quot;</span>app/applications/?name=<span class="pl-pds">&quot;</span></span> <span class="pl-k">+</span> term) <span class="pl-c"><span class="pl-c">//</span> Observable  流</span>
        .<span class="pl-en">map</span>(<span class="pl-smi">r</span> <span class="pl-k">=&gt;</span> <span class="pl-smi">r</span>.<span class="pl-en">json</span>().<span class="pl-c1">data</span>); <span class="pl-c"><span class="pl-c">//</span> 将原来的流通过函数转换为新的流。转换 Observable 发出的每个项目，并返回一个 Observable</span>
}</pre>
  </div> </li> 
 <li> <p>实现 ApplicationSearchComponent 搜索组件</p> <p><strong>application-search.component.js</strong>：</p> 
  <div class="highlight highlight-source-js">
   <pre>(<span class="pl-k">function</span>(<span class="pl-smi">app</span>) {
    <span class="pl-smi">app</span>.<span class="pl-smi">ApplicationSearchComponent</span> <span class="pl-k">=</span> <span class="pl-smi">ng</span>.<span class="pl-smi">core</span>
        .<span class="pl-en">Component</span>({
            selector<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>application-search<span class="pl-pds">'</span></span>,
            templateUrl<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>app/application/application-search/application-serach.component.html<span class="pl-pds">'</span></span>,
            styles<span class="pl-k">:</span>[
            <span class="pl-s"><span class="pl-pds">`</span>.search-result{</span>
<span class="pl-s">                  border-bottom: 1px solid #eee;</span>
<span class="pl-s">                  border-left: 1px solid #eee;</span>
<span class="pl-s">                  border-right: 1px solid #eee;</span>
<span class="pl-s">                  height: 40px;</span>
<span class="pl-s">                  padding: 5px;</span>
<span class="pl-s">                  background-color: white;</span>
<span class="pl-s">                  cursor: pointer;</span>
<span class="pl-s">                }<span class="pl-pds">`</span></span>
            ]
        })
        .<span class="pl-en">Class</span>({
            <span class="pl-c"><span class="pl-c">//</span> 注册流订阅</span>
            <span class="pl-en">ngOnInit</span><span class="pl-k">:</span> <span class="pl-k">function</span>() {
                <span class="pl-k">var</span> _this <span class="pl-k">=</span> <span class="pl-c1">this</span>;
                <span class="pl-c1">this</span>.<span class="pl-smi">applications</span> <span class="pl-k">=</span> <span class="pl-c1">this</span>.<span class="pl-smi">searchTerms</span>
                    <span class="pl-c"><span class="pl-c">//</span> 归并请求。减轻服务器资源，减少客户流量。</span>
                    .<span class="pl-en">debounceTime</span>(<span class="pl-c1">300</span>) <span class="pl-c"><span class="pl-c">//</span> 获得输入后，等待超过 300ms 才实际发起请求</span>
                    .<span class="pl-en">distinctUntilChanged</span>() <span class="pl-c"><span class="pl-c">//</span> 只在过滤条件变化时才发送请求， 避免重复请求同一个搜索词</span>
                    <span class="pl-c"><span class="pl-c">//</span> 调用搜索服务。它会取消并丢弃以前的搜索可观察对象，只保留最近的。</span>
                    .<span class="pl-en">switchMap</span>(<span class="pl-k">function</span>(<span class="pl-smi">term</span>) {
                        <span class="pl-k">return</span> term <span class="pl-c"><span class="pl-c">//</span> 搜索框为空时，时间返回一个空 Observable</span>
                            <span class="pl-k">?</span>
                            <span class="pl-smi">_this</span>.<span class="pl-smi">service</span>.<span class="pl-c1">search</span>(term) 
                            <span class="pl-k">:</span>
                            <span class="pl-smi">Rx</span>.<span class="pl-smi">Observable</span>.<span class="pl-en">of</span>([]);
                    })
                    .<span class="pl-en">catch</span>(<span class="pl-k">function</span>(<span class="pl-smi">error</span>) {
                        <span class="pl-en">console</span>.<span class="pl-c1">log</span>(error);
                        <span class="pl-k">return</span> <span class="pl-smi">Rx</span>.<span class="pl-smi">Observable</span>.<span class="pl-en">of</span>([]);
                    });

            },
            <span class="pl-en">constructor</span>: [ng.router.Router, app.ApplicationService, <span class="pl-k">function</span>(<span class="pl-smi">router</span>, <span class="pl-smi">service</span>) {
                <span class="pl-c1">this</span>.<span class="pl-smi">router</span> <span class="pl-k">=</span> router;
                <span class="pl-c1">this</span>.<span class="pl-smi">service</span> <span class="pl-k">=</span> service;
                <span class="pl-c"><span class="pl-c">//</span> Subject（主题）是一个可观察的事件流中的生产者。</span>
                <span class="pl-c1">this</span>.<span class="pl-smi">searchTerms</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">Rx.Subject</span>();
            }],
            <span class="pl-c"><span class="pl-c">//</span> 搜索</span>
            <span class="pl-en">search</span><span class="pl-k">:</span> <span class="pl-k">function</span>(<span class="pl-smi">term</span>) {
                <span class="pl-c"><span class="pl-c">//</span> 用户输入时，调用 next 来把新的字符串放进该主题的可观察流中</span>
                <span class="pl-c1">this</span>.<span class="pl-smi">searchTerms</span>.<span class="pl-c1">next</span>(term);
            },
            <span class="pl-en">gotoDetail</span><span class="pl-k">:</span> <span class="pl-k">function</span>(<span class="pl-smi">application</span>) {
                <span class="pl-c1">this</span>.<span class="pl-smi">router</span>.<span class="pl-c1">navigate</span>([<span class="pl-s"><span class="pl-pds">'</span>/applications<span class="pl-pds">'</span></span>, <span class="pl-smi">application</span>.<span class="pl-c1">id</span>]);
            }
        });
})(<span class="pl-c1">window</span>.<span class="pl-smi">app</span> <span class="pl-k">||</span> (<span class="pl-c1">window</span>.<span class="pl-smi">app</span> <span class="pl-k">=</span> {}));</pre>
  </div> <p>这里需要在<code>constructor</code> 构造函数中创建一个 Rx 的 <code>Subject（主题）</code> 对象，主题对象是一个可观察的事件流中的生产者：</p> 
  <div class="highlight highlight-source-js">
   <pre><span class="pl-c1">this</span>.<span class="pl-smi">searchTerms</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">Rx.Subject</span>();</pre>
  </div> <p>当用户收入搜索关键字时，通过 <code>next</code> 函数把新的字符串放入 Subject 的可观察流中，发送广播请求：</p> 
  <div class="highlight highlight-source-js">
   <pre><span class="pl-c"><span class="pl-c">//</span> 搜索</span>
<span class="pl-en">search</span><span class="pl-k">:</span> <span class="pl-k">function</span>(<span class="pl-smi">term</span>) {
    <span class="pl-c"><span class="pl-c">//</span> 用户输入时，调用 next 来把新的字符串放进该主题的可观察流中</span>
    <span class="pl-c1">this</span>.<span class="pl-smi">searchTerms</span>.<span class="pl-c1">next</span>(term);
}</pre>
  </div> <p>在 <code>ngOnInit</code> 初始化 <code>applications</code> 属性。<code>Subject</code> 能归并请求，并把搜索词的流转换成 <code>Application</code> 对象数组的流，并把结果赋值给 <code>applications</code> 属性：</p> <p>通过 Subject 发送广播请求，并能归并请求，并把结果赋值给 emps 属性</p> 
  <div class="highlight highlight-source-js">
   <pre><span class="pl-c"><span class="pl-c">//</span> 注册流订阅</span>
<span class="pl-en">ngOnInit</span><span class="pl-k">:</span> <span class="pl-k">function</span>() {
    <span class="pl-k">var</span> _this <span class="pl-k">=</span> <span class="pl-c1">this</span>;
    <span class="pl-c1">this</span>.<span class="pl-smi">applications</span> <span class="pl-k">=</span> <span class="pl-c1">this</span>.<span class="pl-smi">searchTerms</span>
        <span class="pl-c"><span class="pl-c">//</span> 归并请求。减轻服务器资源，减少客户流量。</span>
        .<span class="pl-en">debounceTime</span>(<span class="pl-c1">300</span>) <span class="pl-c"><span class="pl-c">//</span> 获得输入后，等待超过 300ms 才实际发起请求</span>
        .<span class="pl-en">distinctUntilChanged</span>() <span class="pl-c"><span class="pl-c">//</span> 只在过滤条件变化时才发送请求， 避免重复请求同一个搜索词</span>
        <span class="pl-c"><span class="pl-c">//</span> 调用搜索服务。它会取消并丢弃以前的搜索可观察对象，只保留最近的。</span>
        .<span class="pl-en">switchMap</span>(<span class="pl-k">function</span>(<span class="pl-smi">term</span>) {
            <span class="pl-k">return</span> term <span class="pl-c"><span class="pl-c">//</span> 搜索框为空时，时间返回一个空 Observable</span>
                <span class="pl-k">?</span>
                <span class="pl-smi">_this</span>.<span class="pl-smi">service</span>.<span class="pl-c1">search</span>(term) 
                <span class="pl-k">:</span>
                <span class="pl-smi">Rx</span>.<span class="pl-smi">Observable</span>.<span class="pl-en">of</span>([]);
        })
        .<span class="pl-en">catch</span>(<span class="pl-k">function</span>(<span class="pl-smi">error</span>) {
            <span class="pl-en">console</span>.<span class="pl-c1">log</span>(error);
            <span class="pl-k">return</span> <span class="pl-smi">Rx</span>.<span class="pl-smi">Observable</span>.<span class="pl-en">of</span>([]);
        });

}</pre>
  </div> <p>如果直接把每一次用户按键都直接传给 <code>ApplicationService</code>，就会发起一场 HTTP 请求风暴，既占用服务器资源，也会消耗移动网络的流量。</p> <p>通过串联一些 <code>Observable</code> 操作符，来归并这些请求。 我们将对 <code>ApplicationService</code> 发起更少的调用，并且仍然获得足够及时的响应。做法如下：</p> 
  <ul> 
   <li><p>在传出最终字符串之前，<code>debounceTime(300)</code> 将会等待，直到新增字符串的事件暂停了 300 毫秒。 我们实际发起请求的间隔永远不会小于 300ms。</p></li> 
   <li><p><code>distinctUntilChanged</code> 确保只在过滤条件变化时才发送请求， 这样就不会重复请求同一个搜索词了。</p></li> 
   <li><p><code>switchMap</code> 会为每个从 <code>debounce</code> 和 <code>distinctUntilChanged</code> 中通过的搜索词调用搜索服务。 它会取消并丢弃以前的搜索可观察对象，只保留最近的。</p></li> 
   <li><p>如果搜索框为空，我们还可以短路掉这次http方法调用，并且直接返回一个包含空数组的可观察对象。</p></li> 
  </ul> 
  <blockquote> 
   <p>注意，取消 <code>ApplicationService</code> 的可观察对象并不会实际<code>中止 (abort)</code>一个未完成的 HTTP 请求， 除非服务支持这个特性，目前我们的做法只是丢弃不希望的结果。</p> 
  </blockquote> 
  <ul> 
   <li> <code>catch</code> 拦截失败的可观察对象。这个简单的例子中只是把错误信息打印到控制台（但实际的应用需要做更多事），然后返回一个包含空数组的可观察对象，以清空搜索结果。</li> 
  </ul> </li> 
 <li> <p>定义搜索组件模板</p> <p><strong>application-serach.component.html</strong>:</p> 
  <div class="highlight highlight-text-html-basic">
   <pre>&lt;<span class="pl-ent">div</span> <span class="pl-e">class</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>form-group<span class="pl-pds">&quot;</span></span>&gt;
  &lt;<span class="pl-ent">h3</span>&gt;应用即刻搜索&lt;/<span class="pl-ent">h3</span>&gt;
  &lt;<span class="pl-ent">input</span> <span class="pl-e">class</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>form-control<span class="pl-pds">&quot;</span></span> #<span class="pl-e">searchBox</span> <span class="pl-e">id</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>search-box<span class="pl-pds">&quot;</span></span> (<span class="pl-e">keyup</span>)=<span class="pl-s"><span class="pl-pds">&quot;</span>search(searchBox.value)<span class="pl-pds">&quot;</span></span> <span class="pl-e">placeholder</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>请输入应用名<span class="pl-pds">&quot;</span></span> /&gt;
  &lt;<span class="pl-ent">div</span>&gt;
    &lt;<span class="pl-ent">div</span> *<span class="pl-e">ngIf</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>applications<span class="pl-pds">&quot;</span></span>&gt;
        &lt;<span class="pl-ent">div</span> *<span class="pl-e">ngFor</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>let application of applications | async<span class="pl-pds">&quot;</span></span>
             (<span class="pl-e">click</span>)=<span class="pl-s"><span class="pl-pds">&quot;</span>gotoDetail(application)<span class="pl-pds">&quot;</span></span> <span class="pl-e">class</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>search-result<span class="pl-pds">&quot;</span></span> &gt;
          {{application.name}}
        &lt;/<span class="pl-ent">div</span>&gt;
    &lt;/<span class="pl-ent">div</span>&gt;
  &lt;/<span class="pl-ent">div</span>&gt;
&lt;/<span class="pl-ent">div</span>&gt;</pre>
  </div> <p>这里必须使用 <code>async</code> 管道，订阅数据列表的 <code>Observable</code> 对象，并且为 <code>*ngFor</code> 生成数据数组。</p> 
  <div class="highlight highlight-text-html-basic">
   <pre>&lt;<span class="pl-ent">div</span> *<span class="pl-e">ngFor</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>let application of applications | async<span class="pl-pds">&quot;</span></span>
     (<span class="pl-e">click</span>)=<span class="pl-s"><span class="pl-pds">&quot;</span>gotoDetail(application)<span class="pl-pds">&quot;</span></span> <span class="pl-e">class</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>search-result<span class="pl-pds">&quot;</span></span> &gt;</pre>
  </div> </li> 
 <li> <p>在 ApplicationsModule 定义搜索组件信息</p> <p>在 <code>declarations</code> 和 <code>exports</code> 声明 <code>ApplicationSearchComponent</code>。</p> <p><strong>applications.module.js</strong>:</p> 
  <div class="highlight highlight-source-js">
   <pre>(<span class="pl-k">function</span>(<span class="pl-smi">app</span>) {
    <span class="pl-smi">app</span>.<span class="pl-smi">ApplicationsModule</span> <span class="pl-k">=</span> <span class="pl-smi">ng</span>.<span class="pl-smi">core</span>
        .<span class="pl-en">NgModule</span>({
            <span class="pl-c"><span class="pl-c">//</span> 导入的模块</span>
            imports<span class="pl-k">:</span> [<span class="pl-smi">ng</span>.<span class="pl-smi">platformBrowser</span>.<span class="pl-smi">BrowserModule</span>, <span class="pl-smi">ng</span>.<span class="pl-c1">forms</span>.<span class="pl-smi">FormsModule</span>],
            <span class="pl-c"><span class="pl-c">//</span> 定义声明模块</span>
            declarations<span class="pl-k">:</span> [
                <span class="pl-smi">app</span>.<span class="pl-smi">ApplicationsComponent</span>,
                <span class="pl-smi">app</span>.<span class="pl-smi">ApplicationDetailComponent</span>, 
                <span class="pl-smi">app</span>.<span class="pl-smi">ApplicationSearchComponent</span> <span class="pl-c"><span class="pl-c">//</span> 搜索组件</span>
            ],
            <span class="pl-c"><span class="pl-c">//</span> 导出模块</span>
            exports<span class="pl-k">:</span> [
                <span class="pl-smi">app</span>.<span class="pl-smi">ApplicationsComponent</span>,
                <span class="pl-smi">app</span>.<span class="pl-smi">ApplicationDetailComponent</span>, 
                <span class="pl-smi">app</span>.<span class="pl-smi">ApplicationSearchComponent</span> <span class="pl-c"><span class="pl-c">//</span> 搜索组件</span>
            ]
        })
        .<span class="pl-en">Class</span>({
            <span class="pl-en">constructor</span><span class="pl-k">:</span> <span class="pl-k">function</span>() {}
        });
})(<span class="pl-c1">window</span>.<span class="pl-smi">app</span> <span class="pl-k">||</span> (<span class="pl-c1">window</span>.<span class="pl-smi">app</span> <span class="pl-k">=</span> {}));</pre>
  </div> </li> 
 <li> <p>在 index.html 引入搜索组件</p> <p><strong>index.html</strong>:</p> 
  <div class="highlight highlight-source-js">
   <pre><span class="pl-c"><span class="pl-c">&lt;!--</span></span> Search <span class="pl-c"><span class="pl-c">--&gt;</span></span>
<span class="pl-k">&lt;</span>script src<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">&quot;</span>app/application/application-search/application-search.component.js<span class="pl-pds">&quot;</span></span><span class="pl-k">&gt;&lt;</span><span class="pl-k">/</span>script<span class="pl-k">&gt;</span></pre>
  </div> </li> 
 <li> <p>纯 JS 下的 Angular Rx bug 修改</p> 
  <blockquote> 
   <p>rxjs_symbol_observable undefined Bug <a href="https://github.com/angular/angular/issues/14298">https://github.com/angular/angular/issues/14298</a></p> 
  </blockquote> <p>在 <code>&lt;script src=&quot;node_modules/rxjs/bundles/Rx.js&quot;&gt;&lt;/script&gt;</code> 后加入如下代码，避免 <code>rxjs_symbol_observable undefined Bug</code>：</p> <p><strong>index.html</strong>:</p> 
  <div class="highlight highlight-source-js">
   <pre><span class="pl-k">&lt;</span>script src<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">&quot;</span>node_modules/rxjs/bundles/Rx.js<span class="pl-pds">&quot;</span></span><span class="pl-k">&gt;&lt;</span><span class="pl-k">/</span>script<span class="pl-k">&gt;</span>
<span class="pl-k">&lt;</span><span class="pl-k">--</span> Angular bug fixed<span class="pl-c"><span class="pl-c">--&gt;</span></span>
<span class="pl-k">&lt;</span>script<span class="pl-k">&gt;</span>
    <span class="pl-smi">Rx</span>.<span class="pl-smi">Symbol</span>.<span class="pl-smi">$$observable</span> <span class="pl-k">=</span> <span class="pl-smi">Rx</span>.<span class="pl-smi">Symbol</span>.<span class="pl-smi">observable</span>;
    <span class="pl-c1">window</span>.<span class="pl-smi">rxjs_symbol_observable</span> <span class="pl-k">=</span> <span class="pl-smi">Rx</span>.<span class="pl-smi">Symbol</span>;
<span class="pl-k">&lt;</span><span class="pl-k">/</span>script<span class="pl-k">&gt;</span></pre>
  </div> </li> 
 <li> <p>完成</p> <p>一个包含增删改查，搜索，导航的应用管理模块就开发完成了。</p> </li> 
</ol> 
<h2> <a id="10-应用分类开发实战" class="anchor" href="#10-%E5%BA%94%E7%94%A8%E5%88%86%E7%B1%BB%E5%BC%80%E5%8F%91%E5%AE%9E%E6%88%98" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>10. 应用分类开发实战</h2> 
<p>经过以上步骤的指导训练，现在可以将开发指导教程通过一个练习结合到实际的操作中，掌握常用 Angular 模块的使用，并能结合自定义组件，模块，路由，服务，数据绑定，依赖注入，HTTP 等技术和优化指导原则完成项目设计。</p> 
<p><strong>动手完善应用分类管理模块：</strong></p> 
<ul> 
 <li><p>实现对分类的列表展示</p></li> 
 <li><p>实现对分类信息的添加，修改，删除</p></li> 
 <li><p>在 Dashboard 点击分类名称，跳转到应用管理界面，显示分类对应的应用。</p></li> 
</ul> 
<p><a href="doc/images/step10-demo.png" target="_blank"><img src="doc/images/step10-demo.png" alt="Example" style="max-width:100%;" /></a></p> 
<p>也可以参考实现代码：<code>step10-category</code>。</p> 
<p><a href="doc/images/step10.png" target="_blank"><img src="doc/images/step10.png" alt="Example" style="max-width:100%;" /></a></p> 
<h2> <a id="end" class="anchor" href="#end" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>End</h2> 
<p>Email：<a href="mailto:inthinkcolor@gmail.com">inthinkcolor@gmail.com</a></p> 
<p><a href="http://www.easyproject.cn/angular-appstore" title="EasyProject Home">http://www.easyproject.cn</a></p> 
<p><a href="https://github.com/ushelp" title="EasyProject GitHub">https://github.com/ushelp</a></p> 
<p><strong>支付宝钱包扫一扫捐助：</strong></p> 
<p>我们相信，每个人的点滴贡献，都将是推动产生更多、更好免费开源产品的一大步。</p> 
<p><strong>如果您觉得有帮助，感谢慷慨捐助，以支持服务器运行和鼓励更多社区成员。</strong></p> 
<p><a href="https://camo.githubusercontent.com/0079923bf4bc9ed15a8be36a117559592e024d1b/687474703a2f2f7777772e6561737970726f6a6563742e636e2f696d616765732f732e706e67" target="_blank"><img alt="支付宝钱包扫一扫捐助" src="https://camo.githubusercontent.com/0079923bf4bc9ed15a8be36a117559592e024d1b/687474703a2f2f7777772e6561737970726f6a6563742e636e2f696d616765732f732e706e67" title="支付宝钱包扫一扫捐助" height="256" width="256" data-canonical-src="http://www.easyproject.cn/images/s.png" style="max-width:100%;" /></a></p> 
<p>We believe that the contribution of each bit by bit, will be driven to produce more and better free and open source products a big step.</p> 
<p><strong>If you feel helpful, thank you donation to support the server running and encourage more community members.</strong></p> 
<p><a href="https://www.paypal.me/easyproject/10" title="Make payments with PayPal - it's fast, free and secure!"><img src="https://camo.githubusercontent.com/25fd45a9c199091fd684c9f11b37c386b4301087/687474703a2f2f7777772e6561737970726f6a6563742e636e2f696d616765732f70617970616c646f6e6174696f6e352e6a7067" alt="PayPal" data-canonical-src="http://www.easyproject.cn/images/paypaldonation5.jpg" style="max-width:100%;" /></a></p>
</body>
</html>
